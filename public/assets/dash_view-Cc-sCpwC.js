import{j as e,c as Je,d as Oe,u as tt,e as Qe,g as Ye,l as Ge,t as wt,f as xt,C as He}from"./BindToParentScroll-wq_hAQJI.js";import{u as ge,a as Te,F as Ke,b as Ct,c as kt,d as et,G,S as it,I as fe,C as ps,e as Rt,A as Ot,O as fs,U as Yt,f as Rs,g as Ws,h as Fs}from"./ChoiseRole-C0dAiSaW.js";import{H as W,r as j,g as Gs,L as Ks,R as Js}from"./index-BEcpemk-.js";import{u as I,E as jt}from"./ListPaging-CftOfhdJ.js";import{S as Zs,t as Ft}from"./SearchFilterBindJson-BZbWq4O4.js";import{t as es}from"./Transmit-C4IPPhLh.js";import{e as Os}from"./emoji-ce0Jjmmu.js";function Qs(){const r=localStorage.getItem("store_name"),{getAccess:s}=I();return e.jsx("div",{className:"page-auth",children:e.jsxs("div",{className:"auth-ctn",children:[e.jsx("div",{className:"image"}),e.jsxs("div",{className:"form",children:[e.jsxs("h1",{className:"auth-title",children:[r==null?void 0:r.toUpperCase()," DASHBOARD"]}),e.jsxs("h5",{className:"auth-prompt",children:["Read more ?"," ",e.jsx("span",{onClick:()=>{},children:"Click here"})]}),e.jsxs("div",{className:"google",onClick:()=>{s()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Connexion"})]}),e.jsx("p",{children:"Google connexion is required to get access to sublymus Dash board service."})]})]})})}function Ds({blur:r,className:s}){const{pathList:a,setAbsPath:t}=ge(),{user:n,store:c,disconnection:i}=I(),{T:l,setT:o}=Te(),d=a[1]||"products";return e.jsxs("div",{className:"nav-bar "+(s||"min")+" "+(n?r?"blur":"":"blur"),children:[e.jsxs("div",{className:"nav-logo",children:[e.jsx("div",{className:"logo",style:{backgroundImage:`url(${`${W}${c==null?void 0:c.banners[0]}`})`}}),e.jsx("div",{className:"label",children:c==null?void 0:c.name})]}),e.jsxs("div",{className:"dash-top-right",children:[e.jsxs("div",{className:"dark-mode "+l,onClick:()=>{o(l?"":"active")},children:[e.jsx("span",{className:"dark-mode-btn"})," ",e.jsx("span",{className:"dark-white-btn",children:" "})]}),e.jsxs("div",{className:"notf",children:[" ",e.jsx("span",{})]})]}),e.jsx("div",{className:"nav-link",children:e.jsxs("ul",{children:[e.jsxs("li",{className:d=="products"||d=="features"||d=="categories"||d=="catalogs"?"active":"no",onClick:()=>{t(["products"])},children:[e.jsx("span",{className:"product"}),e.jsx("label",{children:"STORE"})]}),e.jsxs("li",{className:d=="clients"||d=="collaborators"||d=="roles"?"active":"no",onClick:()=>{t(["clients"])},children:[e.jsx("span",{className:"users"}),e.jsx("label",{children:"USERS"})]}),e.jsxs("li",{className:d=="chat"?"active":"no",onClick:()=>{t(["chat"])},children:[e.jsx("span",{className:"chat"}),e.jsx("label",{children:"CHAT"})]})]})}),e.jsxs("div",{className:"nav-profile",children:[e.jsx("div",{className:"img",style:{background:`no-repeat center/cover url(${n!=null&&n.photos[0].startsWith("/")?W:""}${n==null?void 0:n.photos[0]})`}}),e.jsx("div",{className:"name",children:n==null?void 0:n.name}),e.jsx("div",{className:"logout",onClick:()=>{i()},children:"logout"})]}),e.jsx("div",{className:"logut-icon",onClick:()=>{i()}})]})}const at=Je(r=>({products:void 0,selectedProduct:void 0,async fectProductCommands({limit:s,page:a,status:t,no_status:n,user_id:c,product_id:i}){const l=I.getState().getHeaders();if(!l)return;const o={};o.user_id=!0,o.store_id=l.store.id,o.product_id=i||"",o.limit=s||25,o.page=a||1,o.user_id=c||"",o.status=t||"",o.no_status=n||"";const d=new URLSearchParams({});for(const p in o){const P=o[p];d.set(p,P)}const g=await(await fetch(`${W}/get_commands/?${d.toString()}`,{headers:l.headers})).json();if(!(!g||!g.list))return g},async setProductById(s){const a=at.getState().products,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedProduct:t}));else if(I.getState().store){const c=await at.getState().fetchProducts({query:{product_id:s}});r(()=>({selectedProduct:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await at.getState().fetchProducts({query:{product_id:s}});r(()=>({selectedProduct:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async removeProduct(s){const a=I.getState().getHeaders();if(!a)return;const n=await(await fetch(`${W}/delete_product/${s}`,{method:"DELETE",headers:a.headers})).json();return Te.getState().fetchStoreVar(),n==null?void 0:n.isDeleted},async createProduct(s){const a=I.getState().getHeaders();if(!a)return;s.index=s.index||0,s.is_dynamic_price=s.is_dynamic_price||!0;const t=new FormData,n=[];if(["images","model_images"].forEach(c=>{const i=s[c];if(i&&Object.keys(i).length>0){const l=[];Object.keys(i).sort((o,d)=>{var m,g;return(((m=i[o])==null?void 0:m.index)||0)-(((g=i[d])==null?void 0:g.index)||0)}).forEach(o=>{l.push(o),i[o].isLocal&&t.append(o,i[o].file)}),t.append(c,JSON.stringify(l))}else if(c=="images")return n.push(c+" is not defined")}),["title","description","stock","category_id","index","price","is_dynamic_price"].forEach(c=>{if(s[c]!=null)t.append(c,s[c]);else return n.push(c+" is not defined")}),n.length==0){const i=await(await fetch(`${W}/create_product`,{method:"POST",body:t,headers:a.headers})).json();if(!i||!i.id)return n.push("Server Error, Try Later"),n;r(()=>({selectedProduct:i})),Te.getState().fetchStoreVar()}else return n},async updateProduct(s){if(!s.product_id)return console.log("Product_id required");const a=I.getState().getHeaders();if(!a)return;const t=new FormData;let n=!1;["images","model_images"].forEach(i=>{const l=s[i];if(l&&Object.keys(l)){n=!0;const o=[];Object.keys(l).sort((d,m)=>{var g,p;return(((g=l[d])==null?void 0:g.index)||0)-(((p=l[m])==null?void 0:p.index)||0)}).forEach(d=>{o.push(d),l[d].isLocal&&t.append(d,l[d].file)}),t.append(i,JSON.stringify(o))}}),t.append("product_id",s.product_id),["title","description","stock","category_id","status","index","price","is_dynamic_price"].forEach(i=>{s[i]&&(t.append(i,s[i]),n=!0)});let c=null;if(n&&(c=await fetch(`${W}/update_product`,{method:"PUT",body:t,headers:a.headers})),s.scene_dir){const i=new FormData;i.append("scene_dir",s.scene_dir),i.append("product_id",s.product_id),c=await fetch(`${W}/update_view_product`,{method:"PUT",body:i,headers:a.headers})}c&&(c=await c.json(),console.log("newProduct",c),r(()=>({selectedProduct:c})))},async fetchProducts(s){const a=I.getState().getHeaders();if(!a)return;s||(s={}),s.all_status=!0,s.store_id=a.store.id;const t=new URLSearchParams({});for(const i in s){const l=s[i];l&&t.set(i,l)}const c=await(await fetch(`${W}/get_products/?${t.toString()}`,{headers:a.headers})).json();if(!(!c||!c.list))return r(()=>({products:c})),c},async setSelectedProduct(s){r(()=>({selectedProduct:s}))}}));function Xs(){const{current:r,setAbsPath:s,qs:a,json:t}=ge(),{store:n}=I(),{fetchProducts:c,products:i,setSelectedProduct:l}=at(),[o,d]=j.useState({sortBy:"id",sortableColumns:["id","title","stock","price","date","status"],limit:i==null?void 0:i.limit,page:i==null?void 0:i.page,total:i==null?void 0:i.total,filter:{price:Ke([0,1e5],[0,1e4]),stock:Ke([0,1e4],[0,1e4]),status:Ct(["PAUSE","TRASH","NEW"],[]),index:kt([0,100]),is_dynamic_price:et(),hasScene:et()}}),[m]=j.useState({});return m.json=t,m.filter=o,j.useEffect(()=>{Zs(m.filter,m.json)&&(console.log("diff",m.filter),d({...m.filter}))},[t,n]),j.useEffect(()=>{r("products")&&n&&c({...o,filter:void 0})},[n]),r("products")&&e.jsx("div",{className:"product-list",ref:Oe,children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:o,items_height:80,id:"product_list",datas:(i==null?void 0:i.list)||[],itemsMapper:{images:{getView(g,p,P,C){return G.ImageElement().getView(g,`${W}${p[0]}`,P,C)}},id:{getView(g,p,P,C){return e.jsxs("div",{ref:C,children:["#",p.split("-")[0]]},P.id)}},title:G.StringElement({size_interval:[50,200]}),status:it,stock:G.StringElement(),category_id:{getView(g,p,P,C){return e.jsxs("div",{ref:C,children:["#",p.split("-")[0]]},P.id)}},price:G.StringElement({size:200}),created_at:G.DateStringElement({size:200})},onItemsSelected:(g,p)=>{p.forEach(P=>{P.$itemRef&&(P.$itemRef.style.background="")}),g.forEach(P=>{P.$itemRef&&(P.$itemRef.style.background="#00f2")}),l(g[0]),a({product_id:g[0].id}).setAbsPath(["products","dash_product"])},onQuery:g=>{c(g)},top_height:40,canAddNew:!0,canPaginate:!0,onNewRequired:()=>{s(["products","new_product"])}})})})}function gs({placeholder:r,value:s,isCheckRequired:a,label:t,max:n,min:c,check:i,openEditor:l,prompt:o,editable:d,onChange:m}){const[g,p]=j.useState(s||""),[P,C]=j.useState(0),[M,y]=j.useState(""),[T,_]=j.useState(l||!1),[S,q]=j.useState(0),[v,B]=j.useState(0),F=j.useRef(null),H=j.useRef(null),V=j.useRef(null),[k]=j.useState({validation:z=>(console.log(z,c&&z.length<c,z.length,c),y(""),z=z.toString().trim(),c&&z.length<c?(y(`Minimum length ${c}`),!1):n&&z.length>n?(y(`Maximum length ${n}`),!1):(m==null||m(z),!0))});j.useEffect(()=>{a&&k.validation(g)},[a]);const $=()=>{if(F.current){const ce=`${-10-F.current.getBoundingClientRect().height}px`;F.current.style.top=ce}if(H.current){const ce=`${-10-H.current.getBoundingClientRect().height}px`;H.current.style.top=ce}};return e.jsxs("div",{className:"textarea-text textarea",children:[e.jsx("div",{className:"textarea-top",children:e.jsxs("div",{className:"left-side",children:[e.jsxs("div",{className:"label",children:[t," "]}),o&&e.jsx("div",{className:"textarea-info",onMouseEnter:z=>{if(z.target.className!=="textarea-info")return H.current.style.display="none";clearTimeout(S),H.current&&(H.current.style.display="block"),$()},onMouseLeave:()=>{q(setTimeout(()=>{H.current&&(H.current.style.display="none")},300))},children:e.jsx("div",{className:"promt",ref:H,children:o})}),d&&e.jsx("div",{className:"edit",style:{background:`no-repeat center/80% url(${T?"/src/res/x.png":"/src/res/pencil.png"})`},onClick:()=>{const z=!T;_(z==!1?!k.validation(g):!0),z&&setTimeout(()=>{var ce;(ce=V.current)==null||ce.focus()}),$()},onMouseEnter:z=>{if(z.target.className!=="edit")return H.current.style.display="none";clearTimeout(v),F.current&&(F.current.style.display="block"),$()},onMouseLeave:()=>{B(setTimeout(()=>{F.current&&(F.current.style.display="none")},300))},children:e.jsx("div",{className:"promt",ref:z=>{F.current=z,$()},children:T?"Close editor":"click here to edit value"})})]})}),!T&&e.jsx("div",{className:"value",children:g}),T&&e.jsxs("div",{className:"textarea-editor",children:[e.jsx("textarea",{ref:V,spellCheck:"false",rows:5,placeholder:r,value:g,onChange:z=>{let ce=z.currentTarget.value;for(;ce.includes("  ");)ce=ce.replace("  "," ");ce.length>(n||Number.MAX_VALUE)||(p(ce),y(""),C(ce.length))},onBlur:()=>{i=="auto"&&k.validation(g)&&setTimeout(()=>{_(!1)},0)}}),e.jsxs("div",{className:"count",children:[" ",e.jsx("div",{className:"message",children:M}),n&&`${P}/${n}`]})]})]})}function vs({direction:r="",onClick:s}){return e.jsxs("div",{className:"preview-3d-model-card "+r,onClick:s,children:[e.jsx("div",{className:"image "+r,style:{backgroundImage:"url(/src/res/ert.avif)"}}),e.jsxs("div",{className:"text-side",children:[e.jsx("div",{className:"top",children:"PREVIEW 3D MODEL"}),e.jsxs("div",{className:"features",children:[3," FEATURE","S"]}),e.jsx("div",{className:"prompt",children:"Loader File is missing"})]})]})}function Ys({}){return e.jsxs("div",{className:"statistic-card",children:[e.jsxs("div",{className:"text",children:[e.jsx("h1",{className:"title",children:"Product Statistic"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"title",children:[2e4.toLocaleString(),"  ₽ "]}),e.jsxs("h2",{className:"description",children:["since ",new Date(Date.now()-1e3*60*60*24*30).toDateString()]})]})]}),e.jsx(ea,{})]})}const Ps={with:250,height:120,bars:[{value:80},{value:15},{value:25},{value:10},{value:15},{value:25},{value:15},{value:25},{value:90},{value:25},{value:30},{value:25},{value:30},{value:50},{value:100},{value:90},{value:80},{value:70},{value:60},{value:60},{value:70},{value:80}]};function ea(){return e.jsx("div",{className:"bar-chart",children:e.jsx("div",{className:"bars",children:Ps.bars.map((r,s)=>e.jsx("div",{className:"bar",children:e.jsx("div",{className:"level",style:{height:`${r.value/100*Ps.height}px`,background:`linear-gradient(rgb(0, 90, 180),rgb(23, 108, 194)${((r.value<35?35:r.value)-25)*.7}% , rgb(75, 165, 255)100%)`}})},s))})})}let ta=0;function ts({onChange:r,icon:s,ext:a,label:t,file_name:n}){const[c]=j.useState((Math.random()+ta++).toString()),[i,l]=j.useState(n||"");return e.jsxs("div",{className:"loader-img",children:[e.jsx("input",{type:"file",style:{display:"none"},accept:"application/zip",name:"img",id:c,onChange:o=>{var P;const d=(P=o.target.files)==null?void 0:P[0];if(!d)return;const m=d.name.toLowerCase(),g=m.lastIndexOf("."),p=m.substring(g+1,m.length);if(a&&!a.includes(p))return console.log({_ext:p,ext:a,n:m});l(d.name),r(d)}}),e.jsxs("label",{htmlFor:c,className:"loader-img-ctn",children:[e.jsx("div",{className:"back",children:e.jsx("div",{className:"icon",style:{background:s?`no-repeat center/50% url(${s})`:""}})}),e.jsxs("div",{className:"text",children:[e.jsx("div",{className:"label",children:t??"Upload file"}),e.jsx("div",{className:"prompt",children:i&&(i.length>25?i.substring(0,10)+"..."+i.substring(i.length-10,i.length):i)||"Add new File"})]}),e.jsx("div",{className:"load-icon"})]})]})}const gt=Je(r=>({categories:void 0,selectedCategory:void 0,categoryProducts:void 0,async setCategoryById(s){const a=gt.getState().categories,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedCategory:t}));else if(I.getState().store){const c=await gt.getState().fetchCategories({query:{user_id:s}});r(()=>({selectedCategory:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await gt.getState().fetchCategories({query:{user_id:s}});r(()=>({selectedCategory:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async removeCategory(s){if(!s)return;const a=I.getState().getHeaders();if(!a)return;const n=await(await fetch(`${W}/delete_category/${s}`,{method:"DELETE",headers:a.headers})).json();return Te.getState().fetchStoreVar(),n==null?void 0:n.isDeleted},async createCategory(s){const a=I.getState().getHeaders();if(!a)return;s.index=s.index||0;const t=new FormData,n=[];if(["label","description","catalog_id","index"].forEach(c=>{if(s[c]!=null)t.append(c,s[c]);else return n.push(c+" is not defined")}),n.length==0){const i=await(await fetch(`${W}/create_category`,{method:"POST",body:t,headers:a.headers})).json();if(console.log(i),!i||!i.id)return n.push("Server Error, Try Later"),n;r(()=>({selectedCategory:i})),Te.getState().fetchStoreVar()}else return n},async fetchCategoryProducts(s){if(!(s!=null&&s.category_id))return;const a=I.getState().getHeaders();if(a)try{const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.sortBy&&(t.order_by=s.sortBy),t.category_id=s==null?void 0:s.category_id,t.all_status=!0,t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_products/?${n.toString()}`,{headers:a.headers})).json();if(!i||!i.list)return;r(()=>({categoryProducts:i}))}catch(t){return console.warn(t.message)}},setSelectedCategory(s){r(()=>({selectedCategory:s}))},async updateCategory(s){const a=I.getState().getHeaders();if(!a)return;const t=new FormData;let n=!1;t.append("category_id",s.category_id),["label","index","status","catalog_id","description"].forEach(i=>{s[i]&&(t.append(i,s[i]),n=!0)});let c=null;if(n&&(c=await fetch(`${W}/update_category`,{method:"PUT",body:t,headers:a.headers})),s.scene_dir){const i=new FormData;i.append("scene_dir",s.scene_dir),i.append("category_id",s.category_id),c=await fetch(`${W}/update_view_category`,{method:"PUT",body:i,headers:a.headers})}c&&(c=await c.json(),r(()=>({selectedCategory:c})))},async fetchCategories(s){const a=I.getState().getHeaders();if(a)try{const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.sortBy&&(t.order_by=s.sortBy),s!=null&&s.query.text&&(t.text=s.query.text),t.all_status=!0,t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_categories/?${n.toString()}`,{headers:a.headers})).json();return!i||!i.list?void 0:(r(()=>({categories:i})),i)}catch(t){console.warn(t.message);return}}}));function sa({onChange:r,category_id:s}){const{fetchCategories:a,categories:t}=gt(),[n,c]=j.useState(),[i,l]=j.useState("");return j.useEffect(()=>{a()},[]),j.useEffect(()=>{c(t==null?void 0:t.list.find(o=>o.id==s))},[t]),e.jsxs("div",{className:"choise-category",children:[e.jsxs("div",{className:"choise-ctn",onClick:()=>{l(i?"":"open")},children:[e.jsx("div",{className:"back",children:e.jsx("div",{className:"icon"})}),e.jsxs("div",{className:"text",children:[e.jsx("div",{className:"label",children:"Category"}),e.jsx("div",{className:"name",children:(n==null?void 0:n.label)||"select category"})]}),e.jsx("div",{className:"choise-icon",style:{transform:i?"rotate(180deg)":""}})]}),e.jsx("div",{className:"list-category "+i,style:{height:i?`${45*((t==null?void 0:t.list.length)||0)}px`:"0px"},children:t==null?void 0:t.list.map(o=>e.jsxs("div",{className:"item "+((n==null?void 0:n.id)==o.id?"selected":""),onClick:()=>{c(o),r==null||r(o.id)},children:[e.jsx("div",{className:"label",children:o.label}),e.jsxs("div",{className:"id",children:["#",o.id.split("-")[0]]})]},o.id))})]})}const Nt=Je((r,s)=>({features:void 0,selectedFeature:void 0,productsUseFeature:void 0,async setFeatureById(a){var n,c;const t=Nt.getState().selectedFeature||((n=Nt.getState().features)==null?void 0:n.list.find(i=>i.id==a));if(t)r(()=>({selectedFeature:t}));else{const i=(c=await Nt.getState().fetchFeatures({feature_id:a},!0))==null?void 0:c.list[0];r(()=>({selectedFeature:i}))}},async removeFeature(a){const n=await(await fetch(`${W}/delete_feature/${a}`,{method:"DELETE"})).json();return console.log({json:n}),n==null?void 0:n.isDeleted},async fetchProductsUseFeature(a){r(()=>({productsUseFeature:at.getState().products}))},setSelectedFeature(a){r(()=>({selectedFeature:a}))},async createFeature(a){var i,l,o;const t=I.getState().getHeaders();if(!t)return console.log("not H");const n=new FormData;if(!(a.name=(i=a.name)==null?void 0:i.trim()))return console.log("not name");if(!["components","number","text","email","website","date","time","phone"].includes(a.view=(l=a.view)==null?void 0:l.trim()))return console.log("not View");if(!(a.icon||a.new_icon))return console.log("not icon");if(!a.product_id)return console.log("product_id must be defined");n.append("product_id",a.product_id),n.append("name",a.name),n.append("view",a.view),n.append("icon_0",a.new_icon),n.append("icon",JSON.stringify(["icon_0"]));for(const d of["required","placeholder","case","match","min","max","max_size"])a[d]!=null&&n.append(d,a[d]);(o=a.components)==null||o.forEach(d=>{var m,g,p;((g=((m=d.images)==null?void 0:m[0])&&d.images)==null?void 0:g[0])instanceof Blob&&(n.append("images_0",(p=d.images)==null?void 0:p[0]),n.append("images",JSON.stringify(["images_0"])),d.images=void 0)}),a.components&&n.append("components",JSON.stringify(a.components));const c=await fetch(`${W}/create_feature`,{body:n,headers:t.headers,method:"POST"});try{const d=await c.json();if(!(d!=null&&d.id))return console.log("not ID");s().fetchFeatures(),Te.getState().fetchStoreVar();return}catch(d){console.log(d)}},async updateFeature(a){var i,l,o;const t=I.getState().getHeaders();if(!t)return console.log("not H");const n=new FormData;if(!(a.name=(i=a.name)==null?void 0:i.trim()))return console.log("not name");if(!["components","number","text","email","website","date","time","phone"].includes(a.view=(l=a.view)==null?void 0:l.trim()))return console.log("not View");if(!(a.icon||a.new_icon))return console.log("not icon");a.product_id&&n.append("product_id",a.product_id),n.append("feature_id",a.id),n.append("store_id",t.store.id),n.append("name",a.name),n.append("view",a.view),a.new_icon&&n.append("icon_0",a.new_icon),n.append("icon",JSON.stringify(a.new_icon?["icon_0"]:a.icon));for(const d of["required","placeholder","case","match","min","max","max_size"])a[d]!=null&&n.append(d,a[d]);(o=a.components)==null||o.forEach(d=>{var m,g,p,P,C;if(((g=((m=d.images)==null?void 0:m[0])&&d.images)==null?void 0:g[0])instanceof Blob){const M=((p=d.images)==null?void 0:p[0])instanceof Blob;(P=d.images)!=null&&P[0]&&M&&n.append("images_0",d.images[0]),(C=d.images)!=null&&C[0]&&n.append("images",JSON.stringify(M?["images_0"]:d.images)),d.images=void 0}}),a.components&&n.append("components",JSON.stringify(a.components));const c=await fetch(`${W}/update_feature`,{body:n,headers:t.headers,method:"PUT"});try{const d=await c.json();if(!(d!=null&&d.id))return console.log("not ID");s().fetchFeatures()}catch(d){console.log(d)}Te.getState().fetchStoreVar()},async fetchFeatures(a,t){var o,d,m;const n={};a!=null&&a.page&&(n.page=Number(a.page)),a!=null&&a.limit&&(n.limit=Number(a.limit)),a!=null&&a.sortBy&&(n.order_by=a.sortBy),(o=a==null?void 0:a.query)!=null&&o.text&&(n.text=(d=a.query)==null?void 0:d.text),a!=null&&a.feature_id&&(n.feature_id=a.feature_id),n.store_id=(m=I.getState().store)==null?void 0:m.id;const c=new URLSearchParams({});for(const g in n){const p=n[g];c.set(g,p)}const l=await(await fetch(`${W}/get_features/?${c.toString()}`)).json();if(!(!l||!l.list))return t||r(()=>({features:l})),console.log(l),l}}));function aa({onChange:r,features:s}){const{fetchFeatures:a,features:t}=Nt(),[n,c]=j.useState(s),[i,l]=j.useState("");return j.useEffect(()=>{a()},[]),j.useEffect(()=>{c(s==null?void 0:s.filter(o=>t==null?void 0:t.list.find(d=>d.id==o.id)))},[t]),e.jsxs("div",{className:"choise-features",children:[e.jsxs("div",{className:"choise-ctn",onClick:()=>{l(i?"":"open")},children:[e.jsx("div",{className:"back",children:e.jsx("div",{className:"icon"})}),e.jsxs("div",{className:"text",children:[e.jsx("div",{className:"label",children:"Features"}),e.jsxs("div",{className:"name",children:[(n==null?void 0:n.length)||0," Selected"]})]}),e.jsx("div",{className:"choise-icon",style:{transform:i?"rotate(180deg)":""}})]}),e.jsx("div",{className:"list-features "+i,style:{height:i?`${45*((t==null?void 0:t.list.length)||0)}px`:"0px"},children:t==null?void 0:t.list.map(o=>e.jsxs("div",{className:"item "+(n!=null&&n.find(d=>d.id==o.id)?"selected":""),onClick:()=>{const d=n!=null&&n.find(m=>m.id==o.id)?n.filter(m=>m.id!==o.id):[...n||[],o];c(d),r==null||r(d.map(m=>m.id))},children:[e.jsx("div",{className:"label",children:o.name}),e.jsxs("div",{className:"id",children:["#",o.id.split("-")[0]]})]},o.id))})]})}function na(){var q;const{current:r,setAbsPath:s,json:a}=ge(),{selectedProduct:t,setSelectedProduct:n,updateProduct:c,createProduct:i,removeProduct:l,setProductById:o,fectProductCommands:d}=at(),[m]=j.useState(!1),[g,p]=j.useState([]),[P,C]=j.useState("");j.useEffect(()=>{a!=null&&a.product_id&&o(a==null?void 0:a.product_id)},[a]),j.useEffect(()=>{t&&d({limit:10,product_id:t.id}).then(v=>p((v==null?void 0:v.list)||[]))},[t]);const y=tt().width<1e3?"wrap":"",[T]=j.useState({}),_=r("dash_product"),S=r("new_product");return(_||S)&&(!t&&_?e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}):e.jsxs("div",{className:"product-dash",ref:Oe,children:[e.jsxs("div",{className:"error-panel "+(P?"open":""),children:[e.jsxs("div",{className:"type",children:["ERROR ",e.jsx("span",{onClick:()=>{C("")}})]}),e.jsx("div",{className:"message",children:P})]}),e.jsx(jt,{terme:"white",deteleKey:(t==null?void 0:t.id)||"noga",mode:S?"create":"delete",title:"Product Information",onCreate:()=>{i(T).then(v=>{if(!v)return s(["products","dash_product"]);v.length&&C(v==null?void 0:v.toString())})},onDelete:()=>{t&&l(t.id).then(v=>{v&&n(void 0)})}}),e.jsxs("section",{className:"editor "+y,children:[e.jsxs("div",{className:"editor-left",children:[e.jsxs("div",{className:"editor-name",children:[_&&e.jsx(fe,{isCheckRequired:m,label:"Product Id",value:(t==null?void 0:t.id)||""}),e.jsx("div",{className:"product-title",children:e.jsx(fe,{editable:!0,prompt:"Product Title",isCheckRequired:m,min:3,check:"auto",max:50,label:"Title",placeholder:"Product Title",value:_&&((t==null?void 0:t.title)||""),onChange:v=>{_?t&&c({product_id:t.id,title:v}):T.title=v}})}),e.jsx("div",{className:"product-description",children:e.jsx(gs,{editable:!0,prompt:"Product Description",isCheckRequired:m,min:3,check:"auto",max:250,label:"Description",placeholder:"Product Description",value:_&&((t==null?void 0:t.description)||""),onChange:v=>{_?t&&c({product_id:t.id,description:v}):T.description=v}})})]}),e.jsx("div",{className:"editor-price",children:e.jsx(fe,{type:"number",editable:!0,prompt:"Product Price",isCheckRequired:m,min:0,check:"auto",label:"Price",placeholder:"Product Price",value:_&&((t==null?void 0:t.price)||""),onChange:v=>{_?t&&c({product_id:t.id,price:v}):T.price=v}})}),e.jsx("div",{className:"editor-stock",children:e.jsx(fe,{type:"number",editable:!0,prompt:"Product Stock",isCheckRequired:m,max:1e10,check:"auto",label:"Stock",placeholder:"Product Stock",value:_&&((t==null?void 0:t.stock)||""),onChange:v=>{_?t&&c({product_id:t.id,stock:v}):T.stock=v}})}),_&&e.jsx(ps,{status:(t==null?void 0:t.status)||"PAUSE",onChange:v=>{_?t&&c({product_id:t.id,status:v}):T.status=v}}),e.jsx("div",{className:"editor-category",children:e.jsx(sa,{category_id:_&&(t==null?void 0:t.category_id),onChange:v=>{_?t&&c({product_id:t.id,category_id:v}):T.category_id=v}})}),e.jsx("div",{className:"editor-features",children:e.jsx(aa,{features:_&&((q=t==null?void 0:t.features)==null?void 0:q.list),onChange:v=>{T.features=v,console.log(T)}})})]}),e.jsxs("div",{className:"editor-right",children:[e.jsxs("div",{className:"editor-images",children:[e.jsx("h3",{children:"Product Images"}),e.jsx(Rt,{name:"images",images:_&&(t!=null&&t.images?t.images:[]),autosave:S,onSave:v=>{_?t&&c({product_id:t.id,images:v}):T.images=v}})]}),e.jsxs("div",{className:"editor-mmodel-images",children:[e.jsxs("h3",{children:["3d Model Images ",e.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"normal"},children:"( optional )"})]}),e.jsx(Rt,{name:"model_images",images:_&&(t!=null&&t.images?t.model_images:[]),autosave:S,onSave:v=>{_?t&&c({product_id:t.id,model_images:v}):T.model_images=v}})]}),_&&e.jsx("div",{className:"editor-scene-file",children:e.jsx(ts,{file_name:t==null?void 0:t.scene_dir,ext:["zip"],label:"Upload Scene File",onChange:v=>{_?t&&c({product_id:t.id,scene_dir:v}):T.scene_dir=v}})})]})]}),_&&e.jsxs("div",{className:"product-dash-ctn",children:[e.jsxs("div",{className:"info",children:[e.jsx(Ot,{}),e.jsx(Ys,{})]}),e.jsx(vs,{onClick:()=>{console.log("oo"),s(["products","dash_product","product_preview"])}})]}),_&&e.jsxs("div",{className:"orders",children:[e.jsxs("div",{className:"top",children:[e.jsx("h1",{className:"orders-title",children:"Recent Orders"}),e.jsx("h2",{className:"see-all",children:"SEE ALL"})]}),e.jsx("div",{className:"orders-ctn",children:g.map(v=>e.jsxs("div",{className:"order",children:[e.jsxs("div",{className:"id",children:["#",v.id.split("-")[0]]}),e.jsx("div",{className:"id",children:v.quantity}),e.jsx("div",{className:"date",children:v.updated_at.split("")}),e.jsxs("div",{className:"price",children:[v.price," ","$"]}),e.jsx("div",{className:"status "+v.status.toLocaleLowerCase(),children:v.status})]},v.id))})]})]}))}function ia(){const{current:r}=ge();return r("product_preview")&&e.jsx("div",{className:"product-preview"})}function ra(){return null}const oa=[{label:"products",value:"23",url:"/src/res/package.png",path:["products"]},{label:"categories",value:"15",url:"/src/res/application.png",path:["categories"]},{label:"catalogs",value:"15",url:"/src/res/catalog.png",path:["catalogs"]},{label:"features",value:"78",url:"/src/res/jigsaw.png",path:["features"]}];function ss({active:r,setActive:s}){const{storeVar:a}=Te();return e.jsx("div",{className:"products-list-accessor",children:oa.map((t,n)=>e.jsxs("div",{className:"top-card "+(t.label==r?"active":""),onClick:()=>{s(t)},children:[e.jsx("h2",{className:"label",children:t.label.toUpperCase()}),e.jsx("h2",{className:"value",children:a==null?void 0:a[t.label]}),e.jsx("h2",{className:"icon",style:{backgroundImage:`url(${t.url})`}})]},n))})}function ca(){const{check:r,setAbsPath:s,current:a}=ge();return e.jsx(e.Fragment,{children:r("products")&&e.jsxs("div",{className:"page-product",children:[a("products","dash_product","new_product")&&e.jsx(ss,{active:"products",setActive:t=>s(t.path)}),e.jsx(na,{}),e.jsx(Xs,{}),e.jsx(ia,{}),e.jsx(ra,{})]})})}const ut=Je(r=>({clients:void 0,selectedClient:void 0,clientCommands:void 0,clientVisites:void 0,async setClientById(s){const a=ut.getState().clients,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedClient:t}));else if(I.getState().store){const c=await ut.getState().fetchClients({query:{user_id:s}});r(()=>({selectedClient:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await ut.getState().fetchClients({query:{user_id:s}});r(()=>({selectedClient:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async fetchClientCommands(s){if(!(s!=null&&s.user_id))return;const a=await at.getState().fectProductCommands({...s});if(console.log(a),!(a!=null&&a.list))return r(()=>({clientCommands:void 0}));r(()=>({clientCommands:a}))},async fetchClientVisites({after_date:s,before_date:a,client_id:t,product_id:n,limit:c,page:i}){const l=I.getState().getHeaders();if(!l)return;const o={};o.store_id=l.store.id,o.product_id=n||"",o.client_id=t||"",o.limit=c||25,o.page=i||1,o.after_date=s||"",o.before_date=a||"",o.from_dash=!0;const d=new URLSearchParams({});for(const p in o){const P=o[p];d.set(p,P)}const g=await(await fetch(`${W}/get_client_visited/?${d.toString()}`,{headers:l.headers})).json();!g||!g.list||r(()=>({clientVisites:g}))},async setSelectedClient(s){r(()=>({selectedClient:s}))},async fetchClients(s){const a=I.getState().getHeaders();if(!a)return;const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.order_by&&(t.order_by=s.order_by),s!=null&&s.query.text&&(t.text=s.query.text),s!=null&&s.query.user_id&&(t.user_id=s.query.user_id),s!=null&&s.query.phone&&(t.phone=s.query.phone),t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_store_clients/?${n.toString()}`,{headers:a.headers})).json();if(console.log("clients",i),!(!i||!i.list))return r(()=>({clients:i})),i},async banClient(){}}));function la(){const{current:r,qs:s}=ge(),{clients:a,setSelectedClient:t,fetchClients:n}=ut(),{store:c}=I();return j.useEffect(()=>{r("clients")&&c&&n()},[c]),r("clients")&&e.jsx("div",{className:"client-list",ref:Oe,children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","title","stock","price","date","status"],limit:a==null?void 0:a.limit,page:a==null?void 0:a.page,total:a==null?void 0:a.total,filter:{price:Ke([0,1e5],[0,1e4]),stock:Ke([0,1e4],[0,1e4]),status:Ct(["PAUSE","TRASH","NEW"],[]),index:kt([0,100]),is_dynamic_price:et(),hasScene:et()}},items_height:80,id:"client_list",datas:(a==null?void 0:a.list)||[],itemsMapper:{photos:{getView(i,l,o,d){return G.ImageElement().getView(i,`${l[0].startsWith("/")?W:""}${l[0]}`,o,d)}},id:{getView(i,l,o,d){return e.jsxs("div",{ref:d,children:["#",l.split("-")[0]]},o.id)}},name:G.StringElement({size_interval:[50,200]}),status:{getView(i,l,o,d){return it.getView(i,"VISIBLE",o,d)}},created_at:G.DateStringElement({size:200})},onItemsSelected:(i,l)=>{l.forEach(o=>{o.$itemRef&&(o.$itemRef.style.background="")}),i.forEach(o=>{o.$itemRef&&(o.$itemRef.style.background="#00f2")}),t(i[0]),s({client_id:i[0].id}).setAbsPath(["clients","client_profile"])},onQuery:i=>{n(i)},top_height:40,canPaginate:!0})})})}function da(){const{current:r,setAbsPath:s,json:a,qs:t}=ge(),{selectedClient:n,setClientById:c,clientCommands:i,fetchClientVisites:l,fetchClientCommands:o,clientVisites:d}=ut(),[m,g]=j.useState("commands"),[p]=j.useState(!1),C=tt().width<1e3?"wrap":"";return j.useEffect(()=>{a!=null&&a.client_id&&c(a==null?void 0:a.client_id)},[a]),j.useEffect(()=>{n&&o({limit:5,user_id:n.id}),n&&l({limit:5,client_id:n.id})},[n]),r("client_profile")&&(n?e.jsxs("div",{className:"client-profile",ref:Oe,children:[e.jsx("h1",{children:"Client Information"}),e.jsxs("section",{className:"editor "+C,children:[e.jsx("div",{className:"left-right",children:e.jsx(Rt,{name:"client_profile",images:n.photos||[],cannotEdit:!0})}),e.jsxs("div",{className:"left-side",children:[e.jsx(fe,{isCheckRequired:p,label:"Client Id",value:(n==null?void 0:n.id)||""}),e.jsx(fe,{prompt:"Client Name",isCheckRequired:p,min:3,check:"auto",max:50,label:"Name",placeholder:"Catalog Label",value:n==null?void 0:n.name}),e.jsx(fe,{prompt:"Client Email",isCheckRequired:p,min:3,check:"auto",max:50,label:"Email",placeholder:"Catalog Label",value:n==null?void 0:n.email}),e.jsx(fe,{label:"created At",value:n==null?void 0:n.created_at}),e.jsx(fe,{label:"Join Store At",value:n==null?void 0:n.join_at}),e.jsx(fs,{user:n,channel:"sessions"})]})]}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"btm-list",children:[e.jsx("h1",{children:"Products That Use This Catalog"}),e.jsxs("div",{style:{display:"flex"},children:[e.jsxs("div",{className:"btn "+(m=="commands"?"active":""),onClick:()=>{g("commands")},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Commands"})]}),e.jsxs("div",{className:"btn "+(m=="visites"?"active":""),onClick:()=>{g("visites")},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Visites"})]})]}),e.jsx("h2",{className:"see-all",onClick:()=>{m=="visites"?s(["products"]):s(["command"])},children:"SEE ALL"})]}),m=="commands"&&e.jsx(G,{disableFilterBar:!0,items_height:80,id:"product-use-catalog_list",datas:(i==null?void 0:i.list)||[],itemsMapper:{images:{getView(M,y,T,_){return G.ImageElement().getView(M,`${W}${y[0]}`,T,_)}},id:{getView(M,y,T,_){return e.jsxs("div",{ref:_,children:["#",y.split("-")[0]]},T.id)}},stock:G.StringElement(),price:G.StringElement({size:200}),status:it,created_at:G.DateStringElement({size:200})},onItemsSelected:()=>{}}),m=="visites"&&e.jsx(G,{disableFilterBar:!0,items_height:80,id:"product-use-catalog_list",datas:(d==null?void 0:d.list)||[],itemsMapper:{images:{getView(M,y,T,_){return G.ImageElement().getView(M,`${W}${y[0]}`,T,_)}},id:{getView(M,y,T,_){return e.jsxs("div",{ref:_,children:["#",y.split("-")[0]]},T.id)}},title:G.StringElement({size:200}),visited_at:G.DateStringElement({size:200})},onItemsSelected:M=>{t({product_id:M[0].id}).setAbsPath(["products","dash_product"])}})]})]}):e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}))}function ua(){const{check:r,current:s,setAbsPath:a}=ge();return r("clients")&&e.jsxs("div",{className:"client-page",children:[s("clients","client_profile")&&e.jsx(Yt,{active:"clients",setActive:t=>a(t.path)}),e.jsx(la,{}),e.jsx(da,{})]})}const ds="new_discussion";let At;const Qt=[],Fe=Je(r=>({discussion:void 0,discussions:void 0,messages:void 0,setDiscussion(s){r(()=>({discussion:s}))},async setDiscussionByOtherId({other_id:s,for_moderator:a,findOther:t}){var d,m,g;const n=I.getState().getHeaders();if(!n)return;const c=(d=Fe.getState().discussions)==null?void 0:d.list,i=c==null?void 0:c.find(p=>p.other.id==s&&(a?!Qe(n.store.id,p):!!Qe(n.store.id,p)));if(i){if(((m=Fe.getState().messages)==null?void 0:m.list[0].table_id)==i.id)return;const p=await We.getState().fetchMessages(i.id,"discussions");r(()=>({discussion:i,messages:p}));return}const l=(g=await Fe.getState().fetchDiscussions({no_save:!0,other_id:s,for_moderator:a}))==null?void 0:g.list[0];if(console.log("exist Discussion",l,a),l){const p=await We.getState().fetchMessages(l.id,"discussions");r(()=>({discussion:l,messages:p}));return}const o=await t(s,!!a);o&&Fe.getState().addDiscussion({other:o,for_moderator:a})},async openDiscussionMessages(s){const a=await We.getState().fetchMessages(s,"discussions");r(()=>({messages:a}))},async unBlockDiscussion(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/unblock_discussion/${s.id}`,{method:"PUT",headers:a.headers});try{const n=await t.json();return console.log("unblock_discussion ",n),n!=null&&n.id?(r(({discussions:c})=>({discussions:c&&{...c,list:((c==null?void 0:c.list)||[]).map(i=>i.id==n.id?{...i,...n}:i)}})),n):void 0}catch(n){console.log(n)}},async blockDiscussion(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/block_discussion/${s.id}`,{method:"PUT",headers:a.headers});try{const n=await t.json();return console.log("unblock_discussion ",n),n!=null&&n.id?(r(({discussions:c})=>({discussions:c&&{...c,list:((c==null?void 0:c.list)||[]).map(i=>i.id==n.id?{...i,...n}:i)}})),n):void 0}catch(n){console.log(n)}},async deleteDiscussion(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/delete_discussion/${s.id}`,{method:"DELETE",headers:a.headers});try{const n=await t.json();return console.log("deleteDiscussion ",n),n!=null&&n.deleted?(r(({discussions:c,messages:i,discussion:l})=>({discussions:c&&{...c,list:((c==null?void 0:c.list)||[]).filter(o=>o.id!==s.id)},messages:(l==null?void 0:l.id)==s.id?void 0:i})),!0):void 0}catch(n){console.log(n)}},async createDiscussion({other_id:s,for_moderator:a}){const t=I.getState().getHeaders();if(!t)return;const n=new FormData;n.append("receiver_id",s),n.append("from_id",t.store.id),!a&&n.append("to_id",t.store.id);const c=await fetch(`${W}/create_discussion`,{headers:t.headers,body:n,method:"POST"});try{const i=await c.json();return console.log("createDiscussion",i),i!=null&&i.id?i:void 0}catch(i){console.log(i)}},async addDiscussion({other:s,for_moderator:a}){var o,d;const t=I.getState().getHeaders();if(!t||s.id==t.user.id)return;const n=(o=Fe.getState().discussions)==null?void 0:o.list,c=n==null?void 0:n.find(m=>m.other.id==s.id&&(a?!Qe(t.store.id,m):!!Qe(t.store.id,m)));if(console.log("addDiscussion",{exist:c}),c){const m=await We.getState().fetchMessages(c.id,"discussions");return r(()=>({discussion:c,messages:m})),c}const i=(d=Fe.getState().discussions)==null?void 0:d.list.filter(m=>m.id.startsWith(ds)?(m.receiver_id==s.id||m.creator_id==s.id)&&(a?!Qe(void 0,m):!!Qe(void 0,m)):!1);if(i!=null&&i[0]){console.log("@@@@@@@@@@@@@@@@@@@@@@@"),r(({discussions:m})=>({discussions:m&&{...m}}));return}const l={id:ds+Date.now(),creator_id:t.user.id,receiver_id:s.id,deleted:"",blocked:"",unchecked_count:0,creator_opened_at:"2024-05-09 12:30:15",receiver_opened_at:"",created_at:"",updated_at:"2024-05-09 13:46:04",other:s,from_id:t.store.id,to_id:a?void 0:t.store.id,last_message:void 0,other_att:"creator"};return r(({discussions:m})=>({messages:{list:[],limit:25,page:1,total:0},discussion:l,discussions:m&&{...m,list:[l,...m.list]}})),console.log("NEW DISCUSSION",l),l},async fetchDiscussions({discussion_id:s,no_save:a,other_id:t}){const n=I.getState().getHeaders();if(!n)return;const c=new URLSearchParams({});c.set("from_id",n.store.id),s&&c.set("discussion_id",s),t&&c.set("other_id",t);const l=await(await fetch(`${W}/get_discussions?${c}`,{headers:n.headers})).json();if(console.log("fetch Discussions",l),!l)return;At=r,l.list.forEach(async d=>{Ts(d)});const o=`${n.user.id}/${n.store.id}`;if(!Qt.includes(o)){Qt.push(o);const d=es.subscription(o);await d.create(),d.onMessage(async m=>{var g;if(m.new_discussion){console.log("new_discussion ==>  ",m.new_discussion),Ts(m.new_discussion);const p=m.new_discussion,P=p.receiver.id!=n.user.id?"receiver":"creator";p.other_att=P,p.other=p[P];const C=(g=Fe.getState().discussions)==null?void 0:g.list.filter(M=>M.id.startsWith(ds)?!(M.other.id==p.other.id&&(M.from_id||null)==(p.from_id||null)&&(M.to_id||null)==(p.to_id||null)):!0);r(({discussions:M})=>({discussions:M&&{...M,list:[p,...C||[]]}}))}m.reload_discussion&&(console.log("reload_discussion ==>  "),Fe.getState().fetchDiscussions({}))})}return a||r(({discussions:d})=>({discussions:{...l,list:[...((d==null?void 0:d.list)||[]).filter(m=>m.id.startsWith("new_")),...l.list]}})),l}}));async function Ts(r){if(!I.getState().getHeaders()||Qt.includes(r.id))return;Qt.push(r.id);const a=es.subscription(r.id);await a.create(),a.onMessage(async t=>{var c,i;if(!At)return;const n=Fe.getState().discussion;if(t.reload){const l=(c=Fe.getState().discussions)==null?void 0:c.list,o=(i=await Fe.getState().fetchDiscussions({discussion_id:r.id,no_save:!0}))==null?void 0:i.list;if(console.log("reload Discussion ___________ ",o==null?void 0:o.length),!(o!=null&&o[0].id))return;const d=[...(l==null?void 0:l.map(m=>m.id==r.id?o==null?void 0:o[0]:m))||[]];At(({discussions:m})=>({discussions:m&&{...m,list:d}})),(n==null?void 0:n.id)==(o==null?void 0:o[0].id)&&At(()=>({discussion:{...o==null?void 0:o[0]}}))}if(t.reloadMessage&&(n==null?void 0:n.id)==r.id){console.log("reload Message___________",n);const l=await We.getState().fetchMessages(r.id,"discussions");At(()=>({messages:l,discussion:{...r}}))}})}const ha="new_discussion",ma="new_session",We=Je(r=>({async fetchEditMessage(s){const a=I.getState().getHeaders();if(!a)return;const t=new FormData;t.append("message_id",s.message_id),t.append("text",s.text);const n=await fetch(`${W}/edit_message`,{method:"PUT",headers:a.headers,body:t});try{const c=await n.json();return console.log("edit_message ",c),c!=null&&c.id?c:void 0}catch(c){console.log(c)}},async fetchDeleteMessageBoth(s){const a=I.getState().getHeaders();if(!a)return;console.log("$$$$$$$$");const t=await fetch(`${W}/delete_message/${s}`,{method:"DELETE",headers:a.headers});try{const n=await t.json();return console.log("fetchDeleteMessageBoth",n),n==null?void 0:n.deleted}catch(n){console.log(n)}},async fetchDeleteMessageMe(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/delete_message/${s}`,{method:"DELETE",headers:a.headers});try{const n=await t.json();return console.log("fetchDeleteMessageMe",n),n==null?void 0:n.deleted}catch(n){console.log(n)}},async fetchSendMessage({context:s,context_name:a,files:t,text:n}){if(!s||!s.id)return;if(s.id.startsWith(ha)){const o=await Fe.getState().createDiscussion({other_id:s.other.id,for_moderator:s.to_id==null});if(console.log("D"),!o||!o.id)return;s=o,Fe.getState().setDiscussion(o)}else if(s.id.startsWith(ma)){const o=await Be.getState().fetchCreateSession(s.other.id,n||"");if(console.log("S",o),!o)return;s=o,Be.getState().setSession(o)}const c=I.getState().getHeaders();if(!c)return;const i=new FormData;if(!n&&!t)return;if(t)for(let o=0;o<t.length;o++){const d=t[o];i.append("files_"+o,d)}if(i.append("context_id",s.id),i.append("context_name",a),n&&i.append("text",n),t)for(let o=0;o<t.length;++o){const d=t[o];i.append("files_"+o,d)}const l=await fetch(`${W}/send_message`,{headers:c.headers,body:i,method:"POST"});try{const o=await l.json();return console.log("fetchSendMessage",o),o!=null&&o.id?o:void 0}catch(o){console.log(o)}},async fetchMessages(s,a){if(s.toLowerCase().startsWith("new_"))return;const t=I.getState().getHeaders();if(!t)return;const n=await fetch(`${W}/get_messages/?context_id=${s}&context_name=${a}`,{headers:t.headers});try{const c=await n.json();return c!=null&&c.list?{...c,list:c.list.reverse()}:void 0}catch{}}})),pa="new_session";let It;const Xt=[],Be=Je(r=>({session:void 0,sessions:void 0,messages:void 0,setSession(s){r(()=>({session:s}))},async setSessionByClientId(s){setTimeout(async()=>{var n,c;const a=Be.getState().sessions,t=a==null?void 0:a.find(i=>i.other.id==s);if(console.log("current Session",s,t),t){const i=await We.getState().fetchMessages(t.id,"sessions");r(()=>({session:t,messages:i}))}else{const i=I.getState().getHeaders();if(!i)return;const o=(await(await fetch(`${W}/get_sessions?collaborator_id=${s}&store_id=${i.store.id}`,{headers:i.headers})).json())[0];if(console.log("exist Session",o),o){const d=await We.getState().fetchMessages(o.id,"sessions");r(()=>({session:o,messages:d}))}else{const d=((n=ut.getState().clients)==null?void 0:n.list.find(m=>m.id==s))||((c=await ut.getState().fetchClients({query:{user_id:s}}))==null?void 0:c.list[0]);console.log("collabo",d),d&&Be.getState().addSession(d)}}})},async openSessionMessages(s){const a=await We.getState().fetchMessages(s,"sessions");r(()=>({messages:a}))},async openSession(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/open_session/${s.id}`,{method:"PUT",headers:a.headers});try{const n=await t.json();if(console.log("open_session ",n),!(n!=null&&n.id))return}catch(n){console.log(n)}},async closeSession(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/close_session/${s.id}`,{method:"PUT",headers:a.headers});try{const n=await t.json();if(console.log("close_session ",n),!(n!=null&&n.id))return}catch(n){console.log(n)}},async asReadSession(s){},async deleteSession(s){const a=I.getState().getHeaders();if(!a)return;const t=await fetch(`${W}/delete_session/${s.id}`,{method:"DELETE",headers:a.headers});try{const n=await t.json();if(console.log("deleteSession",n),!n.deleted)return;r(()=>({session:void 0})),Be.getState().fetchSessions()}catch(n){console.log(n)}},async fetchCreateSession(s,a){if(!a)return;const t=I.getState().getHeaders();if(!t)return;const n=new FormData;n.append("receiver_id",s),n.append("store_id",t.store.id),n.append("title",a);const c=await fetch(`${W}/create_session`,{headers:t.headers,body:n,method:"POST"});try{const i=await c.json();return console.log("fetchCreateSession",i),i!=null&&i.id?(Be.getState().fetchSessions(),r(()=>({session:i})),i):void 0}catch(i){console.log(i)}},async addSession(s){var c;const a=(c=Be.getState().sessions)==null?void 0:c.find(i=>i.other.id==s.id);if(a){r(()=>({session:a}));const i=await We.getState().fetchMessages(a.id,"sessions");return r(()=>({messages:i}))}const t=I.getState().user;if(!t)return;const n={id:pa+Date.now(),creator_id:t.id,title:"",receiver_id:s.id,deleted:"",other_att:"creator",closed:"",blocked:"",unchecked_count:0,creator_opened_at:"2024-05-09 12:30:15",receiver_opened_at:"",created_at:"",updated_at:"2024-05-09 13:46:04",other:s};r(({sessions:i})=>({messages:{list:[],limit:25,page:1,total:0},session:n,sessions:[...i||[],n]}))},async fetchSessions(s="all"){const a=I.getState().getHeaders();if(!a)return;console.log(a.store.id);const n=await(await fetch(`${W}/get_sessions?store_id=${a.store.id}&open=${s}`,{headers:a.headers})).json();if(console.log("session",n),!!Array.isArray(n)&&(It=r,n.forEach(async c=>{$s(c)}),r(()=>({sessions:n})),!Xt.includes(a.user.id))){Xt.push(a.user.id);const c=es.subscription(a.user.id);await c.create(),c.onMessage(async i=>{var l;if(i.new_session){$s(i.new_session);const o=i.new_session,d=o.receiver.id!=a.user.id?"receiver":"creator";o.other_att=d,o.other=o[d];const m=(l=Be.getState().sessions)==null?void 0:l.filter(g=>g.id!=(o==null?void 0:o.id));r(()=>({sessions:[...m||[],o]}))}i.reload_session&&Be.getState().fetchSessions()})}}}));async function $s(r){const s=I.getState().getHeaders();if(!s||Xt.includes(r.id))return;Xt.push(r.id);const a=es.subscription(r.id);await a.create(),a.onMessage(async t=>{if(!It)return;console.log("data_session",t);const n=Be.getState().session;if(t.reload){const c=Be.getState().sessions,l=await(await fetch(`${W}/get_sessions?session_id=${r.id}&store_id=${s.store.id}&blocked=all`,{headers:s.headers})).json();if(console.log("reload Session ___________ ",l.length),!(l!=null&&l[0]))return;const o=[...(c==null?void 0:c.map(d=>d.id==r.id?l==null?void 0:l[0]:d))||[]];It(()=>({sessions:o})),(n==null?void 0:n.id)==(l==null?void 0:l[0].id)&&It(()=>({session:{...l==null?void 0:l[0]}}))}if(t.reloadMessage&&(n==null?void 0:n.id)==r.id){console.log("reload Message___________",n);const c=await We.getState().fetchMessages(r.id,"sessions");It(()=>({messages:c,session:{...r}}))}})}function fa({}){var V;const{openChild:r}=Te(),{json:s,qs:a,check:t,pathList:n,setAbsPath:c}=ge(),i=(V=n[3])==null?void 0:V.split("_")[1],[l,o]=j.useState(i||"opened"),{addSession:d,asReadSession:m,closeSession:g,openSession:p,deleteSession:P,fetchSessions:C,session:M,sessions:y,setSessionByClientId:T}=Be(),{user:_,store:S}=I(),{fetchClients:q}=ut();if(j.useEffect(()=>{t("chat")&&!y&&S&&C()},[S]),j.useEffect(()=>{s!=null&&s.client_id&&T(s==null?void 0:s.client_id)},[s]),j.useEffect(()=>{o(i||"opened")},[n]),j.useEffect(()=>{var k;(k=M==null?void 0:M.closed)!=null&&k.includes((_==null?void 0:_.id)||"")&&o("closed")},[M]),!_)return;const v=y==null?void 0:y.filter(k=>{var $;return!(($=k.closed)!=null&&$.includes(_.id))}),B=y==null?void 0:y.filter(k=>{var $;return($=k.closed)==null?void 0:$.includes(_.id)}),F=y==null?void 0:y.filter(k=>k.unchecked_count>0);let H=[];return l=="opened"?H=v:l=="closed"?H=B:H=F,e.jsxs("div",{className:"session-nav",children:[e.jsxs("div",{className:"title",children:[e.jsx("div",{className:"label",children:"Sessions "}),e.jsxs("div",{className:"add-new",onClick:()=>{r(e.jsx(Rs,{user:_,openChild:r,fetchUsers:q,setUser:k=>{d(k)}}),!0,"#0002")},children:[" ",e.jsx("span",{})]})]}),e.jsxs("div",{className:"options",children:[e.jsx("div",{className:"option",onClick:()=>{c(["chat","sessions","sessions_opened"])},children:e.jsxs("div",{className:l=="opened"?"active":"",children:["Open",((v==null?void 0:v.length)||0)>0?e.jsx("span",{}):void 0]})}),e.jsx("div",{className:"option",onClick:()=>{c(["chat","sessions","sessions_closed"])},children:e.jsxs("div",{className:l=="closed"?"active":"",children:["Closed ",((B==null?void 0:B.length)||0)>0?e.jsx("span",{}):void 0]})}),e.jsx("div",{className:"option",onClick:()=>{c(["chat","sessions","sessions_new"])},children:e.jsxs("div",{className:l=="new"?"active":"",children:["New  ",((F==null?void 0:F.length)||0)>0?e.jsx("span",{}):void 0]})})]}),e.jsx("div",{className:"search",children:e.jsxs("div",{className:"input",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{type:"text",placeholder:"Search"})]})}),e.jsx("div",{className:"sessions",children:H==null?void 0:H.map(k=>{var z,ce;let $="";return((z=k.last_message)==null?void 0:z.user_id)==_.id&&(k[`${k.other_att}_opened_at`]?new Date(k[`${k.other_att}_opened_at`])<new Date(((ce=k.last_message)==null?void 0:ce.created_at)||"")?$="one":$="double":$="one"),e.jsxs("div",{className:"session "+((M==null?void 0:M.id)==k.id?"active":""),onClick:A=>{console.log(k.other,_),a({client_id:k.other.id,nav:document.querySelector(".back-close.nav").getBoundingClientRect().width==0?void 0:"min"}).setAbsPath(["chat","sessions"]);const b=A.currentTarget.querySelector(".count");b.style.display="none"},onContextMenu:A=>{A.preventDefault(),r(e.jsx(ga,{closed:!!(B!=null&&B.includes(k)),x:A.clientX,y:A.clientY,onClose:b=>{b?(g(k),o("closed")):(p(k),o("opened"))},onAsRead:()=>{m(k)},onDelete:()=>{P(k)}}))},children:[e.jsx("div",{className:"photo",style:{background:Ye(k.other.photos[0])}}),e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"top-ctn",children:[e.jsx("div",{className:"name",children:Ge(k.other.name,16)}),e.jsx("div",{className:"date",children:k.last_message&&wt(k.last_message.created_at)})]}),e.jsx("i",{className:"center-ctn",children:Ge(k.title,20)}),e.jsxs("div",{className:"btm",children:[e.jsx("div",{className:"checked "+$}),e.jsx("div",{className:"text",children:k.last_message?Ge(k.last_message.text,24):"New Session"}),e.jsx("div",{className:"count",style:{display:(M==null?void 0:M.id)==k.id?"none":k.unchecked_count>0?"flex":"none"},children:k.unchecked_count})]})]})]},k.id)})})]})}function ga({x:r,y:s,onClose:a,onAsRead:t,onDelete:n,closed:c}){const i=j.useRef(null);return j.useEffect(()=>{i.current&&xt(i.current)}),e.jsxs("div",{ref:i,className:"discussion-popu",style:{top:`${s}px`,left:`${r}px`},children:[e.jsxs("div",{className:"as-read",onClick:t,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Mark as read"})]}),e.jsxs("div",{className:"block",onClick:()=>a(!c),children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:c?"Open":"Close"})]}),e.jsxs("div",{className:"delete",onClick:n,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Delete chat"})]})]})}const nt=Je(r=>({collaborators:void 0,selectedCollaborator:void 0,async updateCollaborator(s){},async change_collaborator_role(s){var c;const a=I.getState().getHeaders();if(!a)return;s.store_id=(c=I.getState().store)==null?void 0:c.id;const t=new FormData,n=[];["store_id","new_role_id","collaborator_id"].forEach(i=>{if(s[i]!=null)t.append(i,s[i]||"");else return n.push(i+" is not defined")});{const l=await(await fetch(`${W}/change_collaborator_role`,{method:"PUT",body:t,headers:a.headers})).json();if(!l||!l.id)return n.push("Server Error, Try Later"),n}},async addCollaborator(s){console.log(s);const a=I.getState().store;if(!a)return;let t=I.getState().user;if(!t)return;s.store_id=a.id;const n=new FormData,c=[];["store_id","role_id","email"].forEach(l=>{if(s[l]!=null)n.append(l,s[l]);else return c.push(l+" is not defined")});const i=new Headers;i.append("Authorization",`Bearer ${t.token}`);{const o=await(await fetch(`${W}/add_collaborator`,{method:"POST",body:n,headers:i})).json();if(!o||!o.id)return c.push("Server Error, Try Later"),c;r(()=>({selectedCollaborator:o})),Te.getState().fetchUsersVar(),ge.getState().setAbsPath(["collaborators","collaborator_profile"])}},async setSelectedCollaborator(s){r(()=>({selectedCollaborator:s}))},async setCollaboratorById(s){const a=nt.getState().collaborators,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedCollaborator:t}));else if(I.getState().store){const c=await nt.getState().fetchCollaborators({query:{user_id:s}});r(()=>({selectedCollaborator:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await nt.getState().fetchCollaborators({query:{user_id:s}});r(()=>({selectedCollaborator:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async removeCollaborator(s){let a=I.getState().getHeaders();if(!a)return;const t=new FormData;t.append("store_id",a.store.id),t.append("collaborator_id",s);const n={method:"DELETE",headers:a.headers,body:t},i=await(await fetch(`${W}/remove_collaborator`,n)).json();Te.getState().fetchUsersVar(),i.deleted&&r(()=>({selectedCollaborator:void 0}))},async fetchCollaborators(s){var l,o,d,m,g,p,P;let a=I.getState().getHeaders();if(!a)return;const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.order_by&&(t.order_by=s.order_by),(l=s==null?void 0:s.query)!=null&&l.text&&(t.text=(o=s.query)==null?void 0:o.text),(d=s==null?void 0:s.query)!=null&&d.user_id&&(t.user_id=(m=s.query)==null?void 0:m.user_id),(g=s==null?void 0:s.query)!=null&&g.phone&&(t.phone=(p=s.query)==null?void 0:p.phone),t.store_id=(P=a.store)==null?void 0:P.id;const n=new URLSearchParams({});for(const C in t){const M=t[C];n.set(C,M)}const i=await(await fetch(`${W}/get_store_collaborators/?${n.toString()}`,{headers:a.headers})).json();if(!(!i||!i.list))return r(()=>({collaborators:i})),i},async banCollaborator(s){}})),vt=Je(r=>({moderators:void 0,selectedModerator:void 0,moderatorCommands:void 0,moderatorVisites:void 0,async setModeratorById(s){const a=vt.getState().moderators,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedModerator:t}));else{const n=await vt.getState().fetchModerators({query:{user_id:s}});r(()=>({selectedModerator:n==null?void 0:n.list.find(c=>c.id==s)}))}},async setSelectedModerator(s){r(()=>({selectedModerator:s}))},async fetchModerators(s){var l,o,d;const a=I.getState().getHeaders();if(!a)return;const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.order_by&&(t.order_by=s.order_by),(l=s==null?void 0:s.query)!=null&&l.text&&(t.text=s.query.text),(o=s==null?void 0:s.query)!=null&&o.user_id&&(t.user_id=s.query.user_id),(d=s==null?void 0:s.query)!=null&&d.phone&&(t.phone=s.query.phone),t.store_id=a.store.id;const n=new URLSearchParams({});for(const m in t){const g=t[m];n.set(m,g)}const i=await(await fetch(`${W}/get_moderators/?${n.toString()}`,{headers:a.headers})).json();if(!(!i||!i.list))return r(()=>({moderators:i})),i},async banModerator(){}}));function us(){var k;const{discussion:r,discussions:s,fetchDiscussions:a,addDiscussion:t,blockDiscussion:n,deleteDiscussion:c,unBlockDiscussion:i,setDiscussionByOtherId:l}=Fe(),{check:o,json:d,pathList:m,qs:g,setAbsPath:p}=ge(),P=(k=m[3])==null?void 0:k.split("_")[1],[C,M]=j.useState(P||"all"),{openChild:y}=Te(),{user:T,store:_}=I(),{fetchCollaborators:S}=nt(),{fetchModerators:q}=vt();if(j.useEffect(()=>{(d!=null&&d.collaborator_id||d!=null&&d.moderator_id)&&l({other_id:(d==null?void 0:d.collaborator_id)||(d==null?void 0:d.moderator_id),for_moderator:!!(d!=null&&d.moderator_id),async findOther($,z){var ce,A,b,E;return z?((ce=vt.getState().moderators)==null?void 0:ce.list.find(J=>J.id==$))||((A=await vt.getState().fetchModerators({query:{user_id:$}}))==null?void 0:A.list[0]):((b=nt.getState().collaborators)==null?void 0:b.list.find(J=>J.id==$))||((E=await nt.getState().fetchCollaborators({query:{user_id:$}}))==null?void 0:E.list[0])}}),o("chat")&&!s&&_&&a({}),M(P||"all")},[d,_]),j.useEffect(()=>{M(P||"all")},[m]),!T)return;const v=s==null?void 0:s.list.filter($=>{var z;return!((z=$.blocked)!=null&&z.includes(T.id))&&!!Qe((_==null?void 0:_.id)||"",$)}),B=s==null?void 0:s.list.filter($=>{var z;return(z=$.blocked)==null?void 0:z.includes(T.id)}),F=s==null?void 0:s.list.filter($=>{var z;return $.unchecked_count>0&&!((z=$.blocked)!=null&&z.includes(T.id))}),H=s==null?void 0:s.list.filter($=>!Qe((_==null?void 0:_.id)||"",$));let V=[];return C=="admin"?V=H:C=="new"?V=F:C=="blocked"?V=B:V=v,e.jsxs("div",{className:"discussion-nav",children:[e.jsxs("div",{className:"title",children:[e.jsx("div",{className:"label",children:"Chats "}),e.jsxs("div",{className:"add-new",onClick:()=>{y(e.jsx(Rs,{fetchUsers:S,openChild:y,user:T,setUser:($,z)=>{console.log({discMode:z}),t({other:$,for_moderator:z=="moderators"}),z=="moderators"&&p(["chat","discussions","discussions_admin"])},selector:{list:[{name:"collaborators",fetch:S},{name:"moderators",fetch:q}]}}),!0,"#0002")},children:[" ",e.jsx("span",{})]})]}),e.jsxs("div",{className:"options",children:[e.jsx("div",{className:"option",onClick:()=>{g(d||{}).setAbsPath(["chat","discussions","discussions_all"])},children:e.jsxs("div",{className:C=="all"?"active":"",children:["All",((v==null?void 0:v.length)||0)>0?e.jsx("span",{}):void 0]})}),e.jsx("div",{className:"option",onClick:()=>{g(d||{}).setAbsPath(["chat","discussions","discussions_new"])},children:e.jsxs("div",{className:C=="new"?"active":"",children:["New ",((F==null?void 0:F.length)||0)>0?e.jsx("span",{}):void 0]})}),e.jsx("div",{className:"option",onClick:()=>{g(d||{}).setAbsPath(["chat","discussions","discussions_blocked"])},children:e.jsxs("div",{className:C=="blocked"?"active":"",children:["Blocked  ",((B==null?void 0:B.length)||0)>0?e.jsx("span",{}):void 0]})}),e.jsx("div",{className:"option",onClick:()=>{g(d||{}).setAbsPath(["chat","discussions","discussions_admin"])},children:e.jsxs("div",{className:C=="admin"?"active":"",children:["Admin  ",((H==null?void 0:H.length)||0)>0?e.jsx("span",{}):void 0]})})]}),e.jsx("div",{className:"search",children:e.jsxs("div",{className:"input",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{type:"text",placeholder:"Search"})]})}),e.jsx("div",{className:"discussions",children:V==null?void 0:V.map($=>{var ce;let z="";return((ce=$.last_message)==null?void 0:ce.user_id)==T.id&&($[`${$.other_att}_opened_at`]?new Date($[`${$.other_att}_opened_at`])<new Date($.last_message.created_at)?z="one":z="double":z="one"),e.jsxs("div",{className:"discussion "+((r==null?void 0:r.id)==$.id?"active":""),onClick:A=>{$.unchecked_count=0,_&&g({[Qe(_.id,$)?"collaborator_id":"moderator_id"]:$.other.id,nav:document.querySelector(".back-close.nav").getBoundingClientRect().width==0?void 0:"min"}).setAbsPath(["chat","discussions","discussions_"+(C||"_all")]);const b=A.currentTarget.querySelector(".count");b.style.display="none"},onContextMenu:A=>{A.preventDefault(),y(e.jsx(va,{canBlock:!!Qe(_==null?void 0:_.id,$),blocked:!!(B!=null&&B.includes($)),x:A.clientX,y:A.clientY,onBlock:b=>{b?(n($),g(d||{}).setAbsPath(["chat","discussions","discussions_blocked"])):(i($),g(d||{}).setAbsPath(["chat","discussions","discussions_all"]))},onAsRead:()=>{},onDelete:()=>{c($)}}))},children:[e.jsx("div",{className:"photo",style:{background:Ye($.other.photos[0])}}),e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"top-ctn",children:[e.jsx("div",{className:"name",children:Ge($.other.name,16)}),e.jsx("div",{className:"date",children:$.last_message&&wt($.last_message.created_at)})]}),e.jsxs("div",{className:"btm",children:[e.jsx("div",{className:"checked "+z}),e.jsx("div",{className:"text",children:$.last_message?Ge($.last_message.text,24):"New Discussion"}),e.jsx("div",{className:"count",style:{display:(r==null?void 0:r.id)==$.id?"none":$.unchecked_count>0?"flex":"none"},children:$.unchecked_count})]})]})]},$.id)})})]})}function va({x:r,y:s,onBlock:a,onAsRead:t,onDelete:n,blocked:c,canBlock:i}){const l=j.useRef(null);return j.useEffect(()=>{l.current&&xt(l.current)}),e.jsxs("div",{ref:l,className:"discussion-popu",style:{top:`${s}px`,left:`${r}px`},children:[e.jsxs("div",{className:"as-read",onClick:t,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Mark as read"})]}),i&&e.jsxs("div",{className:"block",onClick:()=>a(!c),children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:c?"Unblock":"Bolck"})]}),e.jsxs("div",{className:"delete",onClick:n,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Delete chat"})]})]})}function hs(){var A;const{discussion:r,messages:s}=Fe(),{fetchSendMessage:a,fetchDeleteMessageBoth:t,fetchDeleteMessageMe:n,fetchEditMessage:c}=We(),{user:i}=I(),{openChild:l}=Te(),{qs:o,json:d,navBack:m}=ge(),[g,p]=j.useState(!1),[P,C]=j.useState(1),[M,y]=j.useState(!1),T=j.useRef(null),_=j.useRef(null),[S,q]=j.useState(null),[v]=j.useState(Date.now()+""),[B,F]=j.useState({top:0,bottom:0,height:0,isOpen:!1,lastid:0}),H=tt(),V=()=>{if(!_.current)return;const b=_.current,E=Math.ceil(b.scrollHeight/(b.getBoundingClientRect().height||20)),J=Math.ceil(b.scrollHeight/20),pe=b.value.split(`
`).length;let Ce=Math.max(E,pe,J);Ce=Ce>10?10:Ce-1>=1?Ce-1:1,C(Ce)};j.useEffect(()=>{V()},[H]),j.useEffect(()=>{window.addEventListener("click",()=>{M&&y(!1)})},[]),j.useEffect(()=>{T.current&&(T.current.scrollTop=T.current.scrollHeight)},[s]);const k=r==null?void 0:r.other.photos[0],$=(b,E)=>b.list[E].user_id==(i==null?void 0:i.id)?"right":"left",z=(b,E)=>b.list[E-1]&&b.list[E-1].user_id==(i==null?void 0:i.id)?"right":"left",ce=(b,E)=>b.list[E+1]&&(b.list[E+1].user_id==(i==null?void 0:i.id)?"right":"left");return e.jsxs("div",{className:"discussion-center",children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"open-nonav",onClick:()=>{m()}}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${k!=null&&k.startsWith("/")?W:""}${k})`},onClick:()=>{d!=null&&d.moderator_id?o({moderator_id:r.other.id}).setAbsPath(["moderators","moderator_profile"]):o({collaborator_id:r.other.id}).setAbsPath(["collaborators","collaborator_profile"])}}),e.jsxs("div",{className:"ctn-name",children:[e.jsx("div",{className:"name",children:Ge(r.other.name,50)}),r[`${r.other_att}_opened_at`]&&e.jsxs("div",{className:"last-time",children:["Last seen ",wt(r[`${r.other_att}_opened_at`])]})]}),e.jsx("div",{className:"option",children:e.jsx("div",{className:"more",onClick:He()})})]})]}),!r&&e.jsx("div",{className:"no-discussion",children:e.jsx("div",{className:"label",children:"Select a chat to start messaging"})}),r&&i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"messages",ref:b=>{T.current=b,g||(T.current&&T.current.scrollTo({top:T.current.scrollHeight}),p(!0))},onScroll:b=>{const E=b.currentTarget;clearInterval(B.lastid);const J=setTimeout(()=>{const pe={isOpen:!1,height:E.scrollHeight,bottom:E.scrollHeight-(E.scrollTop+E.getBoundingClientRect().height),top:E.scrollTop,onProcess:!1,lastid:J};pe.bottom>150&&(pe.isOpen=!0),F(pe),console.log(J)},100);B.lastid=J},children:(A=s==null?void 0:s.list)==null?void 0:A.map((b,E)=>{var L;const J=$(s,E),pe=z(s,E),Ce=ce(s,E);let K="";return J==pe?Ce&&pe==Ce&&(K="mid"):Ce&&J==Ce&&(K="start"),e.jsx("div",{className:"message",children:e.jsxs("div",{className:"ctn "+J+" "+K,onContextMenu:N=>{N.preventDefault(),l(e.jsx(xa,{forMe:i.id==b.user_id,x:N.clientX,y:N.clientY,onDeleteBoth:()=>{t(b.id)},onDeleteMe:()=>{n(b.id)},onEdit:()=>{l(e.jsx(ja,{x:N.clientX,y:N.clientY,text:b.text,onEdit:U=>{l(void 0),c({message_id:b.id,text:U})}}),!0)},other:r.other}))},children:[e.jsx("div",{className:"text",children:b.text&&b.text.split(" ").map((N,U)=>N.split(`
`).map((O,h)=>O?e.jsx("span",{style:{marginRight:"4px"},children:O},U+"+"+h):e.jsx("div",{style:{width:"100%",height:"1em"}},U+"~"+h)))}),e.jsx("div",{className:"files",children:(L=b.files)==null?void 0:L.map(N=>e.jsxs("div",{className:"message-file",onClick:()=>{window.open(`${N.startsWith("/")?W:""}${N}`,void 0)},children:[e.jsx("div",{className:"save"}),e.jsx("div",{className:"lable",children:N.length>35?Ge(N,25)+N.substring(N.length-8,N.length):N})]},N))}),e.jsxs("div",{className:"info",children:[b.created_at!=b.updated_at&&e.jsx("div",{className:"edited"}),e.jsx("div",{className:"date",children:wt(b.created_at)})]})]})},b.id)})}),e.jsxs("div",{className:"sender",children:[B.isOpen&&e.jsx("div",{className:"down-btn",onClick:()=>{T.current&&T.current.scrollTo({behavior:"smooth",top:B.height})}}),M&&e.jsx("div",{className:"emoji-list",onClick:b=>{b.preventDefault(),b.stopPropagation()},children:Os.map(b=>e.jsx("span",{onClick:E=>{E.preventDefault(),E.stopPropagation(),_.current&&(_.current.value+=b.char)},children:b.char},b.char))}),e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"left",children:[e.jsx("input",{multiple:!0,type:"file",style:{display:"none"},name:"message_file",id:v+"message_file",onChange:b=>{if(!b.currentTarget.files)return;const E=[];for(let J=0;J<b.currentTarget.files.length;J++){const pe=b.currentTarget.files[J];E.push(pe)}q(E.length>0?S?[...S,...E]:E:null)}}),e.jsx("label",{htmlFor:v+"message_file",className:"add-file",onClick:He()}),e.jsx("div",{className:"emoji-min",onClick:b=>{b.preventDefault(),b.stopPropagation(),He()(b),y(!M)}})]}),e.jsxs("div",{className:"sender_center",children:[e.jsx("div",{className:"files",children:S&&S.map(b=>e.jsxs("div",{className:"file",children:[e.jsx("div",{className:"remove",onClick:()=>{S&&q(S.filter(E=>E!==b))}}),e.jsx("div",{className:"text",children:b.name})]},b.name))}),e.jsx("textarea",{autoFocus:!0,ref:_,name:"discussion_sender",placeholder:"Type a message here..",id:"discussion_sender",style:{height:`${P*20}px`},cols:30,rows:10,onChange:b=>{V()},onKeyDown:()=>{y(!1)}})]}),e.jsx("div",{className:"right",children:e.jsx("div",{className:"send",onClick:b=>{var E;He()(b),a({context:r,context_name:"discussions",files:S,text:(E=_.current)==null?void 0:E.value}),q(null),_.current&&(_.current.value="")},children:e.jsx("div",{className:"icon"})})})]})]})]})]})}function xa({x:r,y:s,onEdit:a,onDeleteBoth:t,onDeleteMe:n,other:c,forMe:i}){const l=j.useRef(null);return j.useEffect(()=>{l.current&&xt(l.current)}),e.jsxs("div",{ref:l,className:"message-popu",style:{top:`${s}px`,left:`${r}px`},children:[i&&e.jsxs("div",{className:"edit",onClick:o=>{o.preventDefault(),o.stopPropagation(),a()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Edit message"})]}),e.jsxs("div",{className:"delete-me",onClick:n,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Delete for me"})]}),i&&e.jsxs("div",{className:"delete-both",onClick:t,children:[e.jsx("div",{className:"icon"}),e.jsxs("div",{className:"label",children:["Delete also for ",c.name," "]})]})]})}function ja({x:r,y:s,onEdit:a,text:t}){const n=j.useRef(null),[c,i]=j.useState(t);return j.useEffect(()=>{n.current&&xt(n.current)}),e.jsxs("div",{ref:n,className:"message-edit-popu",style:{top:`${s}px`,left:`${r}px`},onClick:l=>{l.stopPropagation(),l.preventDefault()},children:[e.jsx("div",{className:"title",children:"Edit message"}),e.jsxs("div",{className:"input",children:[e.jsx("textarea",{value:c,onChange:l=>{i(l.currentTarget.value)}}),e.jsx("div",{className:"save",onClick:()=>{a(c)},children:e.jsxs("div",{className:"save-ctn",children:[e.jsx("div",{className:"label",children:"Save"}),e.jsx("div",{className:"icon"})]})})]})]})}const ya=250,Ms=r=>r.split(" ").map((s,a)=>s.includes(`
`)?s.split(`
`).map((t,n)=>e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:"4px"},children:t}),e.jsx("br",{})]},a+"_"+n)):e.jsx("span",{style:{marginRight:"4px"},children:s},a));function _a(){var J,pe,Ce,K,L;const{session:r,messages:s,fetchCreateSession:a}=Be(),{fetchSendMessage:t,fetchDeleteMessageBoth:n,fetchDeleteMessageMe:c,fetchEditMessage:i}=We(),{user:l}=I(),{openChild:o}=Te(),{qs:d,navBack:m}=ge(),[g,p]=j.useState(!1),[P,C]=j.useState(1),[M,y]=j.useState(!1),T=j.useRef(null),_=j.useRef(null),[S,q]=j.useState(""),[v,B]=j.useState(null),[F]=j.useState(Date.now()+""),[H,V]=j.useState({top:0,bottom:0,height:0,isOpen:!1,lastid:0}),k=tt(),$=()=>{if(!_.current)return;const N=_.current,U=Math.ceil(N.scrollHeight/(N.getBoundingClientRect().height||20)),O=Math.ceil(N.scrollHeight/20),h=N.value.split(`
`).length;let ne=Math.max(U,h,O);ne=ne>10?10:ne-1>=1?ne-1:1,C(ne),console.log(ne)};j.useEffect(()=>{$()},[k]),j.useEffect(()=>{window.addEventListener("click",()=>{y(!1)})},[]);const z=r==null?void 0:r.other.photos[0],ce=(N,U)=>N.list[U].user_id==(l==null?void 0:l.id)?"right":"left",A=(N,U)=>N.list[U-1]&&N.list[U-1].user_id==(l==null?void 0:l.id)?"right":"left",b=(N,U)=>N.list[U+1]&&(N.list[U+1].user_id==(l==null?void 0:l.id)?"right":"left"),E=!(r!=null&&r.title);return e.jsxs("div",{className:"session-center",children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"open-nonav",onClick:()=>{m()}}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${z!=null&&z.startsWith("/")?W:""}${z})`},onClick:()=>{d({client_id:r.other.id}).setAbsPath(["clients","client_profile"])}}),e.jsxs("div",{className:"ctn-name",children:[e.jsx("div",{className:"name",children:Ge(r.other.name,50)}),r[`${r.other_att}_opened_at`]&&e.jsxs("div",{className:"last-time",children:["Last seen ",wt(r[`${r.other_att}_opened_at`])]})]}),e.jsx("div",{className:"option",children:e.jsx("div",{className:"more",onClick:He()})})]})]}),!r&&e.jsx("div",{className:"no-discussion",children:e.jsx("div",{className:"label",children:"Select a chat to start messaging"})}),r&&l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"top-title",onClick:N=>{o(e.jsx(Na,{x:N.clientX,y:N.clientY,text:r.title}))},children:[e.jsx("div",{className:"ctn-title",children:e.jsx("div",{className:"text-title",children:Ge(r.title,50)})}),e.jsxs("div",{className:"option",children:[e.jsx("div",{className:"img",style:{background:`no-repeat center/cover url(${l.photos[0].startsWith("/")?W:""}${l.photos[0]})`}}),e.jsx("div",{className:"img",style:{background:`no-repeat center/cover url(${r.other.photos[0].startsWith("/")?W:""}${r.other.photos[0]})`}}),e.jsx("div",{className:"status",onClick:He(),children:(J=r.closed)!=null&&J.includes(l.id)&&((pe=r.closed)!=null&&pe.includes(r.other.id))||(Ce=r.closed)!=null&&Ce.includes(l.id)?"Closed":((K=r.closed)!=null&&K.includes(r.other.id),"Open")})]})]}),E&&e.jsx("div",{className:"title",children:e.jsxs("div",{className:"ctn",children:[e.jsx("h1",{className:"label",children:"New Session Title"}),e.jsx("div",{className:"text",children:Ms(S)})]})}),e.jsx("div",{className:"messages",style:{display:E?"none":""},ref:N=>{T.current=N,g||(T.current&&T.current.scrollTo({top:T.current.scrollHeight}),p(!0))},onScroll:N=>{const U=N.currentTarget;clearInterval(H.lastid);const O=setTimeout(()=>{const h={isOpen:!1,height:U.scrollHeight,bottom:U.scrollHeight-(U.scrollTop+U.getBoundingClientRect().height),top:U.scrollTop,onProcess:!1,lastid:O};h.bottom>150&&(h.isOpen=!0),V(h)},100);H.lastid=O},children:(L=s==null?void 0:s.list)==null?void 0:L.map((N,U)=>{var he;const O=ce(s,U),h=A(s,U),ne=b(s,U);let ue="";return O==h?ne&&h==ne&&(ue="mid"):ne&&O==ne&&(ue="start"),e.jsx("div",{className:"message",children:e.jsxs("div",{className:"ctn "+O+" "+ue,onContextMenu:le=>{le.preventDefault(),o(e.jsx(ba,{forMe:l.id==N.user_id,x:le.clientX,y:le.clientY,onDeleteBoth:()=>{n(N.id)},onDeleteMe:()=>{c(N.id)},onEdit:()=>{o(e.jsx(Sa,{x:le.clientX,y:le.clientY,text:N.text,onEdit:je=>{o(void 0),i({message_id:N.id,text:je})}}),!0)},other:r.other}))},children:[e.jsx("div",{className:"text",children:N.text&&N.text.split(" ").map((le,je)=>le.split(`
`).map((be,we)=>be?e.jsx("span",{style:{marginRight:"4px"},children:be},je+"+"+we):e.jsx("div",{style:{width:"100%",height:"1em"}},je+"~"+we)))}),e.jsx("div",{className:"files",children:(he=N.files)==null?void 0:he.map(le=>e.jsxs("div",{className:"message-file",onClick:()=>{window.open(`${le.startsWith("/")?W:""}${le}`,void 0)},children:[e.jsx("div",{className:"save"}),e.jsx("div",{className:"lable",children:le.length>35?Ge(le,25)+le.substring(le.length-8,le.length):le})]},le))}),e.jsxs("div",{className:"info",children:[N.created_at!=N.updated_at&&e.jsx("div",{className:"edited"}),e.jsx("div",{className:"date",children:wt(N.created_at)})]})]})},N.id)})}),e.jsxs("div",{className:"sender",children:[H.isOpen&&e.jsx("div",{className:"down-btn",onClick:()=>{T.current&&T.current.scrollTo({behavior:"smooth",top:H.height})}}),M&&e.jsx("div",{className:"emoji-list",onClick:N=>{N.preventDefault(),N.stopPropagation()},children:Os.map(N=>e.jsx("span",{onClick:U=>{U.preventDefault(),U.stopPropagation(),q(S+N.char)},children:N.char},N.char))}),e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"left",children:[!E&&e.jsxs(e.Fragment,{children:[e.jsx("input",{multiple:!0,type:"file",style:{display:"none"},name:"message_file",id:F+"message_file",onChange:N=>{if(!N.currentTarget.files)return;const U=[];for(let O=0;O<N.currentTarget.files.length;O++){const h=N.currentTarget.files[O];U.push(h)}B(U.length>0?v?[...v,...U]:U:null)}}),e.jsx("label",{htmlFor:F+"message_file",className:"add-file",onClick:He()}),e.jsx("div",{className:"emoji-min",onClick:N=>{N.preventDefault(),N.stopPropagation(),He()(N),y(!M)}})]})," ",E&&e.jsxs("div",{className:"text-length",children:[S.length,E?"/"+ya:""]})]}),e.jsxs("div",{className:"sender_center",children:[e.jsx("div",{className:"files",style:{display:E?"none":""},children:v&&v.map(N=>e.jsxs("div",{className:"file",children:[e.jsx("div",{className:"remove",onClick:()=>{v&&B(v.filter(U=>U!==N))}}),e.jsx("div",{className:"text",children:N.name})]},N.name))}),e.jsx("textarea",{autoFocus:!0,ref:_,name:"session_sender",placeholder:"Type a message here..",id:"session_sender",style:{height:`${P*20}px`},cols:30,rows:10,onChange:N=>{$()},onKeyDown:()=>{y(!1)}})]}),e.jsx("div",{className:"right",children:e.jsx("div",{className:"send",onClick:N=>{He()(N),E?a(r.other.id,S):t({context:r,context_name:"sessions",files:v,text:S}),B(null),q("")},children:e.jsx("div",{className:"icon"})})})]})]})]})]})}function ba({x:r,y:s,onEdit:a,onDeleteBoth:t,onDeleteMe:n,other:c,forMe:i}){const l=j.useRef(null);return j.useEffect(()=>{l.current&&xt(l.current)}),e.jsxs("div",{ref:l,className:"message-popu",style:{top:`${s}px`,left:`${r}px`},children:[i&&e.jsxs("div",{className:"edit",onClick:o=>{o.preventDefault(),o.stopPropagation(),a()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Edit message"})]}),e.jsxs("div",{className:"delete-me",onClick:n,children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Delete for me"})]}),i&&e.jsxs("div",{className:"delete-both",onClick:t,children:[e.jsx("div",{className:"icon"}),e.jsxs("div",{className:"label",children:["Delete also for ",c.name," "]})]})]})}function Na({x:r,y:s,text:a}){const t=j.useRef(null);return j.useEffect(()=>{t.current&&xt(t.current)}),e.jsx("p",{ref:t,className:"title-popup",style:{top:`${s}px`,left:`${r}px`},children:Ms(a||"")})}function Sa({x:r,y:s,onEdit:a,text:t}){const n=j.useRef(null),[c,i]=j.useState(t);return j.useEffect(()=>{n.current&&xt(n.current)}),e.jsxs("div",{ref:n,className:"message-edit-popu",style:{top:`${s}px`,left:`${r}px`},onClick:l=>{l.stopPropagation(),l.preventDefault()},children:[e.jsx("div",{className:"title",children:"Edit message"}),e.jsxs("div",{className:"input",children:[e.jsx("textarea",{value:c,onChange:l=>{i(l.currentTarget.value)}}),e.jsx("div",{className:"save",onClick:()=>{a(c)},children:e.jsxs("div",{className:"save-ctn",children:[e.jsx("div",{className:"label",children:"Save"}),e.jsx("div",{className:"icon"})]})})]})]})}function wa(){const{check:r,qs:s,pathList:a,json:t}=ge(),{user:n}=I(),c={discussions:e.jsx(us,{}),groups:e.jsx(us,{}),sessions:e.jsx(fa,{}),surveys:e.jsx(us,{})},i={discussions:e.jsx(hs,{}),groups:e.jsx(hs,{}),sessions:e.jsx(_a,{}),surveys:e.jsx(hs,{})},l=(a==null?void 0:a[2])||"discussions",o=(t==null?void 0:t.nav)||"max";return r("chat")&&n&&e.jsxs("div",{className:"page-chat",children:[e.jsx("div",{className:"back-close nav",style:{display:o=="min"?"none":""},onClick:d=>{d.currentTarget==d.target&&s({...t,nav:"min"}).apply()}}),e.jsxs("div",{className:"chat-nav "+o,children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"nav-size "+o,onClick:d=>{He(.4)(d),s({...t,nav:o=="min"?"max":"min"}).apply()}}),e.jsx("div",{className:"icon discussions-icon "+(l=="discussions"?"active":""),onClick:d=>{He(.4)(d),s({nav:o}).setAbsPath(["chat","discussions"])}}),e.jsx("div",{className:"icon sessions "+(l=="sessions"?"active":""),onClick:d=>{He(.4)(d),s({nav:o}).setAbsPath(["chat","sessions"])}}),e.jsx("div",{className:"icon profile",style:{background:`no-repeat center/cover url(${n.photos[0].startsWith("/")?W:""}${n.photos[0]})`},onClick:()=>{s({nav:o}).setAbsPath(["profile"])}})]}),o=="max"&&e.jsx("div",{className:"nav-ctn",children:c[l]})]}),e.jsx("div",{className:"chat-center",children:i[l]})]})}function Ca(){return e.jsx("div",{className:"page-interface"})}function ka(){const{current:r,setAbsPath:s,qs:a}=ge(),{fetchCategories:t,categories:n,setSelectedCategory:c}=gt(),{store:i}=I();return j.useEffect(()=>{r("categories")&&i&&t()},[i]),r("categories")&&e.jsx("div",{className:"category-list",children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","label","description","catalog_id","index","status","created_at","total_products"],limit:n==null?void 0:n.limit,page:n==null?void 0:n.page,total:n==null?void 0:n.total,filter:{index:kt([0,100]),status:Ct(["PAUSE","TRASH","NEW"],[]),total_products:Ke([0,1e3],[0,1e3])}},items_height:80,id:"category_list",datas:(n==null?void 0:n.list)||[],itemsMapper:{id:{getView(l,o,d,m){return e.jsxs("div",{ref:m,children:["#",o.split("-")[0]]},d.id)}},label:G.StringElement({size_interval:[50,200]}),status:it,total_products:{getView(l,o,d,m){return G.StringElement().getView(l,o||0,d,m)}},catalog_id:{getView(l,o,d,m){return e.jsxs("div",{ref:m,children:["#",o.split("-")[0]]},d.id)}},created_at:G.DateStringElement({size:500})},onItemsSelected:(l,o)=>{o.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="")}),l.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="#00f2")}),c(l[0]),a({category_id:l[0].id}).setAbsPath(["categories","dash_categories"])},onQuery:l=>{t(l)},top_height:40,canAddNew:!0,canPaginate:!0,onNewRequired:()=>{s(["categories","new_category"])}})})})}const St=Je(r=>({catalogs:void 0,selectedCatalog:void 0,catalogProducts:void 0,catalogCategories:void 0,async setCatalogById(s){const a=St.getState().catalogs,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedCatalog:t}));else if(I.getState().store){const c=await St.getState().fetchCatalogs({query:{user_id:s}});r(()=>({selectedCatalog:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await St.getState().fetchCatalogs({query:{user_id:s}});r(()=>({selectedCatalog:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async removeCatalog(s){const a=I.getState().getHeaders();if(!a)return;const n=await(await fetch(`${W}/delete_catalog/${s}`,{method:"DELETE",headers:a.headers})).json();return Te.getState().fetchStoreVar(),n==null?void 0:n.isDeleted},async createCatalog(s){const a=I.getState().getHeaders();if(!a)return;s.index=s.index||0,s.store_id=a.store.id;const t=new FormData,n=[];if(["label","description","store_id","index"].forEach(c=>{if(s[c]!=null)t.append(c,s[c]);else return n.push(c+" is not defined")}),console.log(n,s),n.length==0){const i=await(await fetch(`${W}/create_catalog`,{method:"POST",body:t,headers:a.headers})).json();if(!i||!i.id)return n.push("Server Error, Try Later"),n;r(()=>({selectedCatalog:i})),Te.getState().fetchStoreVar()}else return n},async fetchCatalogCategories(s){if(!(s!=null&&s.catalog_id))return;const a=I.getState().getHeaders();if(a)try{const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.sortBy&&(t.order_by=s.sortBy),t.catalog_id=s.catalog_id,t.all_status=!0,t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_categories/?${n.toString()}`,{headers:a.headers})).json();if(!i||!i.list)return;r(()=>({catalogCategories:i}))}catch(t){return console.warn(t.message)}},async fetchCatalogProducts(s){if(!(s!=null&&s.catalog_id))return;const a=I.getState().getHeaders();if(a)try{const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.sortBy&&(t.order_by=s.sortBy),t.catalog_id=s.catalog_id,t.all_status=!0,t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_products/?${n.toString()}`,{headers:a.headers})).json();if(!i||!i.list)return;r(()=>({catalogProducts:i}))}catch(t){return console.warn(t.message)}},async updateCatalog(s){if(!s.catalog_id)return;const a=I.getState().getHeaders();if(!a)return;let t=!1;const n=new FormData;n.append("catalog_id",s.catalog_id),["label","index","status","description"].forEach(i=>{s[i]&&(n.append(i,s[i]),t=!0)});let c=null;if(t&&(c=await fetch(`${W}/update_catalog`,{method:"PUT",body:n,headers:a.headers})),s.scene_dir){const i=new FormData;i.append("scene_dir",s.scene_dir),i.append("catalog_id",s.catalog_id),c=await fetch(`${W}/update_view_catalog`,{method:"PUT",body:i,headers:a.headers})}c&&(c=await c.json(),r(()=>({catalogProducts:c})))},setSelectedCatalog(s){r(()=>({selectedCatalog:s}))},async fetchCatalogs(s){const a=I.getState().getHeaders();if(a)try{const t={};s!=null&&s.page&&(t.page=Number(s.page)),s!=null&&s.limit&&(t.limit=Number(s.limit)),s!=null&&s.sortBy&&(t.order_by=s.sortBy),s!=null&&s.query.text&&(t.text=s.query.text),t.all_status=!0,t.store_id=a.store.id;const n=new URLSearchParams({});for(const l in t){const o=t[l];n.set(l,o)}const i=await(await fetch(`${W}/get_catalogs/?${n.toString()}`,{headers:a.headers})).json();return!i||!i.list?void 0:(r(()=>({catalogs:i})),i)}catch(t){console.warn(t.message);return}}}));function Ea({onChange:r,catalog_id:s}){const{fetchCatalogs:a,catalogs:t}=St(),[n,c]=j.useState(),[i,l]=j.useState("");return j.useEffect(()=>{a()},[]),j.useEffect(()=>{c(t==null?void 0:t.list.find(o=>o.id==s))},[t]),e.jsxs("div",{className:"choise-catalog",children:[e.jsxs("div",{className:"choise-ctn",onClick:()=>{l(i?"":"open")},children:[e.jsx("div",{className:"back",children:e.jsx("div",{className:"icon"})}),e.jsxs("div",{className:"text",children:[e.jsx("div",{className:"label",children:"Catalog"}),e.jsx("div",{className:"name",children:(n==null?void 0:n.label)||"Select Catalog"})]}),e.jsx("div",{className:"choise-icon",style:{transform:i?"rotate(180deg)":""}})]}),e.jsx("div",{className:"list-catalog "+i,style:{height:i?`${45*((t==null?void 0:t.list.length)||0)}px`:"0px"},children:t==null?void 0:t.list.map(o=>e.jsxs("div",{className:"item "+((n==null?void 0:n.id)==o.id?"selected":""),onClick:()=>{c(o),r==null||r(o.id)},children:[e.jsx("div",{className:"label",children:o.label}),e.jsxs("div",{className:"id",children:["#",o.id.split("-")[0]]})]},o.id))})]})}function Da(){const{current:r,setAbsPath:s,json:a}=ge(),{selectedCategory:t,setSelectedCategory:n,setCategoryById:c,fetchCategoryProducts:i,categoryProducts:l,updateCategory:o,createCategory:d,removeCategory:m}=gt(),[g]=j.useState({}),{setSelectedProduct:p}=at(),[P]=j.useState(!1),M=tt().width<1e3?"wrap":"";j.useEffect(()=>{t&&i({category_id:t.id})},[t]),j.useEffect(()=>{a!=null&&a.category_id&&c(a==null?void 0:a.category_id)},[a]);const y=r("dash_categories"),T=r("new_category"),_=e.jsxs(e.Fragment,{children:[y&&e.jsxs(e.Fragment,{children:[e.jsx(ps,{status:(t==null?void 0:t.status)||"PAUSE",onChange:S=>{y?t&&o({category_id:t.id,status:S}):g.status=S}}),e.jsx("div",{className:"editor-scene-file",children:e.jsx(ts,{file_name:t==null?void 0:t.scene_dir,ext:["zip"],label:"Upload Scene File",onChange:S=>{y?t&&o({category_id:t.id,scene_dir:S}):g.scene_dir=S}})})]}),e.jsx("div",{className:"editor-category",children:e.jsx(Ea,{catalog_id:y&&(t==null?void 0:t.catalog_id),onChange:S=>{y?t&&o({category_id:t.id,catalog_id:S}):g.catalog_id=S}})})]});return(y||T)&&(!t&&y?e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}):e.jsxs("div",{className:"category-dash",ref:Oe,children:[e.jsx(jt,{terme:"white",deteleKey:(t==null?void 0:t.id)||"noga",mode:T?"create":"delete",title:"Category Information",onCreate:()=>{d(g).then(S=>{if(!S)return s(["categories","dash_categories"])})},onDelete:()=>{m(t==null?void 0:t.id).then(S=>{S&&n(void 0)})}}),e.jsxs("section",{className:"editor "+M,children:[e.jsxs("div",{className:"left-side",children:[y&&e.jsx(fe,{isCheckRequired:P,label:"Category Id",value:(t==null?void 0:t.id)||""}),e.jsx("div",{className:"category-title",children:e.jsx(fe,{editable:!0,prompt:"Category Label",isCheckRequired:P,min:3,check:"auto",max:50,label:"Label",placeholder:"Catalog Label",value:y&&((t==null?void 0:t.label)||""),onChange:S=>{y?o({category_id:t==null?void 0:t.id,label:S}):g.label=S}})}),e.jsx("div",{className:"category-description",children:e.jsx(gs,{editable:!0,prompt:"Category Description",isCheckRequired:P,min:3,check:"auto",max:250,label:"Description",placeholder:"Catalog Description",value:y&&((t==null?void 0:t.description)||""),onChange:S=>{y?o({category_id:t==null?void 0:t.id,description:S}):g.description=S}})}),y&&_]}),e.jsxs("div",{className:"right-side",children:[y&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsx(vs,{onClick:()=>{},direction:"horizontal"})]}),T&&_]})]}),y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"btm-list",children:[e.jsx("h1",{className:"",children:"Products That Use This Category"}),e.jsx("h2",{className:"see-all",onClick:()=>{s(["products"])},children:"SEE ALL"})]}),e.jsx(G,{filter:{sortBy:"id",limit:(l==null?void 0:l.limit)||25,page:l==null?void 0:l.page,total:l==null?void 0:l.total},disableFilterBar:!0,items_height:80,id:"product-use-cattegory_list",datas:(l==null?void 0:l.list)||[],itemsMapper:{images:{getView(S,q,v,B){return G.ImageElement().getView(S,`${W}${q[0]}`,v,B)}},id:{getView(S,q,v,B){return e.jsxs("div",{ref:B,children:["#",q.split("-")[0]]},v.id)}},title:G.StringElement({size_interval:[50,200]}),status:G.StringElement({size:150}),stock:G.StringElement(),category_id:{getView(S,q,v,B){return e.jsxs("div",{ref:B,children:["#",q.split("-")[0]]},v.id)}},price:G.StringElement({size:200}),created_at:G.DateStringElement({size:200})},onItemsSelected:S=>{p(S[0]),s(["products","dash_product"])}})]})]}))}function Pa(){const{check:r,setAbsPath:s,current:a}=ge();return r("categories")&&e.jsxs("div",{className:"page-categories",children:[(a("categories")||a("new_category")||a("dash_categories"))&&e.jsx(ss,{active:"categories",setActive:t=>s(t.path)}),e.jsx(ka,{}),e.jsx(Da,{})]})}function Ta(){const{current:r,setAbsPath:s,qs:a}=ge(),{store:t}=I(),{features:n,fetchFeatures:c,setSelectedFeature:i}=Nt();return j.useEffect(()=>{r("features")&&t&&c()},[t]),r("features")&&e.jsx("div",{className:"features-list",children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","collect_type","icon","name","created_at"],limit:n==null?void 0:n.limit,page:n==null?void 0:n.page,total:n==null?void 0:n.total,filter:{}},items_height:80,id:"category_list",datas:(n==null?void 0:n.list)||[],itemsMapper:{id:{getView(l,o,d,m){return e.jsxs("div",{ref:m,children:["#",o.split("-")[0]]},d.id)}},name:G.StringElement({size_interval:[50,200]}),collect_type:G.StringElement({size:150}),icon:{getView(l,o,d,m){let g=null;return d.onResize(l,p=>{g&&(g.style.width=`${Math.min(p.height,p.width)*.9}px`,g.style.height=`${Math.min(p.height,p.width)*.9}px`)}),e.jsx("div",{ref:m,children:e.jsx("div",{className:"image-element",ref:p=>g=p,style:{background:Ye(o[0]||"","40%")}})},l)}},created_at:G.DateStringElement({size:200})},onItemsSelected:(l,o)=>{o.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="")}),l.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="#00f2")}),i(l[0]),a({feature_id:l[0].id}).setAbsPath(["features","dash_features"])},onQuery:l=>{console.log("query",l),c(l)},top_height:40,canAddNew:!0,canPaginate:!0,onNewRequired:()=>{s(["features","new_feature"])}})})})}var $a=function(r){var s={};function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return r[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=r,a.c=s,a.d=function(t,n,c){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:c})},a.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n||4&n&&typeof t=="object"&&t&&t.__esModule)return t;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&n&&typeof t!="string")for(var i in t)a.d(c,i,(function(l){return t[l]}).bind(null,i));return c},a.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="",a(a.s=9)}([function(r,s){r.exports=j},function(r,s,a){var t;/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var n={}.hasOwnProperty;function c(){for(var i=[],l=0;l<arguments.length;l++){var o=arguments[l];if(o){var d=typeof o;if(d==="string"||d==="number")i.push(o);else if(Array.isArray(o)&&o.length){var m=c.apply(null,o);m&&i.push(m)}else if(d==="object")for(var g in o)n.call(o,g)&&o[g]&&i.push(g)}}return i.join(" ")}r.exports?(c.default=c,r.exports=c):(t=(function(){return c}).apply(s,[]))===void 0||(r.exports=t)})()},function(r,s,a){(function(t){var n=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,o=parseInt,d=typeof t=="object"&&t&&t.Object===Object&&t,m=typeof self=="object"&&self&&self.Object===Object&&self,g=d||m||Function("return this")(),p=Object.prototype.toString,P=g.Symbol,C=P?P.prototype:void 0,M=C?C.toString:void 0;function y(q){if(typeof q=="string")return q;if(_(q))return M?M.call(q):"";var v=q+"";return v=="0"&&1/q==-1/0?"-0":v}function T(q){var v=typeof q;return!!q&&(v=="object"||v=="function")}function _(q){return typeof q=="symbol"||function(v){return!!v&&typeof v=="object"}(q)&&p.call(q)=="[object Symbol]"}function S(q){return q?(q=function(v){if(typeof v=="number")return v;if(_(v))return NaN;if(T(v)){var B=typeof v.valueOf=="function"?v.valueOf():v;v=T(B)?B+"":B}if(typeof v!="string")return v===0?v:+v;v=v.replace(n,"");var F=i.test(v);return F||l.test(v)?o(v.slice(2),F?2:8):c.test(v)?NaN:+v}(q))===1/0||q===-1/0?17976931348623157e292*(q<0?-1:1):q==q?q:0:q===0?q:0}r.exports=function(q,v,B){var F,H,V,k;return q=(F=q)==null?"":y(F),H=function($){var z=S($),ce=z%1;return z==z?ce?z-ce:z:0}(B),V=0,k=q.length,H==H&&(k!==void 0&&(H=H<=k?H:k),V!==void 0&&(H=H>=V?H:V)),B=H,v=y(v),q.slice(B,B+v.length)==v}}).call(this,a(3))},function(r,s){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}r.exports=a},function(r,s,a){(function(t){var n=/^\[object .+?Constructor\]$/,c=typeof t=="object"&&t&&t.Object===Object&&t,i=typeof self=="object"&&self&&self.Object===Object&&self,l=c||i||Function("return this")(),o,d=Array.prototype,m=Function.prototype,g=Object.prototype,p=l["__core-js_shared__"],P=(o=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"",C=m.toString,M=g.hasOwnProperty,y=g.toString,T=RegExp("^"+C.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=d.splice,S=$(l,"Map"),q=$(Object,"create");function v(A){var b=-1,E=A?A.length:0;for(this.clear();++b<E;){var J=A[b];this.set(J[0],J[1])}}function B(A){var b=-1,E=A?A.length:0;for(this.clear();++b<E;){var J=A[b];this.set(J[0],J[1])}}function F(A){var b=-1,E=A?A.length:0;for(this.clear();++b<E;){var J=A[b];this.set(J[0],J[1])}}function H(A,b){for(var E,J,pe=A.length;pe--;)if((E=A[pe][0])===(J=b)||E!=E&&J!=J)return pe;return-1}function V(A){return!(!ce(A)||(b=A,P&&P in b))&&(function(E){var J=ce(E)?y.call(E):"";return J=="[object Function]"||J=="[object GeneratorFunction]"}(A)||function(E){var J=!1;if(E!=null&&typeof E.toString!="function")try{J=!!(E+"")}catch{}return J}(A)?T:n).test(function(E){if(E!=null){try{return C.call(E)}catch{}try{return E+""}catch{}}return""}(A));var b}function k(A,b){var E,J,pe=A.__data__;return((J=typeof(E=b))=="string"||J=="number"||J=="symbol"||J=="boolean"?E!=="__proto__":E===null)?pe[typeof b=="string"?"string":"hash"]:pe.map}function $(A,b){var E=function(J,pe){return J==null?void 0:J[pe]}(A,b);return V(E)?E:void 0}function z(A,b){if(typeof A!="function"||b&&typeof b!="function")throw new TypeError("Expected a function");var E=function(){var J=arguments,pe=b?b.apply(this,J):J[0],Ce=E.cache;if(Ce.has(pe))return Ce.get(pe);var K=A.apply(this,J);return E.cache=Ce.set(pe,K),K};return E.cache=new(z.Cache||F),E}function ce(A){var b=typeof A;return!!A&&(b=="object"||b=="function")}v.prototype.clear=function(){this.__data__=q?q(null):{}},v.prototype.delete=function(A){return this.has(A)&&delete this.__data__[A]},v.prototype.get=function(A){var b=this.__data__;if(q){var E=b[A];return E==="__lodash_hash_undefined__"?void 0:E}return M.call(b,A)?b[A]:void 0},v.prototype.has=function(A){var b=this.__data__;return q?b[A]!==void 0:M.call(b,A)},v.prototype.set=function(A,b){return this.__data__[A]=q&&b===void 0?"__lodash_hash_undefined__":b,this},B.prototype.clear=function(){this.__data__=[]},B.prototype.delete=function(A){var b=this.__data__,E=H(b,A);return!(E<0)&&(E==b.length-1?b.pop():_.call(b,E,1),!0)},B.prototype.get=function(A){var b=this.__data__,E=H(b,A);return E<0?void 0:b[E][1]},B.prototype.has=function(A){return H(this.__data__,A)>-1},B.prototype.set=function(A,b){var E=this.__data__,J=H(E,A);return J<0?E.push([A,b]):E[J][1]=b,this},F.prototype.clear=function(){this.__data__={hash:new v,map:new(S||B),string:new v}},F.prototype.delete=function(A){return k(this,A).delete(A)},F.prototype.get=function(A){return k(this,A).get(A)},F.prototype.has=function(A){return k(this,A).has(A)},F.prototype.set=function(A,b){return k(this,A).set(A,b),this},z.Cache=F,r.exports=z}).call(this,a(3))},function(r,s,a){(function(t){var n=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,o=parseInt,d=typeof t=="object"&&t&&t.Object===Object&&t,m=typeof self=="object"&&self&&self.Object===Object&&self,g=d||m||Function("return this")(),p=Object.prototype.toString,P=Math.max,C=Math.min,M=function(){return g.Date.now()};function y(_){var S=typeof _;return!!_&&(S=="object"||S=="function")}function T(_){if(typeof _=="number")return _;if(function(v){return typeof v=="symbol"||function(B){return!!B&&typeof B=="object"}(v)&&p.call(v)=="[object Symbol]"}(_))return NaN;if(y(_)){var S=typeof _.valueOf=="function"?_.valueOf():_;_=y(S)?S+"":S}if(typeof _!="string")return _===0?_:+_;_=_.replace(n,"");var q=i.test(_);return q||l.test(_)?o(_.slice(2),q?2:8):c.test(_)?NaN:+_}r.exports=function(_,S,q){var v,B,F,H,V,k,$=0,z=!1,ce=!1,A=!0;if(typeof _!="function")throw new TypeError("Expected a function");function b(L){var N=v,U=B;return v=B=void 0,$=L,H=_.apply(U,N)}function E(L){return $=L,V=setTimeout(pe,S),z?b(L):H}function J(L){var N=L-k;return k===void 0||N>=S||N<0||ce&&L-$>=F}function pe(){var L=M();if(J(L))return Ce(L);V=setTimeout(pe,function(N){var U=S-(N-k);return ce?C(U,F-(N-$)):U}(L))}function Ce(L){return V=void 0,A&&v?b(L):(v=B=void 0,H)}function K(){var L=M(),N=J(L);if(v=arguments,B=this,k=L,N){if(V===void 0)return E(k);if(ce)return V=setTimeout(pe,S),b(k)}return V===void 0&&(V=setTimeout(pe,S)),H}return S=T(S)||0,y(q)&&(z=!!q.leading,F=(ce="maxWait"in q)?P(T(q.maxWait)||0,S):F,A="trailing"in q?!!q.trailing:A),K.cancel=function(){V!==void 0&&clearTimeout(V),$=0,v=k=B=V=void 0},K.flush=function(){return V===void 0?H:Ce(M())},K}}).call(this,a(3))},function(r,s,a){(function(t,n){var c="[object Arguments]",i="[object Map]",l="[object Object]",o="[object Set]",d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/,g=/^\./,p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,P=/\\(\\)?/g,C=/^\[object .+?Constructor\]$/,M=/^(?:0|[1-9]\d*)$/,y={};y["[object Float32Array]"]=y["[object Float64Array]"]=y["[object Int8Array]"]=y["[object Int16Array]"]=y["[object Int32Array]"]=y["[object Uint8Array]"]=y["[object Uint8ClampedArray]"]=y["[object Uint16Array]"]=y["[object Uint32Array]"]=!0,y[c]=y["[object Array]"]=y["[object ArrayBuffer]"]=y["[object Boolean]"]=y["[object DataView]"]=y["[object Date]"]=y["[object Error]"]=y["[object Function]"]=y[i]=y["[object Number]"]=y[l]=y["[object RegExp]"]=y[o]=y["[object String]"]=y["[object WeakMap]"]=!1;var T=typeof t=="object"&&t&&t.Object===Object&&t,_=typeof self=="object"&&self&&self.Object===Object&&self,S=T||_||Function("return this")(),q=s&&!s.nodeType&&s,v=q&&typeof n=="object"&&n&&!n.nodeType&&n,B=v&&v.exports===q&&T.process,F=function(){try{return B&&B.binding("util")}catch{}}(),H=F&&F.isTypedArray;function V(u,f,w,R){var ee=-1,te=u?u.length:0;for(R&&te&&(w=u[++ee]);++ee<te;)w=f(w,u[ee],ee,u);return w}function k(u,f){for(var w=-1,R=u?u.length:0;++w<R;)if(f(u[w],w,u))return!0;return!1}function $(u,f,w,R,ee){return ee(u,function(te,oe,Ne){w=R?(R=!1,te):f(w,te,oe,Ne)}),w}function z(u){var f=!1;if(u!=null&&typeof u.toString!="function")try{f=!!(u+"")}catch{}return f}function ce(u){var f=-1,w=Array(u.size);return u.forEach(function(R,ee){w[++f]=[ee,R]}),w}function A(u){var f=-1,w=Array(u.size);return u.forEach(function(R){w[++f]=R}),w}var b,E,J,pe=Array.prototype,Ce=Function.prototype,K=Object.prototype,L=S["__core-js_shared__"],N=(b=/[^.]+$/.exec(L&&L.keys&&L.keys.IE_PROTO||""))?"Symbol(src)_1."+b:"",U=Ce.toString,O=K.hasOwnProperty,h=K.toString,ne=RegExp("^"+U.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ue=S.Symbol,he=S.Uint8Array,le=K.propertyIsEnumerable,je=pe.splice,be=(E=Object.keys,J=Object,function(u){return E(J(u))}),we=_t(S,"DataView"),$e=_t(S,"Map"),De=_t(S,"Promise"),x=_t(S,"Set"),D=_t(S,"WeakMap"),Z=_t(Object,"create"),ie=mt(we),ae=mt($e),re=mt(De),de=mt(x),ye=mt(D),Q=ue?ue.prototype:void 0,se=Q?Q.valueOf:void 0,me=Q?Q.toString:void 0;function X(u){var f=-1,w=u?u.length:0;for(this.clear();++f<w;){var R=u[f];this.set(R[0],R[1])}}function Y(u){var f=-1,w=u?u.length:0;for(this.clear();++f<w;){var R=u[f];this.set(R[0],R[1])}}function ke(u){var f=-1,w=u?u.length:0;for(this.clear();++f<w;){var R=u[f];this.set(R[0],R[1])}}function Me(u){var f=-1,w=u?u.length:0;for(this.__data__=new ke;++f<w;)this.add(u[f])}function Re(u){this.__data__=new Y(u)}function qe(u,f){var w=ot(u)||Ss(u)?function(oe,Ne){for(var Ee=-1,xe=Array(oe);++Ee<oe;)xe[Ee]=Ne(Ee);return xe}(u.length,String):[],R=w.length,ee=!!R;for(var te in u)!f&&!O.call(u,te)||ee&&(te=="length"||ys(te,R))||w.push(te);return w}function Ze(u,f){for(var w=u.length;w--;)if(Ns(u[w][0],f))return w;return-1}X.prototype.clear=function(){this.__data__=Z?Z(null):{}},X.prototype.delete=function(u){return this.has(u)&&delete this.__data__[u]},X.prototype.get=function(u){var f=this.__data__;if(Z){var w=f[u];return w==="__lodash_hash_undefined__"?void 0:w}return O.call(f,u)?f[u]:void 0},X.prototype.has=function(u){var f=this.__data__;return Z?f[u]!==void 0:O.call(f,u)},X.prototype.set=function(u,f){return this.__data__[u]=Z&&f===void 0?"__lodash_hash_undefined__":f,this},Y.prototype.clear=function(){this.__data__=[]},Y.prototype.delete=function(u){var f=this.__data__,w=Ze(f,u);return!(w<0)&&(w==f.length-1?f.pop():je.call(f,w,1),!0)},Y.prototype.get=function(u){var f=this.__data__,w=Ze(f,u);return w<0?void 0:f[w][1]},Y.prototype.has=function(u){return Ze(this.__data__,u)>-1},Y.prototype.set=function(u,f){var w=this.__data__,R=Ze(w,u);return R<0?w.push([u,f]):w[R][1]=f,this},ke.prototype.clear=function(){this.__data__={hash:new X,map:new($e||Y),string:new X}},ke.prototype.delete=function(u){return Mt(this,u).delete(u)},ke.prototype.get=function(u){return Mt(this,u).get(u)},ke.prototype.has=function(u){return Mt(this,u).has(u)},ke.prototype.set=function(u,f){return Mt(this,u).set(u,f),this},Me.prototype.add=Me.prototype.push=function(u){return this.__data__.set(u,"__lodash_hash_undefined__"),this},Me.prototype.has=function(u){return this.__data__.has(u)},Re.prototype.clear=function(){this.__data__=new Y},Re.prototype.delete=function(u){return this.__data__.delete(u)},Re.prototype.get=function(u){return this.__data__.get(u)},Re.prototype.has=function(u){return this.__data__.has(u)},Re.prototype.set=function(u,f){var w=this.__data__;if(w instanceof Y){var R=w.__data__;if(!$e||R.length<199)return R.push([u,f]),this;w=this.__data__=new ke(R)}return w.set(u,f),this};var ht,Ae=(ht=function(u,f){return u&&yt(u,f,Vt)},function(u,f){if(u==null)return u;if(!is(u))return ht(u,f);for(var w=u.length,R=-1,ee=Object(u);++R<w&&f(ee[R],R,ee)!==!1;);return u}),yt=function(u){return function(f,w,R){for(var ee=-1,te=Object(f),oe=R(f),Ne=oe.length;Ne--;){var Ee=oe[u?Ne:++ee];if(w(te[Ee],Ee,te)===!1)break}return f}}();function Et(u,f){for(var w=0,R=(f=Lt(f,u)?[f]:xs(f)).length;u!=null&&w<R;)u=u[zt(f[w++])];return w&&w==R?u:void 0}function as(u,f){return u!=null&&f in Object(u)}function Dt(u,f,w,R,ee){return u===f||(u==null||f==null||!Bt(u)&&!qt(f)?u!=u&&f!=f:function(te,oe,Ne,Ee,xe,ve){var Ve=ot(te),Ue=ot(oe),Pe="[object Array]",Ie="[object Array]";Ve||(Pe=(Pe=rt(te))==c?l:Pe),Ue||(Ie=(Ie=rt(oe))==c?l:Ie);var Le=Pe==l&&!z(te),pt=Ie==l&&!z(oe),ct=Pe==Ie;if(ct&&!Le)return ve||(ve=new Re),Ve||qs(te)?js(te,oe,Ne,Ee,xe,ve):function(Se,_e,cs,ft,Ut,ze,st){switch(cs){case"[object DataView]":if(Se.byteLength!=_e.byteLength||Se.byteOffset!=_e.byteOffset)return!1;Se=Se.buffer,_e=_e.buffer;case"[object ArrayBuffer]":return!(Se.byteLength!=_e.byteLength||!ft(new he(Se),new he(_e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ns(+Se,+_e);case"[object Error]":return Se.name==_e.name&&Se.message==_e.message;case"[object RegExp]":case"[object String]":return Se==_e+"";case i:var lt=ce;case o:var $t=2&ze;if(lt||(lt=A),Se.size!=_e.size&&!$t)return!1;var Ht=st.get(Se);if(Ht)return Ht==_e;ze|=1,st.set(Se,_e);var bt=js(lt(Se),lt(_e),ft,Ut,ze,st);return st.delete(Se),bt;case"[object Symbol]":if(se)return se.call(Se)==se.call(_e)}return!1}(te,oe,Pe,Ne,Ee,xe,ve);if(!(2&xe)){var Tt=Le&&O.call(te,"__wrapped__"),Cs=pt&&O.call(oe,"__wrapped__");if(Tt||Cs){var Us=Tt?te.value():te,Hs=Cs?oe.value():oe;return ve||(ve=new Re),Ne(Us,Hs,Ee,xe,ve)}}return ct?(ve||(ve=new Re),function(Se,_e,cs,ft,Ut,ze){var st=2&Ut,lt=Vt(Se),$t=lt.length,Ht=Vt(_e).length;if($t!=Ht&&!st)return!1;for(var bt=$t;bt--;){var dt=lt[bt];if(!(st?dt in _e:O.call(_e,dt)))return!1}var ks=ze.get(Se);if(ks&&ze.get(_e))return ks==_e;var Wt=!0;ze.set(Se,_e),ze.set(_e,Se);for(var ls=st;++bt<$t;){dt=lt[bt];var Gt=Se[dt],Kt=_e[dt];if(ft)var Es=st?ft(Kt,Gt,dt,_e,Se,ze):ft(Gt,Kt,dt,Se,_e,ze);if(!(Es===void 0?Gt===Kt||cs(Gt,Kt,ft,Ut,ze):Es)){Wt=!1;break}ls||(ls=dt=="constructor")}if(Wt&&!ls){var Jt=Se.constructor,Zt=_e.constructor;Jt==Zt||!("constructor"in Se)||!("constructor"in _e)||typeof Jt=="function"&&Jt instanceof Jt&&typeof Zt=="function"&&Zt instanceof Zt||(Wt=!1)}return ze.delete(Se),ze.delete(_e),Wt}(te,oe,Ne,Ee,xe,ve)):!1}(u,f,Dt,w,R,ee))}function Pt(u){return!(!Bt(u)||function(f){return!!N&&N in f}(u))&&(ws(u)||z(u)?ne:C).test(mt(u))}function Ls(u){return typeof u=="function"?u:u==null?Vs:typeof u=="object"?ot(u)?function(R,ee){return Lt(R)&&_s(ee)?bs(zt(R),ee):function(te){var oe=function(Ne,Ee,xe){var ve=Ne==null?void 0:Et(Ne,Ee);return ve===void 0?xe:ve}(te,R);return oe===void 0&&oe===ee?function(Ne,Ee){return Ne!=null&&function(xe,ve,Ve){ve=Lt(ve,xe)?[ve]:xs(ve);for(var Ue,Pe=-1,Ie=ve.length;++Pe<Ie;){var Le=zt(ve[Pe]);if(!(Ue=xe!=null&&Ve(xe,Le)))break;xe=xe[Le]}return Ue||!!(Ie=xe?xe.length:0)&&rs(Ie)&&ys(Le,Ie)&&(ot(xe)||Ss(xe))}(Ne,Ee,as)}(te,R):Dt(ee,oe,void 0,3)}}(u[0],u[1]):function(R){var ee=function(te){for(var oe=Vt(te),Ne=oe.length;Ne--;){var Ee=oe[Ne],xe=te[Ee];oe[Ne]=[Ee,xe,_s(xe)]}return oe}(R);return ee.length==1&&ee[0][2]?bs(ee[0][0],ee[0][1]):function(te){return te===R||function(oe,Ne,Ee,xe){var ve=Ee.length,Ve=ve,Ue=!xe;if(oe==null)return!Ve;for(oe=Object(oe);ve--;){var Pe=Ee[ve];if(Ue&&Pe[2]?Pe[1]!==oe[Pe[0]]:!(Pe[0]in oe))return!1}for(;++ve<Ve;){var Ie=(Pe=Ee[ve])[0],Le=oe[Ie],pt=Pe[1];if(Ue&&Pe[2]){if(Le===void 0&&!(Ie in oe))return!1}else{var ct=new Re;if(xe)var Tt=xe(Le,pt,Ie,oe,Ne,ct);if(!(Tt===void 0?Dt(pt,Le,xe,3,ct):Tt))return!1}}return!0}(te,R,ee)}}(u):Lt(f=u)?(w=zt(f),function(R){return R==null?void 0:R[w]}):function(R){return function(ee){return Et(ee,R)}}(f);var f,w}function zs(u){if(w=(f=u)&&f.constructor,R=typeof w=="function"&&w.prototype||K,f!==R)return be(u);var f,w,R,ee=[];for(var te in Object(u))O.call(u,te)&&te!="constructor"&&ee.push(te);return ee}function xs(u){return ot(u)?u:Bs(u)}function js(u,f,w,R,ee,te){var oe=2&ee,Ne=u.length,Ee=f.length;if(Ne!=Ee&&!(oe&&Ee>Ne))return!1;var xe=te.get(u);if(xe&&te.get(f))return xe==f;var ve=-1,Ve=!0,Ue=1&ee?new Me:void 0;for(te.set(u,f),te.set(f,u);++ve<Ne;){var Pe=u[ve],Ie=f[ve];if(R)var Le=oe?R(Ie,Pe,ve,f,u,te):R(Pe,Ie,ve,u,f,te);if(Le!==void 0){if(Le)continue;Ve=!1;break}if(Ue){if(!k(f,function(pt,ct){if(!Ue.has(ct)&&(Pe===pt||w(Pe,pt,R,ee,te)))return Ue.add(ct)})){Ve=!1;break}}else if(Pe!==Ie&&!w(Pe,Ie,R,ee,te)){Ve=!1;break}}return te.delete(u),te.delete(f),Ve}function Mt(u,f){var w,R,ee=u.__data__;return((R=typeof(w=f))=="string"||R=="number"||R=="symbol"||R=="boolean"?w!=="__proto__":w===null)?ee[typeof f=="string"?"string":"hash"]:ee.map}function _t(u,f){var w=function(R,ee){return R==null?void 0:R[ee]}(u,f);return Pt(w)?w:void 0}var rt=function(u){return h.call(u)};function ys(u,f){return!!(f=f??9007199254740991)&&(typeof u=="number"||M.test(u))&&u>-1&&u%1==0&&u<f}function Lt(u,f){if(ot(u))return!1;var w=typeof u;return!(w!="number"&&w!="symbol"&&w!="boolean"&&u!=null&&!os(u))||m.test(u)||!d.test(u)||f!=null&&u in Object(f)}function _s(u){return u==u&&!Bt(u)}function bs(u,f){return function(w){return w!=null&&w[u]===f&&(f!==void 0||u in Object(w))}}(we&&rt(new we(new ArrayBuffer(1)))!="[object DataView]"||$e&&rt(new $e)!=i||De&&rt(De.resolve())!="[object Promise]"||x&&rt(new x)!=o||D&&rt(new D)!="[object WeakMap]")&&(rt=function(u){var f=h.call(u),w=f==l?u.constructor:void 0,R=w?mt(w):void 0;if(R)switch(R){case ie:return"[object DataView]";case ae:return i;case re:return"[object Promise]";case de:return o;case ye:return"[object WeakMap]"}return f});var Bs=ns(function(u){var f;u=(f=u)==null?"":function(R){if(typeof R=="string")return R;if(os(R))return me?me.call(R):"";var ee=R+"";return ee=="0"&&1/R==-1/0?"-0":ee}(f);var w=[];return g.test(u)&&w.push(""),u.replace(p,function(R,ee,te,oe){w.push(te?oe.replace(P,"$1"):ee||R)}),w});function zt(u){if(typeof u=="string"||os(u))return u;var f=u+"";return f=="0"&&1/u==-1/0?"-0":f}function mt(u){if(u!=null){try{return U.call(u)}catch{}try{return u+""}catch{}}return""}function ns(u,f){if(typeof u!="function"||f&&typeof f!="function")throw new TypeError("Expected a function");var w=function(){var R=arguments,ee=f?f.apply(this,R):R[0],te=w.cache;if(te.has(ee))return te.get(ee);var oe=u.apply(this,R);return w.cache=te.set(ee,oe),oe};return w.cache=new(ns.Cache||ke),w}function Ns(u,f){return u===f||u!=u&&f!=f}function Ss(u){return function(f){return qt(f)&&is(f)}(u)&&O.call(u,"callee")&&(!le.call(u,"callee")||h.call(u)==c)}ns.Cache=ke;var ot=Array.isArray;function is(u){return u!=null&&rs(u.length)&&!ws(u)}function ws(u){var f=Bt(u)?h.call(u):"";return f=="[object Function]"||f=="[object GeneratorFunction]"}function rs(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=9007199254740991}function Bt(u){var f=typeof u;return!!u&&(f=="object"||f=="function")}function qt(u){return!!u&&typeof u=="object"}function os(u){return typeof u=="symbol"||qt(u)&&h.call(u)=="[object Symbol]"}var qs=H?function(u){return function(f){return u(f)}}(H):function(u){return qt(u)&&rs(u.length)&&!!y[h.call(u)]};function Vt(u){return is(u)?qe(u):zs(u)}function Vs(u){return u}n.exports=function(u,f,w){var R=ot(u)?V:$,ee=arguments.length<3;return R(u,Ls(f),w,ee,Ae)}}).call(this,a(3),a(7)(r))},function(r,s){r.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children||(a.children=[]),Object.defineProperty(a,"loaded",{enumerable:!0,get:function(){return a.l}}),Object.defineProperty(a,"id",{enumerable:!0,get:function(){return a.i}}),a.webpackPolyfill=1),a}},function(r,s){String.prototype.padEnd||(String.prototype.padEnd=function(a,t){return a>>=0,t=String(t!==void 0?t:" "),this.length>a?String(this):((a-=this.length)>t.length&&(t+=t.repeat(a/t.length)),String(this)+t.slice(0,a))})},function(r,s,a){function t(K,L,N){return L in K?Object.defineProperty(K,L,{value:N,enumerable:!0,configurable:!0,writable:!0}):K[L]=N,K}function n(K){if(Symbol.iterator in Object(K)||Object.prototype.toString.call(K)==="[object Arguments]")return Array.from(K)}function c(K){return function(L){if(Array.isArray(L)){for(var N=0,U=new Array(L.length);N<L.length;N++)U[N]=L[N];return U}}(K)||n(K)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(K){if(Array.isArray(K))return K}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(K,L){if(!(K instanceof L))throw new TypeError("Cannot call a class as a function")}function d(K,L){for(var N=0;N<L.length;N++){var U=L[N];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(K,U.key,U)}}function m(K){return(m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L})(K)}function g(K){return(g=typeof Symbol=="function"&&m(Symbol.iterator)==="symbol"?function(L){return m(L)}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":m(L)})(K)}function p(K){if(K===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K}function P(K){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(L){return L.__proto__||Object.getPrototypeOf(L)})(K)}function C(K,L){return(C=Object.setPrototypeOf||function(N,U){return N.__proto__=U,N})(K,L)}a.r(s);var M=a(0),y=a.n(M),T=a(5),_=a.n(T),S=a(4),q=a.n(S),v=a(6),B=a.n(v),F=a(2),H=a.n(F),V=a(1),k=a.n(V);a(8);function $(K,L){return i(K)||function(N,U){var O=[],h=!0,ne=!1,ue=void 0;try{for(var he,le=N[Symbol.iterator]();!(h=(he=le.next()).done)&&(O.push(he.value),!U||O.length!==U);h=!0);}catch(je){ne=!0,ue=je}finally{try{h||le.return==null||le.return()}finally{if(ne)throw ue}}return O}(K,L)||l()}var z=[["Afghanistan",["asia"],"af","93"],["Albania",["europe"],"al","355"],["Algeria",["africa","north-africa"],"dz","213"],["Andorra",["europe"],"ad","376"],["Angola",["africa"],"ao","244"],["Antigua and Barbuda",["america","carribean"],"ag","1268"],["Argentina",["america","south-america"],"ar","54","(..) ........",0,["11","221","223","261","264","2652","280","2905","291","2920","2966","299","341","342","343","351","376","379","381","3833","385","387","388"]],["Armenia",["asia","ex-ussr"],"am","374",".. ......"],["Aruba",["america","carribean"],"aw","297"],["Australia",["oceania"],"au","61","(..) .... ....",0,["2","3","4","7","8","02","03","04","07","08"]],["Austria",["europe","eu-union"],"at","43"],["Azerbaijan",["asia","ex-ussr"],"az","994","(..) ... .. .."],["Bahamas",["america","carribean"],"bs","1242"],["Bahrain",["middle-east"],"bh","973"],["Bangladesh",["asia"],"bd","880"],["Barbados",["america","carribean"],"bb","1246"],["Belarus",["europe","ex-ussr"],"by","375","(..) ... .. .."],["Belgium",["europe","eu-union"],"be","32","... .. .. .."],["Belize",["america","central-america"],"bz","501"],["Benin",["africa"],"bj","229"],["Bhutan",["asia"],"bt","975"],["Bolivia",["america","south-america"],"bo","591"],["Bosnia and Herzegovina",["europe","ex-yugos"],"ba","387"],["Botswana",["africa"],"bw","267"],["Brazil",["america","south-america"],"br","55","(..) ........."],["British Indian Ocean Territory",["asia"],"io","246"],["Brunei",["asia"],"bn","673"],["Bulgaria",["europe","eu-union"],"bg","359"],["Burkina Faso",["africa"],"bf","226"],["Burundi",["africa"],"bi","257"],["Cambodia",["asia"],"kh","855"],["Cameroon",["africa"],"cm","237"],["Canada",["america","north-america"],"ca","1","(...) ...-....",1,["204","226","236","249","250","289","306","343","365","387","403","416","418","431","437","438","450","506","514","519","548","579","581","587","604","613","639","647","672","705","709","742","778","780","782","807","819","825","867","873","902","905"]],["Cape Verde",["africa"],"cv","238"],["Caribbean Netherlands",["america","carribean"],"bq","599","",1],["Central African Republic",["africa"],"cf","236"],["Chad",["africa"],"td","235"],["Chile",["america","south-america"],"cl","56"],["China",["asia"],"cn","86","..-........."],["Colombia",["america","south-america"],"co","57","... ... ...."],["Comoros",["africa"],"km","269"],["Congo",["africa"],"cd","243"],["Congo",["africa"],"cg","242"],["Costa Rica",["america","central-america"],"cr","506","....-...."],["Côte d’Ivoire",["africa"],"ci","225",".. .. .. .."],["Croatia",["europe","eu-union","ex-yugos"],"hr","385"],["Cuba",["america","carribean"],"cu","53"],["Curaçao",["america","carribean"],"cw","599","",0],["Cyprus",["europe","eu-union"],"cy","357",".. ......"],["Czech Republic",["europe","eu-union"],"cz","420","... ... ..."],["Denmark",["europe","eu-union","baltic"],"dk","45",".. .. .. .."],["Djibouti",["africa"],"dj","253"],["Dominica",["america","carribean"],"dm","1767"],["Dominican Republic",["america","carribean"],"do","1","",2,["809","829","849"]],["Ecuador",["america","south-america"],"ec","593"],["Egypt",["africa","north-africa"],"eg","20"],["El Salvador",["america","central-america"],"sv","503","....-...."],["Equatorial Guinea",["africa"],"gq","240"],["Eritrea",["africa"],"er","291"],["Estonia",["europe","eu-union","ex-ussr","baltic"],"ee","372",".... ......"],["Ethiopia",["africa"],"et","251"],["Fiji",["oceania"],"fj","679"],["Finland",["europe","eu-union","baltic"],"fi","358",".. ... .. .."],["France",["europe","eu-union"],"fr","33",". .. .. .. .."],["French Guiana",["america","south-america"],"gf","594"],["French Polynesia",["oceania"],"pf","689"],["Gabon",["africa"],"ga","241"],["Gambia",["africa"],"gm","220"],["Georgia",["asia","ex-ussr"],"ge","995"],["Germany",["europe","eu-union","baltic"],"de","49",".... ........"],["Ghana",["africa"],"gh","233"],["Greece",["europe","eu-union"],"gr","30"],["Grenada",["america","carribean"],"gd","1473"],["Guadeloupe",["america","carribean"],"gp","590","",0],["Guam",["oceania"],"gu","1671"],["Guatemala",["america","central-america"],"gt","502","....-...."],["Guinea",["africa"],"gn","224"],["Guinea-Bissau",["africa"],"gw","245"],["Guyana",["america","south-america"],"gy","592"],["Haiti",["america","carribean"],"ht","509","....-...."],["Honduras",["america","central-america"],"hn","504"],["Hong Kong",["asia"],"hk","852",".... ...."],["Hungary",["europe","eu-union"],"hu","36"],["Iceland",["europe"],"is","354","... ...."],["India",["asia"],"in","91",".....-....."],["Indonesia",["asia"],"id","62"],["Iran",["middle-east"],"ir","98","... ... ...."],["Iraq",["middle-east"],"iq","964"],["Ireland",["europe","eu-union"],"ie","353",".. ......."],["Israel",["middle-east"],"il","972","... ... ...."],["Italy",["europe","eu-union"],"it","39","... .......",0],["Jamaica",["america","carribean"],"jm","1876"],["Japan",["asia"],"jp","81",".. .... ...."],["Jordan",["middle-east"],"jo","962"],["Kazakhstan",["asia","ex-ussr"],"kz","7","... ...-..-..",1,["310","311","312","313","315","318","321","324","325","326","327","336","7172","73622"]],["Kenya",["africa"],"ke","254"],["Kiribati",["oceania"],"ki","686"],["Kosovo",["europe","ex-yugos"],"xk","383"],["Kuwait",["middle-east"],"kw","965"],["Kyrgyzstan",["asia","ex-ussr"],"kg","996","... ... ..."],["Laos",["asia"],"la","856"],["Latvia",["europe","eu-union","ex-ussr","baltic"],"lv","371",".. ... ..."],["Lebanon",["middle-east"],"lb","961"],["Lesotho",["africa"],"ls","266"],["Liberia",["africa"],"lr","231"],["Libya",["africa","north-africa"],"ly","218"],["Liechtenstein",["europe"],"li","423"],["Lithuania",["europe","eu-union","ex-ussr","baltic"],"lt","370"],["Luxembourg",["europe","eu-union"],"lu","352"],["Macau",["asia"],"mo","853"],["Macedonia",["europe","ex-yugos"],"mk","389"],["Madagascar",["africa"],"mg","261"],["Malawi",["africa"],"mw","265"],["Malaysia",["asia"],"my","60","..-....-...."],["Maldives",["asia"],"mv","960"],["Mali",["africa"],"ml","223"],["Malta",["europe","eu-union"],"mt","356"],["Marshall Islands",["oceania"],"mh","692"],["Martinique",["america","carribean"],"mq","596"],["Mauritania",["africa"],"mr","222"],["Mauritius",["africa"],"mu","230"],["Mexico",["america","central-america"],"mx","52","... ... ....",0,["55","81","33","656","664","998","774","229"]],["Micronesia",["oceania"],"fm","691"],["Moldova",["europe"],"md","373","(..) ..-..-.."],["Monaco",["europe"],"mc","377"],["Mongolia",["asia"],"mn","976"],["Montenegro",["europe","ex-yugos"],"me","382"],["Morocco",["africa","north-africa"],"ma","212"],["Mozambique",["africa"],"mz","258"],["Myanmar",["asia"],"mm","95"],["Namibia",["africa"],"na","264"],["Nauru",["africa"],"nr","674"],["Nepal",["asia"],"np","977"],["Netherlands",["europe","eu-union"],"nl","31",".. ........"],["New Caledonia",["oceania"],"nc","687"],["New Zealand",["oceania"],"nz","64","...-...-...."],["Nicaragua",["america","central-america"],"ni","505"],["Niger",["africa"],"ne","227"],["Nigeria",["africa"],"ng","234"],["North Korea",["asia"],"kp","850"],["Norway",["europe","baltic"],"no","47","... .. ..."],["Oman",["middle-east"],"om","968"],["Pakistan",["asia"],"pk","92","...-......."],["Palau",["oceania"],"pw","680"],["Palestine",["middle-east"],"ps","970"],["Panama",["america","central-america"],"pa","507"],["Papua New Guinea",["oceania"],"pg","675"],["Paraguay",["america","south-america"],"py","595"],["Peru",["america","south-america"],"pe","51"],["Philippines",["asia"],"ph","63",".... ......."],["Poland",["europe","eu-union","baltic"],"pl","48","...-...-..."],["Portugal",["europe","eu-union"],"pt","351"],["Puerto Rico",["america","carribean"],"pr","1","",3,["787","939"]],["Qatar",["middle-east"],"qa","974"],["Réunion",["africa"],"re","262"],["Romania",["europe","eu-union"],"ro","40"],["Russia",["europe","asia","ex-ussr","baltic"],"ru","7","(...) ...-..-..",0],["Rwanda",["africa"],"rw","250"],["Saint Kitts and Nevis",["america","carribean"],"kn","1869"],["Saint Lucia",["america","carribean"],"lc","1758"],["Saint Vincent and the Grenadines",["america","carribean"],"vc","1784"],["Samoa",["oceania"],"ws","685"],["San Marino",["europe"],"sm","378"],["São Tomé and Príncipe",["africa"],"st","239"],["Saudi Arabia",["middle-east"],"sa","966"],["Senegal",["africa"],"sn","221"],["Serbia",["europe","ex-yugos"],"rs","381"],["Seychelles",["africa"],"sc","248"],["Sierra Leone",["africa"],"sl","232"],["Singapore",["asia"],"sg","65","....-...."],["Slovakia",["europe","eu-union"],"sk","421"],["Slovenia",["europe","eu-union","ex-yugos"],"si","386"],["Solomon Islands",["oceania"],"sb","677"],["Somalia",["africa"],"so","252"],["South Africa",["africa"],"za","27"],["South Korea",["asia"],"kr","82","... .... ...."],["South Sudan",["africa","north-africa"],"ss","211"],["Spain",["europe","eu-union"],"es","34","... ... ..."],["Sri Lanka",["asia"],"lk","94"],["Sudan",["africa"],"sd","249"],["Suriname",["america","south-america"],"sr","597"],["Swaziland",["africa"],"sz","268"],["Sweden",["europe","eu-union","baltic"],"se","46","(...) ...-..."],["Switzerland",["europe"],"ch","41",".. ... .. .."],["Syria",["middle-east"],"sy","963"],["Taiwan",["asia"],"tw","886"],["Tajikistan",["asia","ex-ussr"],"tj","992"],["Tanzania",["africa"],"tz","255"],["Thailand",["asia"],"th","66"],["Timor-Leste",["asia"],"tl","670"],["Togo",["africa"],"tg","228"],["Tonga",["oceania"],"to","676"],["Trinidad and Tobago",["america","carribean"],"tt","1868"],["Tunisia",["africa","north-africa"],"tn","216"],["Turkey",["europe"],"tr","90","... ... .. .."],["Turkmenistan",["asia","ex-ussr"],"tm","993"],["Tuvalu",["asia"],"tv","688"],["Uganda",["africa"],"ug","256"],["Ukraine",["europe","ex-ussr"],"ua","380","(..) ... .. .."],["United Arab Emirates",["middle-east"],"ae","971"],["United Kingdom",["europe","eu-union"],"gb","44",".... ......"],["United States",["america","north-america"],"us","1","(...) ...-....",0,["907","205","251","256","334","479","501","870","480","520","602","623","928","209","213","310","323","408","415","510","530","559","562","619","626","650","661","707","714","760","805","818","831","858","909","916","925","949","951","303","719","970","203","860","202","302","239","305","321","352","386","407","561","727","772","813","850","863","904","941","954","229","404","478","706","770","912","808","319","515","563","641","712","208","217","309","312","618","630","708","773","815","847","219","260","317","574","765","812","316","620","785","913","270","502","606","859","225","318","337","504","985","413","508","617","781","978","301","410","207","231","248","269","313","517","586","616","734","810","906","989","218","320","507","612","651","763","952","314","417","573","636","660","816","228","601","662","406","252","336","704","828","910","919","701","308","402","603","201","609","732","856","908","973","505","575","702","775","212","315","516","518","585","607","631","716","718","845","914","216","330","419","440","513","614","740","937","405","580","918","503","541","215","412","570","610","717","724","814","401","803","843","864","605","423","615","731","865","901","931","210","214","254","281","325","361","409","432","512","713","806","817","830","903","915","936","940","956","972","979","435","801","276","434","540","703","757","804","802","206","253","360","425","509","262","414","608","715","920","304","307"]],["Uruguay",["america","south-america"],"uy","598"],["Uzbekistan",["asia","ex-ussr"],"uz","998",".. ... .. .."],["Vanuatu",["oceania"],"vu","678"],["Vatican City",["europe"],"va","39",".. .... ....",1],["Venezuela",["america","south-america"],"ve","58"],["Vietnam",["asia"],"vn","84"],["Yemen",["middle-east"],"ye","967"],["Zambia",["africa"],"zm","260"],["Zimbabwe",["africa"],"zw","263"]],ce=[["American Samoa",["oceania"],"as","1684"],["Anguilla",["america","carribean"],"ai","1264"],["Bermuda",["america","north-america"],"bm","1441"],["British Virgin Islands",["america","carribean"],"vg","1284"],["Cayman Islands",["america","carribean"],"ky","1345"],["Cook Islands",["oceania"],"ck","682"],["Falkland Islands",["america","south-america"],"fk","500"],["Faroe Islands",["europe"],"fo","298"],["Gibraltar",["europe"],"gi","350"],["Greenland",["america"],"gl","299"],["Jersey",["europe","eu-union"],"je","44",".... ......"],["Montserrat",["america","carribean"],"ms","1664"],["Niue",["asia"],"nu","683"],["Norfolk Island",["oceania"],"nf","672"],["Northern Mariana Islands",["oceania"],"mp","1670"],["Saint Barthélemy",["america","carribean"],"bl","590","",1],["Saint Helena",["africa"],"sh","290"],["Saint Martin",["america","carribean"],"mf","590","",2],["Saint Pierre and Miquelon",["america","north-america"],"pm","508"],["Sint Maarten",["america","carribean"],"sx","1721"],["Tokelau",["oceania"],"tk","690"],["Turks and Caicos Islands",["america","carribean"],"tc","1649"],["U.S. Virgin Islands",["america","carribean"],"vi","1340"],["Wallis and Futuna",["oceania"],"wf","681"]];function A(K,L,N,U,O){return!N||O?K+"".padEnd(L.length,".")+" "+U:K+"".padEnd(L.length,".")+" "+N}function b(K,L,N,U,O){var h,ne,ue=[];return ne=L===!0,[(h=[]).concat.apply(h,c(K.map(function(he){var le={name:he[0],regions:he[1],iso2:he[2],countryCode:he[3],dialCode:he[3],format:A(N,he[3],he[4],U,O),priority:he[5]||0},je=[];return he[6]&&he[6].map(function(be){var we=function($e){for(var De=1;De<arguments.length;De++){var x=arguments[De]!=null?arguments[De]:{},D=Object.keys(x);typeof Object.getOwnPropertySymbols=="function"&&(D=D.concat(Object.getOwnPropertySymbols(x).filter(function(Z){return Object.getOwnPropertyDescriptor(x,Z).enumerable}))),D.forEach(function(Z){t($e,Z,x[Z])})}return $e}({},le);we.dialCode=he[3]+be,we.isAreaCode=!0,we.areaCodeLength=be.length,je.push(we)}),je.length>0?(le.mainCode=!0,ne||L.constructor.name==="Array"&&L.includes(he[2])?(le.hasAreaCodes=!0,[le].concat(je)):(ue=ue.concat(je),[le])):[le]}))),ue]}function E(K,L,N,U){if(N!==null){var O=Object.keys(N),h=Object.values(N);O.forEach(function(ne,ue){if(U)return K.push([ne,h[ue]]);var he=K.findIndex(function(je){return je[0]===ne});if(he===-1){var le=[ne];le[L]=h[ue],K.push(le)}else K[he][L]=h[ue]})}}function J(K,L){return L.length===0?K:K.map(function(N){var U=L.findIndex(function(h){return h[0]===N[2]});if(U===-1)return N;var O=L[U];return O[1]&&(N[4]=O[1]),O[3]&&(N[5]=O[3]),O[2]&&(N[6]=O[2]),N})}var pe=function K(L,N,U,O,h,ne,ue,he,le,je,be,we,$e,De){o(this,K),this.filterRegions=function(Q,se){if(typeof Q=="string"){var me=Q;return se.filter(function(X){return X.regions.some(function(Y){return Y===me})})}return se.filter(function(X){return Q.map(function(Y){return X.regions.some(function(ke){return ke===Y})}).some(function(Y){return Y})})},this.sortTerritories=function(Q,se){var me=[].concat(c(Q),c(se));return me.sort(function(X,Y){return X.name<Y.name?-1:X.name>Y.name?1:0}),me},this.getFilteredCountryList=function(Q,se,me){return Q.length===0?se:me?Q.map(function(X){var Y=se.find(function(ke){return ke.iso2===X});if(Y)return Y}).filter(function(X){return X}):se.filter(function(X){return Q.some(function(Y){return Y===X.iso2})})},this.localizeCountries=function(Q,se,me){for(var X=0;X<Q.length;X++)se[Q[X].iso2]!==void 0?Q[X].localName=se[Q[X].iso2]:se[Q[X].name]!==void 0&&(Q[X].localName=se[Q[X].name]);return me||Q.sort(function(Y,ke){return Y.localName<ke.localName?-1:Y.localName>ke.localName?1:0}),Q},this.getCustomAreas=function(Q,se){for(var me=[],X=0;X<se.length;X++){var Y=JSON.parse(JSON.stringify(Q));Y.dialCode+=se[X],me.push(Y)}return me},this.excludeCountries=function(Q,se){return se.length===0?Q:Q.filter(function(me){return!se.includes(me.iso2)})};var x=function(Q,se,me){var X=[];return E(X,1,Q,!0),E(X,3,se),E(X,2,me),X}(he,le,je),D=J(JSON.parse(JSON.stringify(z)),x),Z=J(JSON.parse(JSON.stringify(ce)),x),ie=$(b(D,L,we,$e,De),2),ae=ie[0],re=ie[1];if(N){var de=$(b(Z,L,we,$e,De),2),ye=de[0];de[1],ae=this.sortTerritories(ye,ae)}U&&(ae=this.filterRegions(U,ae)),this.onlyCountries=this.localizeCountries(this.excludeCountries(this.getFilteredCountryList(O,ae,ue.includes("onlyCountries")),ne),be,ue.includes("onlyCountries")),this.preferredCountries=h.length===0?[]:this.localizeCountries(this.getFilteredCountryList(h,ae,ue.includes("preferredCountries")),be,ue.includes("preferredCountries")),this.hiddenAreaCodes=this.excludeCountries(this.getFilteredCountryList(O,re),ne)},Ce=function(K){function L(O){var h;o(this,L),(h=function(x,D){return!D||g(D)!=="object"&&typeof D!="function"?p(x):D}(this,P(L).call(this,O))).getProbableCandidate=q()(function(x){return x&&x.length!==0?h.state.onlyCountries.filter(function(D){return H()(D.name.toLowerCase(),x.toLowerCase())},p(p(h)))[0]:null}),h.guessSelectedCountry=q()(function(x,D,Z,ie){var ae;if(h.props.enableAreaCodes===!1&&(ie.some(function(ye){if(H()(x,ye.dialCode))return Z.some(function(Q){if(ye.iso2===Q.iso2&&Q.mainCode)return ae=Q,!0}),!0}),ae))return ae;var re=Z.find(function(ye){return ye.iso2==D});if(x.trim()==="")return re;var de=Z.reduce(function(ye,Q){return H()(x,Q.dialCode)&&(Q.dialCode.length>ye.dialCode.length||Q.dialCode.length===ye.dialCode.length&&Q.priority<ye.priority)?Q:ye},{dialCode:"",priority:10001},p(p(h)));return de.name?de:re}),h.updateCountry=function(x){var D,Z=h.state.onlyCountries;(D=x.indexOf(0)>="0"&&x.indexOf(0)<="9"?Z.find(function(ie){return ie.dialCode==+x}):Z.find(function(ie){return ie.iso2==x}))&&D.dialCode&&h.setState({selectedCountry:D,formattedNumber:h.props.disableCountryCode?"":h.formatNumber(D.dialCode,D)})},h.scrollTo=function(x,D){if(x){var Z=h.dropdownRef;if(Z&&document.body){var ie=Z.offsetHeight,ae=Z.getBoundingClientRect().top+document.body.scrollTop,re=ae+ie,de=x,ye=de.getBoundingClientRect(),Q=de.offsetHeight,se=ye.top+document.body.scrollTop,me=se+Q,X=se-ae+Z.scrollTop,Y=ie/2-Q/2;if(h.props.enableSearch?se<ae+32:se<ae)D&&(X-=Y),Z.scrollTop=X;else if(me>re){D&&(X+=Y);var ke=ie-Q;Z.scrollTop=X-ke}}}},h.scrollToTop=function(){var x=h.dropdownRef;x&&document.body&&(x.scrollTop=0)},h.formatNumber=function(x,D){if(!D)return x;var Z,ie=D.format,ae=h.props,re=ae.disableCountryCode,de=ae.enableAreaCodeStretch,ye=ae.enableLongNumbers,Q=ae.autoFormat;if(re?((Z=ie.split(" ")).shift(),Z=Z.join(" ")):de&&D.isAreaCode?((Z=ie.split(" "))[1]=Z[1].replace(/\.+/,"".padEnd(D.areaCodeLength,".")),Z=Z.join(" ")):Z=ie,!x||x.length===0)return re?"":h.props.prefix;if(x&&x.length<2||!Z||!Q)return re?x:h.props.prefix+x;var se,me=B()(Z,function(X,Y){if(X.remainingText.length===0)return X;if(Y!==".")return{formattedText:X.formattedText+Y,remainingText:X.remainingText};var ke,Me=i(ke=X.remainingText)||n(ke)||l(),Re=Me[0],qe=Me.slice(1);return{formattedText:X.formattedText+Re,remainingText:qe}},{formattedText:"",remainingText:x.split("")});return(se=ye?me.formattedText+me.remainingText.join(""):me.formattedText).includes("(")&&!se.includes(")")&&(se+=")"),se},h.cursorToEnd=function(){var x=h.numberInputRef;if(document.activeElement===x){x.focus();var D=x.value.length;x.value.charAt(D-1)===")"&&(D-=1),x.setSelectionRange(D,D)}},h.getElement=function(x){return h["flag_no_".concat(x)]},h.getCountryData=function(){return h.state.selectedCountry?{name:h.state.selectedCountry.name||"",dialCode:h.state.selectedCountry.dialCode||"",countryCode:h.state.selectedCountry.iso2||"",format:h.state.selectedCountry.format||""}:{}},h.handleFlagDropdownClick=function(x){if(x.preventDefault(),h.state.showDropdown||!h.props.disabled){var D=h.state,Z=D.preferredCountries,ie=D.onlyCountries,ae=D.selectedCountry,re=h.concatPreferredCountries(Z,ie).findIndex(function(de){return de.dialCode===ae.dialCode&&de.iso2===ae.iso2});h.setState({showDropdown:!h.state.showDropdown,highlightCountryIndex:re},function(){h.state.showDropdown&&h.scrollTo(h.getElement(h.state.highlightCountryIndex))})}},h.handleInput=function(x){var D=x.target.value,Z=h.props,ie=Z.prefix,ae=Z.onChange,re=h.props.disableCountryCode?"":ie,de=h.state.selectedCountry,ye=h.state.freezeSelection;if(!h.props.countryCodeEditable){var Q=ie+(de.hasAreaCodes?h.state.onlyCountries.find(function(Ae){return Ae.iso2===de.iso2&&Ae.mainCode}).dialCode:de.dialCode);if(D.slice(0,Q.length)!==Q)return}if(D===ie)return ae&&ae("",h.getCountryData(),x,""),h.setState({formattedNumber:""});if(!(D.replace(/\D/g,"").length>15&&(h.props.enableLongNumbers===!1||typeof h.props.enableLongNumbers=="number"&&D.replace(/\D/g,"").length>h.props.enableLongNumbers))&&D!==h.state.formattedNumber){x.preventDefault?x.preventDefault():x.returnValue=!1;var se=h.props.country,me=h.state,X=me.onlyCountries,Y=me.selectedCountry,ke=me.hiddenAreaCodes;if(ae&&x.persist(),D.length>0){var Me=D.replace(/\D/g,"");(!h.state.freezeSelection||Y&&Y.dialCode.length>Me.length)&&(de=h.props.disableCountryGuess?Y:h.guessSelectedCountry(Me.substring(0,6),se,X,ke)||Y,ye=!1),re=h.formatNumber(Me,de),de=de.dialCode?de:Y}var Re=x.target.selectionStart,qe=x.target.selectionStart,Ze=h.state.formattedNumber,ht=re.length-Ze.length;h.setState({formattedNumber:re,freezeSelection:ye,selectedCountry:de},function(){ht>0&&(qe-=ht),re.charAt(re.length-1)==")"?h.numberInputRef.setSelectionRange(re.length-1,re.length-1):qe>0&&Ze.length>=re.length?h.numberInputRef.setSelectionRange(qe,qe):Re<Ze.length&&h.numberInputRef.setSelectionRange(Re,Re),ae&&ae(re.replace(/[^0-9]+/g,""),h.getCountryData(),x,re)})}},h.handleInputClick=function(x){h.setState({showDropdown:!1}),h.props.onClick&&h.props.onClick(x,h.getCountryData())},h.handleDoubleClick=function(x){var D=x.target.value.length;x.target.setSelectionRange(0,D)},h.handleFlagItemClick=function(x,D){var Z=h.state.selectedCountry,ie=h.state.onlyCountries.find(function(ye){return ye==x});if(ie){var ae=h.state.formattedNumber.replace(" ","").replace("(","").replace(")","").replace("-",""),re=ae.length>1?ae.replace(Z.dialCode,ie.dialCode):ie.dialCode,de=h.formatNumber(re.replace(/\D/g,""),ie);h.setState({showDropdown:!1,selectedCountry:ie,freezeSelection:!0,formattedNumber:de,searchValue:""},function(){h.cursorToEnd(),h.props.onChange&&h.props.onChange(de.replace(/[^0-9]+/g,""),h.getCountryData(),D,de)})}},h.handleInputFocus=function(x){h.numberInputRef&&h.numberInputRef.value===h.props.prefix&&h.state.selectedCountry&&!h.props.disableCountryCode&&h.setState({formattedNumber:h.props.prefix+h.state.selectedCountry.dialCode},function(){h.props.jumpCursorToEnd&&setTimeout(h.cursorToEnd,0)}),h.setState({placeholder:""}),h.props.onFocus&&h.props.onFocus(x,h.getCountryData()),h.props.jumpCursorToEnd&&setTimeout(h.cursorToEnd,0)},h.handleInputBlur=function(x){x.target.value||h.setState({placeholder:h.props.placeholder}),h.props.onBlur&&h.props.onBlur(x,h.getCountryData())},h.handleInputCopy=function(x){if(h.props.copyNumbersOnly){var D=window.getSelection().toString().replace(/[^0-9]+/g,"");x.clipboardData.setData("text/plain",D),x.preventDefault()}},h.getHighlightCountryIndex=function(x){var D=h.state.highlightCountryIndex+x;return D<0||D>=h.state.onlyCountries.length+h.state.preferredCountries.length?D-x:h.props.enableSearch&&D>h.getSearchFilteredCountries().length?0:D},h.searchCountry=function(){var x=h.getProbableCandidate(h.state.queryString)||h.state.onlyCountries[0],D=h.state.onlyCountries.findIndex(function(Z){return Z==x})+h.state.preferredCountries.length;h.scrollTo(h.getElement(D),!0),h.setState({queryString:"",highlightCountryIndex:D})},h.handleKeydown=function(x){var D=h.props.keys,Z=x.target.className;if(Z.includes("selected-flag")&&x.which===D.ENTER&&!h.state.showDropdown)return h.handleFlagDropdownClick(x);if(Z.includes("form-control")&&(x.which===D.ENTER||x.which===D.ESC))return x.target.blur();if(h.state.showDropdown&&!h.props.disabled&&(!Z.includes("search-box")||x.which===D.UP||x.which===D.DOWN||x.which===D.ENTER||x.which===D.ESC&&x.target.value==="")){x.preventDefault?x.preventDefault():x.returnValue=!1;var ie=function(ae){h.setState({highlightCountryIndex:h.getHighlightCountryIndex(ae)},function(){h.scrollTo(h.getElement(h.state.highlightCountryIndex),!0)})};switch(x.which){case D.DOWN:ie(1);break;case D.UP:ie(-1);break;case D.ENTER:h.props.enableSearch?h.handleFlagItemClick(h.getSearchFilteredCountries()[h.state.highlightCountryIndex]||h.getSearchFilteredCountries()[0],x):h.handleFlagItemClick([].concat(c(h.state.preferredCountries),c(h.state.onlyCountries))[h.state.highlightCountryIndex],x);break;case D.ESC:case D.TAB:h.setState({showDropdown:!1},h.cursorToEnd);break;default:(x.which>=D.A&&x.which<=D.Z||x.which===D.SPACE)&&h.setState({queryString:h.state.queryString+String.fromCharCode(x.which)},h.state.debouncedQueryStingSearcher)}}},h.handleInputKeyDown=function(x){var D=h.props,Z=D.keys,ie=D.onEnterKeyPress,ae=D.onKeyDown;x.which===Z.ENTER&&ie&&ie(x),ae&&ae(x)},h.handleClickOutside=function(x){h.dropdownRef&&!h.dropdownContainerRef.contains(x.target)&&h.state.showDropdown&&h.setState({showDropdown:!1})},h.handleSearchChange=function(x){var D=x.currentTarget.value,Z=h.state,ie=Z.preferredCountries,ae=Z.selectedCountry,re=0;if(D===""&&ae){var de=h.state.onlyCountries;re=h.concatPreferredCountries(ie,de).findIndex(function(ye){return ye==ae}),setTimeout(function(){return h.scrollTo(h.getElement(re))},100)}h.setState({searchValue:D,highlightCountryIndex:re})},h.concatPreferredCountries=function(x,D){return x.length>0?c(new Set(x.concat(D))):D},h.getDropdownCountryName=function(x){return x.localName||x.name},h.getSearchFilteredCountries=function(){var x=h.state,D=x.preferredCountries,Z=x.onlyCountries,ie=x.searchValue,ae=h.props.enableSearch,re=h.concatPreferredCountries(D,Z),de=ie.trim().toLowerCase().replace("+","");if(ae&&de){if(/^\d+$/.test(de))return re.filter(function(se){var me=se.dialCode;return["".concat(me)].some(function(X){return X.toLowerCase().includes(de)})});var ye=re.filter(function(se){var me=se.iso2;return["".concat(me)].some(function(X){return X.toLowerCase().includes(de)})}),Q=re.filter(function(se){var me=se.name,X=se.localName;return se.iso2,["".concat(me),"".concat(X||"")].some(function(Y){return Y.toLowerCase().includes(de)})});return h.scrollToTop(),c(new Set([].concat(ye,Q)))}return re},h.getCountryDropdownList=function(){var x=h.state,D=x.preferredCountries,Z=x.highlightCountryIndex,ie=x.showDropdown,ae=x.searchValue,re=h.props,de=re.disableDropdown,ye=re.prefix,Q=h.props,se=Q.enableSearch,me=Q.searchNotFound,X=Q.disableSearchIcon,Y=Q.searchClass,ke=Q.searchStyle,Me=Q.searchPlaceholder,Re=Q.autocompleteSearch,qe=h.getSearchFilteredCountries().map(function(Ae,yt){var Et=Z===yt,as=k()({country:!0,preferred:Ae.iso2==="us"||Ae.iso2==="gb",active:Ae.iso2==="us",highlight:Et}),Dt="flag ".concat(Ae.iso2);return y.a.createElement("li",Object.assign({ref:function(Pt){return h["flag_no_".concat(yt)]=Pt},key:"flag_no_".concat(yt),"data-flag-key":"flag_no_".concat(yt),className:as,"data-dial-code":"1",tabIndex:de?"-1":"0","data-country-code":Ae.iso2,onClick:function(Pt){return h.handleFlagItemClick(Ae,Pt)},role:"option"},Et?{"aria-selected":!0}:{}),y.a.createElement("div",{className:Dt}),y.a.createElement("span",{className:"country-name"},h.getDropdownCountryName(Ae)),y.a.createElement("span",{className:"dial-code"},Ae.format?h.formatNumber(Ae.dialCode,Ae):ye+Ae.dialCode))}),Ze=y.a.createElement("li",{key:"dashes",className:"divider"});D.length>0&&(!se||se&&!ae.trim())&&qe.splice(D.length,0,Ze);var ht=k()(t({"country-list":!0,hide:!ie},h.props.dropdownClass,!0));return y.a.createElement("ul",{ref:function(Ae){return!se&&Ae&&Ae.focus(),h.dropdownRef=Ae},className:ht,style:h.props.dropdownStyle,role:"listbox",tabIndex:"0"},se&&y.a.createElement("li",{className:k()(t({search:!0},Y,Y))},!X&&y.a.createElement("span",{className:k()(t({"search-emoji":!0},"".concat(Y,"-emoji"),Y)),role:"img","aria-label":"Magnifying glass"},"🔎"),y.a.createElement("input",{className:k()(t({"search-box":!0},"".concat(Y,"-box"),Y)),style:ke,type:"search",placeholder:Me,autoFocus:!0,autoComplete:Re?"on":"off",value:ae,onChange:h.handleSearchChange})),qe.length>0?qe:y.a.createElement("li",{className:"no-entries-message"},y.a.createElement("span",null,me)))};var ne,ue=new pe(O.enableAreaCodes,O.enableTerritories,O.regions,O.onlyCountries,O.preferredCountries,O.excludeCountries,O.preserveOrder,O.masks,O.priority,O.areaCodes,O.localization,O.prefix,O.defaultMask,O.alwaysDefaultMask),he=ue.onlyCountries,le=ue.preferredCountries,je=ue.hiddenAreaCodes,be=O.value?O.value.replace(/\D/g,""):"";ne=O.disableInitialCountryGuess?0:be.length>1?h.guessSelectedCountry(be.substring(0,6),O.country,he,je)||0:O.country&&he.find(function(x){return x.iso2==O.country})||0;var we,$e=be.length<2&&ne&&!H()(be,ne.dialCode)?ne.dialCode:"";we=be===""&&ne===0?"":h.formatNumber((O.disableCountryCode?"":$e)+be,ne.name?ne:void 0);var De=he.findIndex(function(x){return x==ne});return h.state={showDropdown:O.showDropdown,formattedNumber:we,onlyCountries:he,preferredCountries:le,hiddenAreaCodes:je,selectedCountry:ne,highlightCountryIndex:De,queryString:"",freezeSelection:!1,debouncedQueryStingSearcher:_()(h.searchCountry,250),searchValue:""},h}var N,U;return function(O,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(h&&h.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),h&&C(O,h)}(L,K),N=L,(U=[{key:"componentDidMount",value:function(){document.addEventListener&&this.props.enableClickOutside&&document.addEventListener("mousedown",this.handleClickOutside),this.props.onMount&&this.props.onMount(this.state.formattedNumber.replace(/[^0-9]+/g,""),this.getCountryData(),this.state.formattedNumber)}},{key:"componentWillUnmount",value:function(){document.removeEventListener&&this.props.enableClickOutside&&document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"componentDidUpdate",value:function(O,h,ne){O.country!==this.props.country?this.updateCountry(this.props.country):O.value!==this.props.value&&this.updateFormattedNumber(this.props.value)}},{key:"updateFormattedNumber",value:function(O){if(O===null)return this.setState({selectedCountry:0,formattedNumber:""});var h=this.state,ne=h.onlyCountries,ue=h.selectedCountry,he=h.hiddenAreaCodes,le=this.props,je=le.country,be=le.prefix;if(O==="")return this.setState({selectedCountry:ue,formattedNumber:""});var we,$e,De=O.replace(/\D/g,"");if(ue&&H()(O,be+ue.dialCode))$e=this.formatNumber(De,ue),this.setState({formattedNumber:$e});else{var x=(we=this.props.disableCountryGuess?ue:this.guessSelectedCountry(De.substring(0,6),je,ne,he)||ue)&&H()(De,be+we.dialCode)?we.dialCode:"";$e=this.formatNumber((this.props.disableCountryCode?"":x)+De,we||void 0),this.setState({selectedCountry:we,formattedNumber:$e})}}},{key:"render",value:function(){var O,h,ne,ue=this,he=this.state,le=he.onlyCountries,je=he.selectedCountry,be=he.showDropdown,we=he.formattedNumber,$e=he.hiddenAreaCodes,De=this.props,x=De.disableDropdown,D=De.renderStringAsFlag,Z=De.isValid,ie=De.defaultErrorMessage,ae=De.specialLabel;if(typeof Z=="boolean")h=Z;else{var re=Z(we.replace(/\D/g,""),je,le,$e);typeof re=="boolean"?(h=re)===!1&&(ne=ie):(h=!1,ne=re)}var de=k()((t(O={},this.props.containerClass,!0),t(O,"react-tel-input",!0),O)),ye=k()({arrow:!0,up:be}),Q=k()(t({"form-control":!0,"invalid-number":!h,open:be},this.props.inputClass,!0)),se=k()({"selected-flag":!0,open:be}),me=k()(t({"flag-dropdown":!0,"invalid-number":!h,open:be},this.props.buttonClass,!0)),X="flag ".concat(je&&je.iso2);return y.a.createElement("div",{className:"".concat(de," ").concat(this.props.className),style:this.props.style||this.props.containerStyle,onKeyDown:this.handleKeydown},ae&&y.a.createElement("div",{className:"special-label"},ae),ne&&y.a.createElement("div",{className:"invalid-number-message"},ne),y.a.createElement("input",Object.assign({className:Q,style:this.props.inputStyle,onChange:this.handleInput,onClick:this.handleInputClick,onDoubleClick:this.handleDoubleClick,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,onCopy:this.handleInputCopy,value:we,onKeyDown:this.handleInputKeyDown,placeholder:this.props.placeholder,disabled:this.props.disabled,type:"tel"},this.props.inputProps,{ref:function(Y){ue.numberInputRef=Y,typeof ue.props.inputProps.ref=="function"?ue.props.inputProps.ref(Y):typeof ue.props.inputProps.ref=="object"&&(ue.props.inputProps.ref.current=Y)}})),y.a.createElement("div",{className:me,style:this.props.buttonStyle,ref:function(Y){return ue.dropdownContainerRef=Y}},D?y.a.createElement("div",{className:se},D):y.a.createElement("div",{onClick:x?void 0:this.handleFlagDropdownClick,className:se,title:je?"".concat(je.localName||je.name,": + ").concat(je.dialCode):"",tabIndex:x?"-1":"0",role:"button","aria-haspopup":"listbox","aria-expanded":!!be||void 0},y.a.createElement("div",{className:X},!x&&y.a.createElement("div",{className:ye}))),be&&this.getCountryDropdownList()))}}])&&d(N.prototype,U),L}(y.a.Component);Ce.defaultProps={country:"",value:"",onlyCountries:[],preferredCountries:[],excludeCountries:[],placeholder:"1 (702) 123-4567",searchPlaceholder:"search",searchNotFound:"No entries to show",flagsImagePath:"./flags.png",disabled:!1,containerStyle:{},inputStyle:{},buttonStyle:{},dropdownStyle:{},searchStyle:{},containerClass:"",inputClass:"",buttonClass:"",dropdownClass:"",searchClass:"",className:"",autoFormat:!0,enableAreaCodes:!1,enableTerritories:!1,disableCountryCode:!1,disableDropdown:!1,enableLongNumbers:!1,countryCodeEditable:!0,enableSearch:!1,disableSearchIcon:!1,disableInitialCountryGuess:!1,disableCountryGuess:!1,regions:"",inputProps:{},localization:{},masks:null,priority:null,areaCodes:null,preserveOrder:[],defaultMask:"... ... ... ... ..",alwaysDefaultMask:!1,prefix:"+",copyNumbersOnly:!0,renderStringAsFlag:"",autocompleteSearch:!1,jumpCursorToEnd:!0,enableAreaCodeStretch:!1,enableClickOutside:!0,showDropdown:!1,isValid:!0,defaultErrorMessage:"",specialLabel:"Phone",onEnterKeyPress:null,keys:{UP:38,DOWN:40,RIGHT:39,LEFT:37,ENTER:13,ESC:27,PLUS:43,A:65,Z:90,SPACE:32,TAB:9}},s.default=Ce}]);const Aa=Gs($a);function Ia(){var v,B;const{current:r,setAbsPath:s,json:a}=ge(),{user:t}=I(),{selectedFeature:n,createFeature:c,fetchProductsUseFeature:i,updateFeature:l,productsUseFeature:o,setSelectedFeature:d,removeFeature:m,setFeatureById:g}=Nt(),[p,P]=j.useState(n||{}),[C,M]=j.useState("components");j.useEffect(()=>{n&&(i(n.id),P(n),M(n.view||"components"))},[n]),j.useEffect(()=>{T&&(a!=null&&a.feature_id)&&t&&g(a.feature_id)},[t,a]);const y=r("new_feature"),T=r("dash_features"),S=tt().width<1e3?"wrap":"";p.is_new=y;const q={components:e.jsx(Fa,{canAdd:!0,setCollected:F=>P({...p,components:F}),collected:p}),number:e.jsx(Ma,{collected:p}),text:e.jsx(ms,{type:"text",collected:p}),email:e.jsx(ms,{type:"email",collected:p}),website:e.jsx(ms,{type:"url",collected:p}),date:e.jsx(As,{type:"date",collected:p}),time:e.jsx(As,{type:"time",collected:p}),phone:e.jsx(Ra,{collected:p})};return console.log(p),(T||y)&&(!n&&T?e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}):e.jsxs("div",{className:"dash-feature",ref:Oe,children:[e.jsx(jt,{deteleKey:(n==null?void 0:n.id)||"noga",mode:y?"create":"delete",title:"Product Information",onCreate:()=>{c({...p,view:C}).then(F=>{if(F!=null&&F.id)return P(F),console.log("res",F),s(["features","dash_features"]);console.log("res",F)})},onDelete:()=>{n&&m(n.id).then(F=>{F&&d(void 0)})}}),e.jsxs("section",{className:"editor "+S,children:[e.jsxs("div",{className:"left-side",children:[e.jsx("h1",{onClick:()=>{l(p)},children:"Update"}),T&&e.jsx(fe,{label:"Feature Id",value:(n==null?void 0:n.id)||""}),e.jsxs("label",{htmlFor:"feature.product_id",children:[e.jsx("h2",{className:"labele",children:"Product Id"}),e.jsx("input",{type:"text",value:p.product_id,onChange:F=>P({...p,product_id:F.currentTarget.value})})]}),e.jsx("h3",{children:"Choise Feature Type"}),e.jsx("div",{className:"datas",children:e.jsxs("div",{className:"input-datas",children:[e.jsx("div",{className:"d-components "+(C=="components"?"active":""),onClick:()=>{P({...p,view:"components",match:""}),M("components")},children:"Components"}),e.jsx("div",{className:"d-number "+(C=="number"?"active":""),onClick:()=>{P({...p,view:"number",match:""}),M("number")},children:"Number"}),e.jsx("div",{className:"d-text "+(C=="text"?"active":""),onClick:()=>{P({...p,view:"text",match:""}),M("text")},children:"Text"}),e.jsx("div",{className:"d-email "+(C=="email"?"active":""),onClick:()=>{M("email"),P({...p,view:"email",match:'^(([^<>()[]\\.,;:s@"]+(.[^<>()[]\\.,;:s@"]+)*)|(".+"))@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}])|(([a-zA-Z-0-9]+.)+[a-zA-Z]{2,}))$'})},children:"Email"}),e.jsx("div",{className:"d-website "+(C=="website"?"active":""),onClick:()=>{M("website"),P({...p,view:"website",match:"(https?://(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|www.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|https?://(?:www.|(?!www))[a-zA-Z0-9]+.[^s]{2,}|www.[a-zA-Z0-9]+.[^s]{2,})"})},children:"Web Site"}),e.jsx("div",{className:"d-date "+(C=="date"?"active":""),onClick:()=>{P({...p,view:"date",match:""}),M("date")},children:"Date"}),e.jsx("div",{className:"d-time "+(C=="time"?"active":""),onClick:()=>{P({...p,view:"time",match:""}),M("time")},children:"Time"}),e.jsx("div",{className:"d-phone "+(C=="phone"?"active":""),onClick:()=>{P({...p,view:"phone",match:""}),M("phone")},children:"Phone"})]})})]}),e.jsxs("div",{className:"right-side",children:[e.jsx("h3",{children:"Preview Feature"}),e.jsxs("div",{className:"feature-infos",children:[e.jsxs("div",{className:"edit-infos",children:[e.jsxs("label",{className:"s-icon",htmlFor:"s-icon",children:[e.jsx("div",{className:"label",children:"Image"}),e.jsx("input",{type:"file",name:"s-icon",id:"s-icon",onChange:F=>{var H;return P({...p,new_icon:((H=F.currentTarget.files)==null?void 0:H[0])||p.new_icon})}})]}),e.jsxs("label",{className:"s-name",htmlFor:"s-name",children:[e.jsx("div",{className:"label",children:"Name"}),e.jsx("input",{id:"s-name",value:p.name||"",type:"text",placeholder:"Feature Name",onChange:F=>P({...p,name:F.currentTarget.value||""})})]})]}),e.jsxs("div",{className:"feature",style:{background:"#358f2733"},onClick:()=>{},children:[e.jsx("label",{htmlFor:"s-icon",className:"icon",style:{background:p.new_icon?p.new_icon&&Ye(URL.createObjectURL(p.new_icon)):((v=p.icon)==null?void 0:v[0])&&Ye(p.icon[0])},children:!(p.icon||p.new_icon)&&"+ add Image"}),e.jsx("label",{htmlFor:"s-name",style:{filter:((B=Ft("#358f27"))==null?void 0:B.result.filter)||""},className:"label _limit-text",children:p.name?Ge(p.name,10):"name"})]})]}),e.jsx("h3",{children:" View "}),e.jsx("div",{className:"ctn-view",children:q[C]}),e.jsx("h3",{className:"setting",children:"Setting"}),e.jsxs("div",{className:"setting-ctn",children:[e.jsxs("div",{className:"s-required",onClick:()=>P({...p,required:p.required?void 0:"true"}),children:[e.jsxs("div",{className:"box "+(p.required?"active":""),children:[" ",e.jsx("span",{style:{filter:Ft("#fff").result.filter}})]}),"Required"]}),C!="phone"&&C!="time"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:"s-min",children:[e.jsx("div",{className:"label",children:"Min"}),e.jsx("input",{id:"s-min",value:p.min,min:C=="components"||C=="text"||C=="email"||C=="website"?0:void 0,type:C=="date"?"date":"number",placeholder:"Min "+(C=="components"?"Selected":C=="text"||C=="email"||C=="website"?"Length":"value"),onChange:F=>{console.log(F.currentTarget.value),P({...p,min:C=="date"?new Date(F.currentTarget.value).getTime():F.currentTarget.value||parseFloat(F.currentTarget.value)})}})]}),e.jsxs("label",{htmlFor:"s-max",children:[e.jsx("div",{className:"label",children:"Max"}),e.jsx("input",{id:"s-max",value:p.max,min:C=="components"||C=="text"||C=="email"||C=="website"?0:void 0,type:C=="date"?"date":"number",placeholder:"Max "+(C=="components"?"Selected":C=="text"||C=="email"||C=="website"?"Length":"value"),onChange:F=>{console.log(F.currentTarget.value),P({...p,max:C=="date"?new Date(F.currentTarget.value).getTime():F.currentTarget.value||parseFloat(F.currentTarget.value)})}})]})]}),(C=="number"||C=="text"||C=="email"||C=="website")&&e.jsxs("label",{htmlFor:"s-placeholder",children:[e.jsx("div",{className:"label",children:"Placeholder"}),e.jsx("input",{id:"s-placeholder",type:"text",value:p.placeholder,placeholder:"Placeholder",onChange:F=>P({...p,placeholder:F.currentTarget.value})})]}),(C=="text"||C=="email"||C=="website")&&e.jsxs("label",{htmlFor:"s-match",children:[e.jsx("div",{className:"label",children:"RegExp"}),e.jsx("input",{id:"s-match",type:"text",placeholder:"RegExp",value:p.match,onChange:F=>P({...p,match:F.currentTarget.value})})]}),C=="text"&&e.jsxs("div",{className:"s-cases",children:[e.jsx("div",{className:"lowercase "+(p.case=="lowercase"?"active":""),onClick:()=>P({...p,case:p.case=="lowercase"?void 0:"lowercase"})}),e.jsx("div",{className:"uppercase "+(p.case=="uppercase"?"active":""),onClick:()=>P({...p,case:p.case=="uppercase"?void 0:"uppercase"})}),e.jsx("div",{className:"capitalize "+(p.case=="capitalize"?"active":""),onClick:()=>P({...p,case:p.case=="capitalize"?void 0:"capitalize"})})]})]})]})]}),e.jsx("h1",{className:"",children:"Feature's Products"}),e.jsx("pre",{children:JSON.stringify(p,void 0,4)}),e.jsx(G,{filter:{sortBy:"id",limit:(o==null?void 0:o.limit)||25,page:o==null?void 0:o.page,total:o==null?void 0:o.total},disableFilterBar:!0,items_height:80,id:"product-use-Feature_list",datas:(o==null?void 0:o.list)||[],itemsMapper:{images:{getView(F,H,V,k){return G.ImageElement().getView(F,`${W}${H[0]}`,V,k)}},id:{getView(F,H,V,k){return e.jsxs("div",{ref:k,children:["#",H.split("-")[0]]},V.id)}},title:G.StringElement({size_interval:[50,200]}),status:G.StringElement({size:150}),stock:G.StringElement(),category_id:{getView(F,H,V,k){return e.jsxs("div",{ref:k,children:["#",H.split("-")[0]]},V.id)}},price:G.StringElement({size:200}),created_at:G.DateStringElement({size:200})}})]}))}function As({collected:r,type:s}){const[a,t]=j.useState(""),[n,c]=j.useState(r.default_value||"");return e.jsxs("label",{htmlFor:"v-text",children:[e.jsxs("div",{className:"label",children:[r.name||"Input Date"," ",e.jsx("span",{children:a})]}),e.jsx("input",{id:"v-text",type:s,placeholder:r.placeholder,value:n,onChange:i=>{const l=i.currentTarget.value;r.min!=null&&l.length<r.min?t("Minimum Lenght is "+r.min):r.max!=null&&l.length>r.max?t("Maximum Lenght is "+r.max):t(""),c(l)}})]})}function Ra({collected:r}){const[s,a]=j.useState(r.default_value||"");return e.jsx(Aa,{country:"us",value:s,onChange:t=>a(t)})}function Fa({collected:r,setCollected:s,canAdd:a}){var m;const[t,n]=j.useState(""),[c,i]=j.useState([]),[l,o]=j.useState(0),{openChild:d}=Te();return e.jsxs("div",{className:"components",children:[e.jsxs("div",{className:"comp-top",children:["selected ( ",c.length," ) ",e.jsx("span",{children:t})]}),a&&e.jsxs("div",{className:"add-btn",onClick:()=>{d(e.jsx(Oa,{onCreate:g=>s([g,...r.components||[]])}),!1,"#3455",{overlay:!0})},children:[e.jsx("span",{}),"Add New"]}),e.jsx("div",{className:"comp-list "+(a?"can-add":""),children:(m=r.components)==null?void 0:m.map(g=>{var p,P,C,M,y,T;return e.jsxs("div",{className:"component _limit-text "+(c.find(_=>_.name==g.name)?" active ":"")+((p=g.images)!=null&&p[0]?" icon":"not-icon"),onClick:()=>{if(c.find(S=>S.name==g.name))if(r.min!=null&&c.length<=r.min){n("Minimum Selection is "+r.min),clearTimeout(l);const S=setTimeout(()=>{clearTimeout(S),n("")},2e3);o(S)}else i(c.filter(S=>S.name!=g.name));else if(r.max!=null&&c.length>=r.max){n("maximum Selection is "+r.max),clearTimeout(l);const S=setTimeout(()=>{clearTimeout(S),n("")},2e3);o(S)}else i([...c,g])},children:[((P=g.images)==null?void 0:P[0])&&e.jsx("div",{className:"icon",style:{background:typeof((C=g.images)==null?void 0:C[0])=="string"?Ye((M=g.images)==null?void 0:M[0]):((y=g.images)==null?void 0:y[0])&&Ye(URL.createObjectURL(g.images[0]))}}),e.jsx("div",{style:{filter:((T=Ft("#358f27"))==null?void 0:T.result.filter)||""},className:"label _limit-text",children:g.name&&Ge(g.name,10)}),a&&e.jsx("div",{className:"remove",onClick:()=>{s(r.components.filter(_=>_.name!=g.name))}})]},g.name)})})]})}function Oa({onCreate:r}){const{openChild:s}=Te(),[a,t]=j.useState({name:"",description:"",scene_code:"",scene:null,price:0,unity:"",images:[]});return e.jsx("div",{className:"new-component",onClick:n=>{n.currentTarget==n.target&&s(void 0)},children:e.jsxs("div",{className:"ctn",children:[e.jsx("div",{className:"close",onClick:()=>s(void 0)}),e.jsx("h1",{children:"New Component"}),e.jsxs("label",{htmlFor:"new-comp-name",className:"name",children:[e.jsx("div",{className:"label",children:"Name"}),e.jsx("input",{id:"new-comp-name",type:"text",value:a.name,onChange:n=>t({...a,name:n.currentTarget.value})})]}),e.jsxs("label",{htmlFor:"new-comp-image",style:{background:a.images[0]&&Ye(URL.createObjectURL(a.images[0]))},className:"new-comp-image",children:[!a.images[0]&&"+ Add Image",e.jsxs("div",{className:"label",children:["Image ",e.jsx("span",{children:"( optional )"})]}),e.jsx("input",{accept:"image/*",style:{display:"none"},id:"new-comp-image",name:"new-comp-image",type:"file",onChange:n=>t({...a,images:n.currentTarget.files})})]}),e.jsxs("label",{htmlFor:"new-comp-description",className:"description",children:[e.jsxs("div",{className:"label",children:["Description ",e.jsx("span",{children:"( optional )"})]}),e.jsx("input",{id:"new-comp-description",type:"text",value:a.description,onChange:n=>t({...a,description:n.currentTarget.value})})]}),e.jsxs("label",{htmlFor:"new-comp-price",className:"price",children:[e.jsxs("div",{className:"label",children:["Price Impact ",e.jsx("span",{children:"( optional )"})]}),e.jsx("input",{id:"new-comp-price",type:"number",value:a.price,onChange:n=>t({...a,price:parseFloat(n.currentTarget.value)})})]}),e.jsxs("label",{htmlFor:"new-comp-scene-code",className:"scene-code",children:[e.jsxs("div",{className:"label",children:["Scene Code ",e.jsx("span",{children:"( optional )"})]}),e.jsx("input",{id:"new-comp-scene-code",type:"text",value:a.scene_code,onChange:n=>t({...a,scene_code:n.currentTarget.value})})]}),e.jsxs("div",{className:"label",children:["Scene File ",e.jsx("span",{children:"( optional )"})]}),e.jsx(ts,{onChange:n=>t({...a,scene:n})}),e.jsxs("div",{className:"btm",children:[e.jsx("div",{className:"cancel",onClick:()=>s(void 0),children:"Cancel"}),e.jsx("div",{className:"create",onClick:()=>{a.name.trim()&&(r(a),s(void 0))},children:"Create"})]})]})})}function ms({collected:r,color:s,type:a}){const[t,n]=j.useState("");let c,i=a||"text";if(r.match)try{c=new RegExp(r.match,"i")}catch{}const[l,o]=j.useState(r.default_value||"");return e.jsxs("label",{htmlFor:"v-text",children:[r.icon&&e.jsx("div",{className:"icon",style:{background:Ye(r.icon[0]),filter:s&&Ft(s).result.filter}}),e.jsxs("div",{className:"label",children:[r.name||"Input "+i,e.jsx("span",{children:t})]}),e.jsx("input",{id:"v-text",type:i,placeholder:r.placeholder,value:l,onChange:d=>{const m=d.currentTarget.value;c?c.test(m)?n(""):n("inValid "+i):r.min&&m.length<r.min?n("Minimum Lenght is "+r.min):r.max&&m.length>r.max?n("Maximum Lenght is "+r.max):n(""),r.max?o(m.substring(0,r.max)):o(m)}})]})}function Ma({collected:r,color:s}){const[a,t]=j.useState(""),[n,c]=j.useState(r.min||0),[i,l]=j.useState(0);return e.jsxs("label",{htmlFor:"v-text",children:[r.icon&&e.jsx("div",{className:"icon",style:{background:Ye(r.icon[0]),filter:s&&Ft(s).result.filter}}),e.jsxs("div",{className:"label",children:[r.name||"Input Number",e.jsx("span",{children:a})]}),e.jsx("input",{id:"v-text",type:"number",placeholder:r.placeholder,value:n,onChange:o=>{let d=o.currentTarget.value;if(console.log(d),r.min!=null&&d<r.min){t("Minimum Value is "+r.min),clearTimeout(i);const m=setTimeout(()=>{t("")},2e3);l(m)}else if(r.max!=null&&d>r.max){t("Maximum Value is "+r.max);const m=setTimeout(()=>{t("")},2e3);l(m)}else t("");c(d)}})]})}function La(){const{check:r,setAbsPath:s,current:a}=ge();return r("features")&&e.jsxs("div",{className:"page-features",children:[(a("features")||a("dash_features")||a("new_feature"))&&e.jsx(ss,{active:"features",setActive:t=>s(t.path)}),e.jsx(Ta,{}),e.jsx(Ia,{})]})}function za(){const{current:r,setAbsPath:s,qs:a}=ge(),{catalogs:t,fetchCatalogs:n,setSelectedCatalog:c}=St(),{store:i}=I();return j.useEffect(()=>{r("catalogs")&&i&&n()},[i]),r("catalogs")&&e.jsx("div",{className:"catalog-list",children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","label","description","index","status","created_at"],limit:t==null?void 0:t.limit,page:t==null?void 0:t.page,total:t==null?void 0:t.total,filter:{}},items_height:80,id:"category_list",datas:(t==null?void 0:t.list)||[],itemsMapper:{id:{getView(l,o,d,m){return e.jsxs("div",{ref:m,children:["#",o.split("-")[0]]},d.id)}},label:G.StringElement({size_interval:[50,200]}),total_product:{getView(l,o,d,m){return G.StringElement().getView(l,o||0,d,m)}},description:G.StringElement({size_interval:[50,200]}),status:it,created_at:G.DateStringElement({size:200})},onItemsSelected:(l,o)=>{o.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="")}),l.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="#00f2")}),c(l[0]),a({catalog_id:l[0].id}).setAbsPath(["catalogs","dash_catalogs"])},onQuery:l=>{n(l)},top_height:40,canAddNew:!0,canPaginate:!0,onNewRequired:()=>{s(["catalogs","new_catalog"])}})})})}function Ba(){const{json:r,current:s,setAbsPath:a}=ge(),{setCatalogById:t,selectedCatalog:n,catalogCategories:c,fetchCatalogCategories:i,updateCatalog:l,catalogProducts:o,setSelectedCatalog:d,removeCatalog:m,fetchCatalogProducts:g,createCatalog:p}=St(),{setSelectedProduct:P}=at(),{setSelectedCategory:C}=gt(),[M]=j.useState({}),{store:y}=I(),[T,_]=j.useState("products"),[S]=j.useState(!1),v=tt().width<1e3?"wrap":"";j.useEffect(()=>{n&&(g({catalog_id:n.id}),i({catalog_id:n.id}))},[n]);const B=s("dash_catalogs"),F=s("new_catalog");j.useEffect(()=>{r!=null&&r.catalog_id&&t(r==null?void 0:r.catalog_id)},[r]);const H=e.jsx(e.Fragment,{children:B&&e.jsxs(e.Fragment,{children:[e.jsx(ps,{status:(n==null?void 0:n.status)||"PAUSE",onChange:V=>{B?n&&l({catalog_id:n.id,status:V}):M.status=V}})," ",e.jsx(ts,{file_name:B?n==null?void 0:n.scene_dir:void 0,ext:["zip"],label:"Upload Scene File",onChange:V=>{B?n&&l({catalog_id:n.id,scene_dir:V}):M.scene_dir=V}})]})});return console.log({selectedCatalog:n}),(B||F)&&(!n&&B?e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}):e.jsxs("div",{className:"catalog-dash",ref:Oe,children:[e.jsx(jt,{terme:"dark",deteleKey:(n==null?void 0:n.id)||"noga",mode:F?"create":"delete",title:"Catalog Information",onCreate:()=>{p(M).then(V=>{if(!V)return a(["catalogs","dash_catalogs"])})},onDelete:()=>{n&&m(n.id).then(V=>{V&&d(void 0)})}}),e.jsxs("section",{className:"editor "+v,children:[e.jsxs("div",{className:"left-side",children:[B&&e.jsx(fe,{isCheckRequired:S,label:"Catalog Id",value:(n==null?void 0:n.id)||""}),e.jsxs("div",{className:"editor-name",children:[e.jsx("div",{className:"catalog-title",children:e.jsx(fe,{editable:!0,prompt:"Catalog Label",isCheckRequired:S,min:3,check:"auto",max:50,label:"Label",placeholder:"Catalog Label",value:B&&((n==null?void 0:n.label)||""),onChange:V=>{B?n&&l({catalog_id:n.id,label:V}):M.label=V}})}),e.jsx("div",{className:"Catalog-description",children:e.jsx(gs,{editable:!0,prompt:"Catalog Description",isCheckRequired:S,min:3,check:"auto",max:250,label:"Description",placeholder:"Catalog Description",value:B&&((n==null?void 0:n.description)||""),onChange:V=>{B?n&&l({catalog_id:n.id,description:V}):M.description=V}})})]}),B&&H]}),e.jsxs("div",{className:"right-side",children:[B&&e.jsxs(e.Fragment,{children:[e.jsx(Ot,{}),e.jsx(vs,{onClick:()=>{},direction:"horizontal"})]}),F&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{isCheckRequired:S,label:"Store Name",value:(y==null?void 0:y.name)||""}),e.jsx(fe,{isCheckRequired:S,label:"Store Id",value:(y==null?void 0:y.id)||""})]})]})]}),B&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"btm-list",children:[e.jsx("h1",{children:"Products That Use This Catalog"}),e.jsxs("div",{style:{display:"flex"},children:[e.jsxs("div",{className:"btn "+(T=="products"?"active":""),onClick:()=>{_("products")},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Products"})]}),e.jsxs("div",{className:"btn "+(T=="categories"?"active":""),onClick:()=>{_("categories")},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Categories"})]})]}),e.jsx("h2",{className:"see-all",onClick:()=>{T=="products"?a(["products"]):a(["categories"])},children:"SEE ALL"})]}),T=="products"&&e.jsx(G,{filter:{sortBy:"id",limit:(o==null?void 0:o.limit)||25,page:o==null?void 0:o.page,total:o==null?void 0:o.total},disableFilterBar:!0,items_height:80,id:"product-use-catalog_list",datas:(o==null?void 0:o.list)||[],itemsMapper:{images:{getView(V,k,$,z){return G.ImageElement().getView(V,`${W}${k[0]}`,$,z)}},id:{getView(V,k,$,z){return e.jsxs("div",{ref:z,children:["#",k.split("-")[0]]},$.id)}},title:G.StringElement({size_interval:[50,200]}),stock:G.StringElement(),category_id:{getView(V,k,$,z){return e.jsxs("div",{ref:z,children:["#",k.split("-")[0]]},$.id)}},price:G.StringElement({size:200}),status:it,created_at:G.DateStringElement({size:200})},onItemsSelected:V=>{P(V[0]),a(["products","dash_product"])}}),T=="categories"&&e.jsx(G,{disableFilterBar:!0,items_height:80,id:"product-use-catalog_list",datas:(c==null?void 0:c.list)||[],itemsMapper:{id:{getView(V,k,$,z){return e.jsxs("div",{ref:z,children:["#",k.split("-")[0]]},$.id)}},label:G.StringElement({size_interval:[50,200]}),total_products:{getView(V,k,$,z){return G.StringElement().getView(V,k||0,$,z)}},catalog_id:{getView(V,k,$,z){return e.jsxs("div",{ref:z,children:["#",k.split("-")[0]]},$.id)}},status:it,created_at:G.DateStringElement({size:500})},onItemsSelected:V=>{console.log(V[0],"))))))))))))))"),C(V[0]),a(["categories","dash_categories"])}})]})]}))}function qa(){const{check:r,setAbsPath:s,current:a}=ge();return r("catalogs")&&e.jsxs("div",{className:"page-catalogs",children:[(a("catalogs")||a("new_catalog")||a("dash_catalogs"))&&e.jsx(ss,{active:"catalogs",setActive:t=>s(t.path)}),e.jsx(Ba,{}),e.jsx(za,{})]})}function Va(){const{current:r,qs:s}=ge(),{moderators:a,setSelectedModerator:t,fetchModerators:n}=vt(),{store:c}=I();return j.useEffect(()=>{r("moderators")&&c&&n()},[c]),r("moderators")&&e.jsx("div",{className:"moderator-list",ref:Oe,children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","title","stock","price","date","status"],limit:a==null?void 0:a.limit,page:a==null?void 0:a.page,total:a==null?void 0:a.total,filter:{price:Ke([0,1e5],[0,1e4]),stock:Ke([0,1e4],[0,1e4]),status:Ct(["PAUSE","TRASH","NEW"],[]),index:kt([0,100]),is_dynamic_price:et(),hasScene:et()}},items_height:80,id:"moderator_list",datas:(a==null?void 0:a.list)||[],itemsMapper:{photos:{getView(i,l,o,d){return G.ImageElement().getView(i,`${l[0].startsWith("/")?W:""}${l[0]}`,o,d)}},id:{getView(i,l,o,d){return e.jsxs("div",{ref:d,children:["#",l.split("-")[0]]},o.id)}},name:G.StringElement({size_interval:[50,200]}),status:{getView(i,l,o,d){return it.getView(i,"VISIBLE",o,d)}},created_at:G.DateStringElement({size:200})},onItemsSelected:(i,l)=>{l.forEach(o=>{o.$itemRef&&(o.$itemRef.style.background="")}),i.forEach(o=>{o.$itemRef&&(o.$itemRef.style.background="#00f2")}),t(i[0]),s({moderator_id:i[0].id}).setAbsPath(["moderators","moderator_profile"])},onQuery:i=>{n(i)},top_height:40,canPaginate:!0})})})}function Ua(){const{current:r,json:s}=ge(),{user:a}=I(),{selectedModerator:t,setModeratorById:n}=vt(),{store:c}=I(),[i]=j.useState(!1),o=tt().width<1e3?"wrap":"";return j.useEffect(()=>{r("moderator_profile")&&(s!=null&&s.moderator_id)&&c&&n(s.moderator_id)},[s,c]),r("moderator_profile")&&(t?e.jsxs("div",{className:"moderator-profile",ref:Oe,children:[e.jsx("h1",{children:"Moderator Information"}),e.jsxs("section",{className:"editor "+o,children:[e.jsx("div",{className:"left-right",children:e.jsx(Rt,{name:"moderator_profile",images:t.photos||[],cannotEdit:!0})}),e.jsxs("div",{className:"left-side",children:[e.jsx(fe,{isCheckRequired:i,label:"Moderator Id",value:(t==null?void 0:t.id)||""}),e.jsx(fe,{prompt:"Moderator Name",isCheckRequired:i,min:3,check:"auto",max:50,label:"Name",placeholder:"Catalog Label",value:t==null?void 0:t.name}),e.jsx(fe,{prompt:"Moderator Email",isCheckRequired:i,min:3,check:"auto",max:50,label:"Email",placeholder:"Catalog Label",value:t==null?void 0:t.email}),e.jsx(fe,{label:"created At",value:t==null?void 0:t.created_at}),e.jsx(fe,{label:"Join Store At",value:t==null?void 0:t.join_at}),a&&t.id!=a.id&&e.jsx(fs,{user:t,channel:"discussions_admin"})]})]})]}):e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}))}function Ha(){const{check:r,current:s,setAbsPath:a}=ge();return r("moderators")&&e.jsxs("div",{className:"moderator-page",children:[s("moderators","moderator_profile")&&e.jsx(Yt,{active:"moderators",setActive:t=>a(t.path)}),e.jsx(Va,{}),e.jsx(Ua,{})]})}const Xe=Je(r=>({json_roles:void 0,roles:void 0,selectedRole:void 0,async setSelectedRole(s){r(()=>({selectedRole:s}))},async setRoleById(s){const a=Xe.getState().roles,t=a==null?void 0:a.list.find(n=>n.id==s);if(t)r(()=>({selectedRole:t}));else if(I.getState().store){const c=await Xe.getState().fetchRoles({role_id:s});r(()=>({selectedRole:c==null?void 0:c.list.find(i=>i.id==s)}))}else{const c=Date.now(),i=setInterval(async()=>{if(Date.now()-c>10*1e3&&clearInterval(i),I.getState().store){clearInterval(i);const o=await Xe.getState().fetchRoles({role_id:s});r(()=>({selectedRole:o==null?void 0:o.list.find(d=>d.id==s)}))}},100)}},async newRole(s){var o;if(!s.name)return console.log("Name required");if(!s.options||s.options.length==0)return console.log("Option Is required");const a=I.getState().store;if(!a)return;let t=I.getState().user;if(!t)return;const n=new FormData;n.append("name",s.name),n.append("store_id",a.id),(o=s.options)==null||o.forEach(d=>{n.append(d,"1")});const c=new Headers;c.append("Authorization",`Bearer ${t.token}`);const l=await(await fetch(`${W}/create_collaborator_role`,{method:"POST",body:n,headers:c})).json();!l||!l.id||(console.log("new role",l),r(()=>({selectedRole:l})),Te.getState().fetchUsersVar(),ge.getState().setAbsPath(["roles","edit_role"]))},async updateRole(s){var d,m;console.log("data",s);const a=Xe.getState().selectedRole;if(!a)return;if(!s.name&&!s.options)return console.log("data",s);if(!I.getState().store)return;let n=I.getState().user;if(!n)return;const c=new FormData;c.append("role_id",a.id),s.name&&c.append("name",s.name),((d=s.options)==null?void 0:d.length)>0&&c.append("newOptions","ok"),(m=s.options)==null||m.forEach(g=>{c.append(g,"1")});const i=new Headers;i.append("Authorization",`Bearer ${n.token}`);const o=await(await fetch(`${W}/update_role`,{method:"PUT",body:c,headers:i})).json();!o||!o.id||r(()=>({selectedRole:o}))},async deleteRole(s){console.log(s);const a=I.getState().store;if(!a)return;let t=I.getState().user;if(!t)return;const n=new Headers;n.append("Authorization",`Bearer ${t.token}`);const c=new FormData;c.append("store_id",a.id),c.append("role_id",s);const i={method:"DELETE",headers:n,body:c};(await(await fetch(`${W}/delete_role`,i)).json()).deleted&&r(()=>({selectedRole:void 0})),Te.getState().fetchUsersVar()},async fetchRolesJson(){const a=await(await fetch(`${W}/get_roles_json`)).json();a&&r(()=>({json_roles:a}))},async fetchRoles(s={}){const a=I.getState().store;if(!a)return;let t=I.getState().user;if(!t)return;const n=new Headers;n.append("Authorization",`Bearer ${t.token}`);const c={method:"GET",headers:n};s.store_id=a.id;const i=new URLSearchParams({});for(const d in s){const m=s[d];i.set(d,m)}const o=await(await fetch(`${W}/get_store_roles/?${i.toString()}`,c)).json();if(console.log("roles",o),!(!o||!o.list))return r(()=>({roles:o})),o}}));function Wa(){const{current:r,setAbsPath:s,qs:a}=ge(),{roles:t,setSelectedRole:n,fetchRoles:c}=Xe(),{store:i}=I();return j.useEffect(()=>{r("roles")&&i&&c()},[i]),r("roles")&&e.jsx("div",{className:"collaborator-list",ref:Oe,children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","title","stock","price","date","status"],limit:t==null?void 0:t.limit,page:t==null?void 0:t.page,total:t==null?void 0:t.total,filter:{price:Ke([0,1e5],[0,1e4]),stock:Ke([0,1e4],[0,1e4]),status:Ct(["PAUSE","TRASH","NEW"],[]),index:kt([0,100]),is_dynamic_price:et(),hasScene:et()}},items_height:80,id:"collaborator_list",datas:(t==null?void 0:t.list)||[],itemsMapper:{id:{getView(l,o,d,m){return e.jsxs("div",{ref:m,children:["#",o.split("-")[0]]},d.id)}},name:G.StringElement({size_interval:[50,200]}),created_at:G.DateStringElement({size:200})},onItemsSelected:(l,o)=>{o.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="")}),l.forEach(d=>{d.$itemRef&&(d.$itemRef.style.background="#00f2")}),n(l[0]),a({role_id:l[0].id}).setAbsPath(["roles","edit_role"])},onQuery:l=>{c(l)},canAddNew:!0,onNewRequired:()=>{s(["roles","create_role"])},top_height:40,canPaginate:!0})})})}function Ga(){const{selectedRole:r,setRoleById:s,updateRole:a,newRole:t,deleteRole:n,json_roles:c}=Xe(),{current:i,json:l}=ge(),[o]=j.useState({}),d=i("edit_role"),m=i("create_role");return j.useEffect(()=>{l!=null&&l.role_id&&s(l==null?void 0:l.role_id)},[l]),(d||m)&&(!r&&d?e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}):e.jsxs("div",{className:"role-dash",ref:Oe,children:[e.jsx(jt,{title:"Role Information",mode:d?"delete":"create",deteleKey:r==null?void 0:r.id,onDelete:()=>{r&&n(r.id)},onCreate:()=>{t(o)}}),e.jsxs("section",{className:"editor",children:[e.jsxs("div",{className:"left-side",children:[e.jsx(fe,{min:3,max:25,placeholder:"Role Name",prompt:"Role Name",editable:!0,label:"Name",value:d?r==null?void 0:r.name:"",onChange:g=>{d?a({name:g}):o.name=g}}),d&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{label:"Id",value:r==null?void 0:r.id}),e.jsx(fe,{label:"Created At",value:r==null?void 0:r.created_at}),e.jsx(fe,{label:"Update At",value:r==null?void 0:r.updated_at}),e.jsx(Ot,{})]})]}),e.jsx("div",{className:"right-side",children:e.jsx(Ws,{role:r,json_roles:c,isNew:m,onChange:g=>{d?a({options:g}):o.options=g}})})]})]}))}function Ka(){const{check:r,current:s,setAbsPath:a}=ge();return r("roles")&&e.jsxs("div",{className:"role-page",children:[s("roles","edit_role")&&e.jsx(Yt,{active:"roles",setActive:t=>a(t.path)}),e.jsx(Wa,{}),e.jsx(Ga,{})]})}function Ja(){const{current:r,setAbsPath:s,qs:a}=ge(),{collaborators:t,setSelectedCollaborator:n,fetchCollaborators:c}=nt(),{store:i}=I(),{roles:l}=Xe();return j.useEffect(()=>{r("collaborators")&&i&&c()},[i]),r("collaborators")&&e.jsx("div",{className:"collaborator-list",ref:Oe,children:e.jsx("div",{className:"list-ctn",children:e.jsx(G,{filter:{sortBy:"id",sortableColumns:["id","title","stock","price","date","status"],limit:t==null?void 0:t.limit,page:t==null?void 0:t.page,total:t==null?void 0:t.total,filter:{price:Ke([0,1e5],[0,1e4]),stock:Ke([0,1e4],[0,1e4]),status:Ct(["PAUSE","TRASH","NEW"],[]),index:kt([0,100]),is_dynamic_price:et(),hasScene:et()}},items_height:80,id:"collaborator_list",datas:(t==null?void 0:t.list)||[],itemsMapper:{photos:{getView(o,d,m,g){return G.ImageElement().getView(o,`${d[0].startsWith("/")?W:""}${d[0]}`,m,g)}},id:{getView(o,d,m,g){return e.jsxs("div",{ref:g,children:["#",d.split("-")[0]]},m.id)}},name:G.StringElement({size_interval:[50,200]}),email:G.StringElement({size:200}),status:it,role_id:{getView(o,d,m,g){var p;return e.jsx("div",{ref:g,children:(p=l==null?void 0:l.list.find(P=>P.id==d))==null?void 0:p.name},m.id)}},join_at:G.DateStringElement({size:150}),created_at:G.DateStringElement({size:150})},onItemsSelected:(o,d)=>{d.forEach(m=>{m.$itemRef&&(m.$itemRef.style.background="")}),o.forEach(m=>{m.$itemRef&&(m.$itemRef.style.background="#00f2")}),n(o[0]),a({collaborator_id:o[0].id}).setAbsPath(["collaborators","collaborator_profile"])},onQuery:o=>{c(o)},canAddNew:!0,onNewRequired:()=>{s(["collaborators","new_collaborator"])},top_height:40,canPaginate:!0})})})}const Za=["PAUSE","VISIBLE","NEW"];function Qa({onChange:r,status:s,canEdit:a}){const[t,n]=j.useState(s);return e.jsx("div",{className:"choise-status",children:e.jsx("div",{className:"ctn",children:Za.map(c=>e.jsx("div",{className:"use-status "+c.toLocaleLowerCase()+" "+(t==c?"active":""),onClick:()=>{a&&n(c),a&&(r==null||r(c))},children:c},c))})})}function Xa(){const{current:r,json:s}=ge(),{selectedCollaborator:a,setCollaboratorById:t,removeCollaborator:n,updateCollaborator:c,change_collaborator_role:i}=nt(),[l]=j.useState(!1),{roles:o,fetchRoles:d}=Xe(),g=tt().width<1e3?"wrap":"",{store:p,user:P}=I();return j.useEffect(()=>{s!=null&&s.collaborator_id&&t(s==null?void 0:s.collaborator_id)},[s]),j.useEffect(()=>{d({})},[P]),console.log({roles:o}),r("collaborator_profile")&&(a?e.jsxs("div",{className:"collaborator-profile",ref:Oe,children:[e.jsx(jt,{title:"Collaborator Information",mode:"delete",deteleKey:a.id,onDelete:()=>{console.log(a.id),n(a.id)}}),e.jsxs("section",{className:"editor "+g,children:[e.jsxs("div",{className:"left-right",children:[e.jsx(Rt,{name:"collaborator_profile",images:a.photos||[],cannotEdit:!0}),e.jsx(fe,{label:"Name",value:a==null?void 0:a.name}),e.jsx(fe,{label:"Email",value:a==null?void 0:a.email}),e.jsx(fe,{label:"created At",value:a==null?void 0:a.created_at}),e.jsx(fe,{label:"Join Store At",value:a==null?void 0:a.join_at})]}),e.jsxs("div",{className:"left-side",children:[e.jsx(fe,{label:"Store Name",value:(p==null?void 0:p.name)||"pppp"}),e.jsx(fe,{label:"Store Id",value:p==null?void 0:p.id}),e.jsx(fe,{isCheckRequired:l,label:(a==null?void 0:a.s_type)+" Id",value:(a==null?void 0:a.id)||""}),(P==null?void 0:P.id)!=a.id&&e.jsxs("div",{className:"chat-btn-ctn",children:[e.jsx(fs,{user:a,channel:"discussions"}),window.location.pathname.split("/")[3]=="admin"&&e.jsx("div",{className:"btn-chat-admin",onClick:()=>{p&&window.open(`${Ks}/admin#chat/discussions={"store_id":"${p.id}","collaborator_id":"${a.id}"}`)},children:"Open as Admin"})]}),e.jsx(Qa,{status:(a==null?void 0:a.status)||"NEW",onChange:C=>{c({product_id:a.id,status:C})}}),e.jsx(Fs,{roles:(o==null?void 0:o.list)||[],canChange:()=>!0,role_id:a.role_id,onChange:C=>{i({new_role_id:C,collaborator_id:a.id})}}),e.jsx(Ot,{})]})]})]}):e.jsx("div",{className:"not-found",children:e.jsx("div",{className:"img"})}))}function Ya(){const{current:r}=ge(),{addCollaborator:s}=nt(),{store:a}=I(),[t]=j.useState(!1),n=tt(),{roles:c,fetchRoles:i}=Xe();j.useEffect(()=>{i({})},[a]);const l=n.width<1e3?"wrap":"",[o]=j.useState({});return j.useEffect(()=>{},[]),r("new_collaborator")&&e.jsxs("div",{className:"collaborator-profile",ref:Oe,children:[e.jsx(jt,{terme:"white",mode:"create",title:"Collaborator Information",onCreate:()=>{s(o).then(d=>{console.log(d)})}}),e.jsxs("section",{className:"editor "+l,children:[e.jsxs("div",{className:"left-right",children:[e.jsx(fe,{label:"Store Name",value:a==null?void 0:a.name}),e.jsx(fe,{label:"Store Id",value:a==null?void 0:a.id}),e.jsx(fe,{editable:!0,prompt:"Collaborator Email",isCheckRequired:t,min:3,check:"auto",max:50,label:"Email",placeholder:"Catalog Label",value:"",onChange:d=>{o.email=d}})]}),e.jsx("div",{className:"left-side",children:e.jsx(Fs,{roles:(c==null?void 0:c.list)||[],canChange:()=>!0,onChange:d=>{o.role_id=d}})})]})]})}function en(){const{check:r,current:s,setAbsPath:a}=ge();return r("collaborators")&&e.jsxs("div",{className:"collaborator-page",children:[s("collaborators","collaborator_profile","new_collaborator")&&e.jsx(Yt,{active:"collaborators",setActive:t=>a(t.path)}),e.jsx(Ja,{}),e.jsx(Xa,{}),e.jsx(Ya,{})]})}const Is={store:"Store",products:"Products",categories:"Categories",features:"Features",catalogs:"Catalogs",dash_product:"Edit Product",dash_categories:"Edit Category",dash_features:"Edit Feature",dash_catalogs:"Edit Catalog",preview:"Preview",statistic:"Statistic",action:"Action",new_product:"New Product",new_category:"New Category",product_preview:"Product Preview",user:"Users",clients:"clients",collaborators:"Collaborator",client_profile:"Profile",collaborator_profile:"Profile",roles:"Roles",create_role:"New Role",edit_role:"Editor",new_collaborator:"New Collaborator",chat:"Chat",interface:"Interface",sessions:"Sessions",discussions:"Discussions",moderators:"Moderators",moderator_profile:"Moderator Profile"};function tn(){const{currentChild:r,overlay:s,blur:a,openChild:t,fetchUsersVar:n,fetchStoreVar:c,T:i,setT:l,back_color:o}=Te(),{authenticateUser:d,user:m,store:g}=I(),{pathList:p,setAbsPath:P}=ge(),{fetchRolesJson:C}=Xe(),M=[];p.forEach(T=>{Is[T]&&M.push(Is[T])}),j.useEffect(()=>{t(void 0)},[p]);const[y]=j.useState({});return y.overlay=s,j.useEffect(()=>{d(),window.addEventListener("blur",()=>{console.log("#################",y),!y.overlay&&t(void 0)})},[]),j.useEffect(()=>{g&&(c(),C(),n())},[g]),e.jsxs("div",{className:"dash "+(i?"sombre-mode-variable":""),children:[e.jsx(Ds,{blur:a}),e.jsx("div",{className:"dash-ctn "+(m?a?"blur":"":"blur"),children:e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"center-top",children:[e.jsxs("div",{className:"nav-min",onClick:()=>{t(e.jsx(Ds,{className:"max",blur:a}),!0,"#345b")},children:[" ",e.jsx("span",{})]}),e.jsx("div",{className:"page-path",children:M.map((T,_)=>e.jsxs("div",{className:"path",children:[e.jsxs("div",{className:"label",onClick:()=>{const S=p.slice(1,_+2);P(S)},children:[T,e.jsx("span",{})]}),M[_+1]?e.jsx("div",{className:"icon"}):void 0]},_))}),e.jsxs("div",{className:"dash-top-right",children:[e.jsxs("div",{className:"dark-mode "+i,onClick:()=>{l(i?"":"active")},children:[e.jsx("span",{className:"dark-mode-btn"})," ",e.jsx("span",{className:"dark-white-btn",children:" "})]}),e.jsxs("div",{className:"notf",children:[" ",e.jsx("span",{})]})]})]}),e.jsxs("div",{className:"center-ctn",ref:T=>{if(!T||T.dataset.init)return;T.dataset.init="true";const _=()=>{const S=document.querySelector(".dash .center .center-top");T.style.height=`calc(100% - ${S.getBoundingClientRect().height}px)`};window.addEventListener("resize",_),_()},children:[e.jsx(ca,{}),e.jsx(Pa,{}),e.jsx(qa,{}),e.jsx(La,{}),e.jsx(ua,{}),e.jsx(Ha,{}),e.jsx(en,{}),e.jsx(Ka,{}),e.jsx(wa,{}),e.jsx(Ca,{})]})]})}),!m&&e.jsx(Qs,{}),r&&e.jsx("div",{className:"child-viewer",onContextMenu:T=>{T.preventDefault(),!y.overlay&&t(void 0)},children:e.jsx("div",{className:"child-viewer-ctn",style:{background:o},onClick:()=>{!y.overlay&&t(void 0)},onContextMenu:T=>{T.preventDefault(),!y.overlay&&t(void 0)},children:r})})]})}const sn=r=>r,un=sn(e.jsx(Js.StrictMode,{children:e.jsx(tn,{})}));export{un as DashView};
