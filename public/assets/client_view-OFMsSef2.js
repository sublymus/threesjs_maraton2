import{c as ee,S as Be,j as e,g as U,L as Z,l as ce,u as Ue,b as Me}from"./BindToParentScroll-DBxHG4Le.js";import{H as E,r as x,R as He}from"./index-B_gxtWp7.js";import{t as $,S as We}from"./SearchFilterBindJson-BZbWq4O4.js";const b=ee(t=>({user:void 0,store:void 0,userStore:void 0,manager:void 0,openAuth:!1,async updateUser(a){const s=b.getState().getHeaders();if(!s)return;const n=new FormData;a.photos_0=a.photo,delete a.photo;for(const r in a)a[r]&&n.append(r,a[r]);n.append("photos",'["photos_0"]');const c=await(await fetch(`${E}/edit_me`,{method:"PUT",body:n,headers:s.headers})).json();console.log({user:c}),c.id&&(t(()=>({user:c})),localStorage.setItem("user",JSON.stringify({...s.user,...c})))},async disconnection(){const a=b.getState().getHeaders();if(!a)return;const s={method:"GET",headers:a.headers};await fetch(`${E}/disconnection`,s),localStorage.removeItem("user"),t(()=>({user:void 0,store:void 0,userStore:void 0,openAuth:!0}))},async getAccess(){window.open(`${E}/google_connexion`,void 0,"popup");const a=setInterval(()=>{const s=localStorage.getItem("user"),n=s&&JSON.parse(s);n&&(console.log("getAccess",{token:n.token}),t(()=>({user:n})),clearInterval(a),b.getState().authenticateUser())},100)},async authenticateUser(){let a=localStorage.getItem("user");const s=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];try{if(a){const n=JSON.parse(a),l=new Headers;l.append("Authorization",`Bearer ${n.token}`);const c={method:"GET",headers:l},r=await fetch(`${E}/can_use_store/${s}`,c);let o;try{if(o=await r.json(),!o.store)return}catch{return}const i=(o==null?void 0:o.user)&&{...n,...o.user};t(()=>({user:i,manager:o.manager,userStore:o.userStore,store:o.store,openAuth:!1})),o!=null&&o.user&&localStorage.setItem("user",JSON.stringify(i));return}}catch{}await b.getState().getStore()},async getStore(){const a=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];if(a){const s=await fetch(`${E}/get_store_by_name/${a}`);try{let n=await s.json();t(()=>({store:n})),console.log(n)}catch{}}},getHeaders(){const a=b.getState().store;if(!a)return;let s=b.getState().user;const n=new Headers;return n.append("Authorization",`Bearer ${s==null?void 0:s.token}`),{store:a,headers:n,user:s}}})),je=[{u:"products",n:"Home",i:"/src/res/application.png"},{u:"categories",n:"Categories",i:"/src/res/catalog.png"},{u:"favorites",n:"Favorites",i:"/src/res/shopping-cart.png"},{u:"cart",n:"Cart",i:"/src/res/chat.png"},{u:"profile",n:"Prolife",i:"/src/res/chat.png"}],ze={"/":{loading:{},products:{detail:{comments:{},images:{}}},categories:{},favorites:{},cart:{payment:{}},profile:{command:{}}}},se=ee(t=>({T:localStorage.getItem("theme"),storeVar:void 0,usersVar:void 0,back_color:"",blur:!1,openNav:"max",setOpenNav(a){t(()=>({openNav:a}))},setT(a){a&&localStorage.setItem("theme",a),t(()=>({T:a}))},currentChild:void 0,openChild(a,s,n){t(()=>({currentChild:a,blur:s,back_color:a&&n||""}))}})),H=new Be(ze,["/","products"]).getStore(),Ve=(t,a)=>{const s=setInterval(()=>{let n=!1,l=t,c=0;for(;!n;){if(l==document.body){clearInterval(s),a(),n=!0;return}else l==null||c>100?n=!0:l=l.parentElement;c++}},100)},qe=(t,a)=>s=>{if(!s)return;if(s.dataset.init)return t==null?void 0:t(s.setIndex);s.dataset.init="init:"+Math.trunc(Math.random()*1e3)/1e3;const n=()=>{let l=0;const c=i=>{const d=s.querySelectorAll(".card-h-c");if(l=i,d.length<=0)return;l=l>=d.length?d.length-1:l<0?0:l;const m=s.getBoundingClientRect(),h=m.width,u=d[l].getBoundingClientRect(),g=u.x-m.x+u.width/2;s.scrollTo({behavior:"smooth",left:s.scrollLeft-(h/2-g)})};s.setIndex=c;const r=()=>{const i=s.getBoundingClientRect().width;c(l);const d=s.querySelectorAll(".gap");for(const m of d)m.style.width=`${i/2}px`,m.style.minWidth=`${i/2}px`,m.style.maxWidth=`${i/2}px`};window.addEventListener("resize",r),r();const o=.1;s.addEventListener("scrollend",()=>{const i=s.getBoundingClientRect(),d=i.width,m=d*o,v=s.querySelectorAll(".card-h-c")[l].getBoundingClientRect(),u=v.x-i.x+v.width/2;let g=l;u<d/2-m?(g=l+1,c(g)):u>d/2+m?(g=l-1,c(g)):c(l),a==null||a(g)}),t==null||t(c)};Ve(s,()=>{n()})},X=ee(t=>({commands:void 0,carts:void 0,async deleteCommand(a){const s=b.getState().getHeaders();if(!s)return!1;if((await(await fetch(`${E}/delete_command/${a}`,{headers:s.headers,method:"DELETE"})).json()).deleted){const c=X.getState().carts;return t(()=>({carts:{limit:(c==null?void 0:c.limit)||25,page:(c==null?void 0:c.page)||1,total:(c==null?void 0:c.total)||0,list:((c==null?void 0:c.list)||[]).filter(r=>r.id!=a)}})),!0}return!1},async addProductToCart(a){const s=b.getState().getHeaders();if(!s||!(a.product_id||a.command_id))return;const n=new FormData,l={};n.append("store_id",s.store.id),a.product_id&&n.append("product_id",a.product_id+""),a.command_id&&n.append("command_id",a.command_id+""),a.quantity!=null&&n.append("quantity",a.quantity+""),a.collected_features&&n.append("collected_features",JSON.stringify(a.collected_features));const c=new URLSearchParams({});for(const d in l){const m=l[d];c.set(d,m)}const o=await(await fetch(`${E}/add_command`,{method:"POST",headers:s.headers,body:n})).json();if(!o.id)return;const i=X.getState().carts;return t(()=>({carts:{limit:(i==null?void 0:i.limit)||25,page:(i==null?void 0:i.page)||1,total:(i==null?void 0:i.total)||0,list:[...i!=null&&i.list?i==null?void 0:i.list.map(d=>d.id==o.id?o:d):[o]]}})),o},async confirmCommand(a){const s=b.getState().getHeaders();if(!s)return!1;const n=new FormData;return a!=null&&a.list&&n.append("list",JSON.stringify(a.list)),(await(await fetch(`${E}/client_confirm_command`,{headers:s.headers,method:"PUT",body:n})).json()).success?(X.getState().fetchCarts({}),X.getState().fetchCommands({}),!0):!1},async fetchCarts(){const a=b.getState().getHeaders();if(!a)return;const s={};s.store_id=a.store.id,s.status="CART",s.add_favorite=!0;const n=new URLSearchParams({});for(const r in s){const o=s[r];n.set(r,o)}const c=await(await fetch(`${E}/get_commands/?${n.toString()}`,{headers:a.headers})).json();return t(()=>({carts:c})),c},async fetchCommands(){const a=b.getState().getHeaders();if(!a)return;const s={};s.store_id=a.store.id,s.no_status="CART",s.add_favorite=!0;const n=new URLSearchParams({});for(const r in s){const o=s[r];n.set(r,o)}const c=await(await fetch(`${E}/get_commands/?${n.toString()}`,{headers:a.headers})).json();return t(()=>({commands:c})),console.log(c),c}}));function ve({cart:t,canNull:a,product:s,onChange:n}){var o,i;let[l,c]=x.useState(Number((t==null?void 0:t.quantity)||(s==null?void 0:s.quantity)||0)||0);const{addProductToCart:r}=X();return x.useEffect(()=>{c(Number((t==null?void 0:t.quantity)||(s==null?void 0:s.quantity)||0)||0)},[s,t]),e.jsxs("div",{className:"cart-quantity",onClick:d=>{d.preventDefault(),d.stopPropagation()},children:[e.jsx("div",{className:"min "+(l<=(a?0:1)?"bloc":""),onClick:()=>{let d=parseInt(l+"");d=d-1<(a?0:1)?a?0:1:d-1,c(d),console.log("counter===>>>> ",d),(s||t)&&r({product_id:s==null?void 0:s.id,command_id:t==null?void 0:t.id,quantity:d}).then(()=>{n==null||n(l)})},children:e.jsx("span",{style:{filter:l<=(a?0:1)||!1?$("#fff").result.filter:$("#358f27").result.filter}})}),e.jsx("div",{className:"count",children:l}),e.jsx("div",{className:"max "+(l>=(((o=s||t)==null?void 0:o.stock)||Number.MAX_VALUE)?"bloc":""),onClick:()=>{var m,h,v,u;let d=parseInt(l+"");d=d<(((m=s||t)==null?void 0:m.stock)||Number.MAX_VALUE)?d:((h=s||t)==null?void 0:h.stock)||Number.MAX_VALUE,d=d+1,!(d>parseInt((((v=s||t)==null?void 0:v.stock)||Number.MAX_VALUE)+""))&&(c(d),(s||s||t)&&r({product_id:s==null?void 0:s.id,command_id:t==null?void 0:t.id,quantity:d,collected_features:(u=s==null?void 0:s.featuresCollector)==null?void 0:u.allCollectedFeatures()}).then(()=>{n==null||n(l)}))},children:e.jsx("span",{style:{filter:l>=(((i=s||t)==null?void 0:i.stock)||Number.MAX_VALUE)?$("#fff").result.filter:$("#358f27").result.filter}})})]})}function ie({detail:t,image:a,title:s}){const{getAccess:n}=b();return e.jsx("div",{className:"page-auth",children:e.jsxs("div",{className:"auth-ctn",onClick:l=>{l.stopPropagation(),l.preventDefault()},children:[e.jsx("div",{className:"image",style:{background:a&&U(a)}}),e.jsxs("div",{className:"form",children:[e.jsx("h1",{className:"auth-title",children:s||"JOIN US NOW"}),e.jsxs("h5",{className:"auth-prompt",children:["Read more ?"," ",e.jsx("span",{onClick:()=>{},children:"Click here"})]}),e.jsxs("div",{className:"google",onClick:()=>{n()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Connexion"})]}),e.jsx("p",{children:t||"Google connexion is required to get access to sublymus service."})]})]})})}const Ne=ee((t,a)=>({favorites:void 0,setFavorites(s){t(()=>({favorites:s}))},async deleteFavorite(s){const n=b.getState().getHeaders();if(!(n!=null&&n.user))return!1;if((await(await fetch(`${E}/delete_favorite/${s}`,{headers:n.headers,method:"DELETE"})).json()).deleted){const r=a().favorites;return t(()=>({favorites:{limit:(r==null?void 0:r.limit)||25,page:(r==null?void 0:r.page)||1,total:(r==null?void 0:r.total)||0,list:[...(r==null?void 0:r.list)||[]].filter(o=>o.id!=s).map(o=>({...o}))}})),!0}return!1},async addFavorite(s){const n=b.getState().getHeaders();if(!(n!=null&&n.user)||!s.product_id)return;const l=new FormData,c={};l.append("product_id",s.product_id),s.label&&l.append("label",s.label);const r=new URLSearchParams({});for(const m in c){const h=c[m];r.set(m,h)}const i=await(await fetch(`${E}/add_favorite`,{method:"POST",headers:n.headers,body:l})).json();if(!i.id)return;const d=a().favorites;return t(()=>({favorites:{limit:(d==null?void 0:d.limit)||25,page:(d==null?void 0:d.page)||1,total:(d==null?void 0:d.total)||0,list:[...((d==null?void 0:d.list)||[]).map(m=>m.id==i.id?i:m)]}})),i},async fetchFavorites(s){const n=b.getState().getHeaders();if(!(n!=null&&n.user))return;const l={...s};l.store_id=n.store.id,l.add_product=!0;const c=new URLSearchParams({});for(const i in l){const d=l[i];d&&c.set(i,d)}const o=await(await fetch(`${E}/get_favorites/?${c.toString()}`,{headers:n.headers})).json();if(o!=null&&o.list)return s!=null&&s.no_save||t(()=>({favorites:o})),{...o}}}));function Le({elm:t,onChange:a}){const{addFavorite:s,deleteFavorite:n}=Ne(),{openChild:l}=se(),c=t.product_id||t.id,[r,o]=x.useState(!1),[i,d]=x.useState(0),[m]=x.useState({});return m.counter=i,m.isOpen=r,e.jsxs("div",{className:"favorites-btn "+(t.favorite?"favorite":"")+" "+(r?"open":""),onClick:()=>{r?(c&&l(e.jsx(Je,{product_id:c,onChange:()=>a==null?void 0:a(t)}),!1,"#3455"),o(!1)):t.favorite?n(t.favorite).then(()=>{a==null||a(t)}):(()=>{o(!0),d(3);const h=setInterval(()=>{console.log(m.counter),m.counter>1&&m.isOpen?d(m.counter-1):(clearInterval(h),m.isOpen&&(o(!1),s({product_id:c,label:"default"}).then(()=>{a==null||a(t)})))},1e3)})()},children:[e.jsx("span",{className:"icon",style:{display:r?"none":"",filter:t.favorite&&$("#c00").result.filter}}),e.jsx("span",{className:"plus",style:{display:r?"":"none",filter:t.favorite&&$("#c00").result.filter}}),e.jsx("span",{className:"down",style:{display:r?"":"none",filter:t.favorite&&$("#c00").result.filter},children:i})]})}function Je({product_id:t,onChange:a}){var h,v;const{openChild:s}=se(),[n,l]=x.useState(!1),[c,r]=x.useState(""),{addFavorite:o,favorites:i,fetchFavorites:d}=Ne(),m=u=>{(u||c)&&(console.log(u,c),o({product_id:t,label:u||c}).then(()=>{a==null||a(),r(""),s(void 0)}))};return x.useEffect(()=>{!(i!=null&&i.labels)&&d({add_labels:!0})}),e.jsx("div",{className:"choise-label",onClick:()=>s(void 0),children:e.jsxs("div",{className:"ctn",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:[e.jsx("h1",{children:"Choise Label"}),e.jsx("div",{className:"list",children:(v=((h=i==null?void 0:i.labels)==null?void 0:h.length)==0?["default"]:i==null?void 0:i.labels)==null?void 0:v.map(u=>e.jsxs("div",{className:"label",style:{borderBottom:`${Z(u)} 2px solid`,border:`${Z(u)} 2px solid`},onClick:()=>{m(u)},children:[u," ",e.jsx("span",{style:{background:Z(u)}})]}))}),n?e.jsx("div",{className:"new-label",children:e.jsxs("label",{htmlFor:"new-label",children:[e.jsx("span",{className:"plus",onClick:()=>{m()}}),e.jsx("input",{type:"text",autoFocus:!0,id:"new-label",value:c,onKeyUp:u=>{console.log(u.code),u.code=="Enter"&&m()},onChange:u=>{r(u.currentTarget.value.toLowerCase().trim())}}),e.jsx("span",{className:"send",onClick:()=>{m()}})]})}):e.jsx("div",{className:"add-new",onClick:()=>{l(!0)},children:"Add New Label"})]})})}function ge({product:t,active:a,onClick:s,aspect:n,mode:l,onRefresh:c}){var v,u,g,y;const{addProductToCart:r}=X(),{openChild:o}=se(),{user:i}=b(),d=x.useRef(null),[m,h]=x.useState(0);return x.useEffect(()=>{const N=()=>{d.current&&n!=null&&l=="v"&&(d.current.style.height=`${d.current.getBoundingClientRect().width*(n||1)}px`)};return n!=null&&l=="v"&&window.addEventListener("resize",N),d.current&&(!n||l=="h")&&(d.current.style.height=""),N(),()=>{window.removeEventListener("resize",N)}},[d,n,l]),e.jsxs("div",{className:"product-card "+l+" "+(a?"active":""),onClick:s,ref:d,children:[e.jsx("div",{className:"back"}),e.jsxs("div",{className:"images",ref:qe(void 0,h),children:[e.jsx("div",{className:"gap"}),t.images.map(N=>e.jsx("div",{className:"image card-h-c ",style:{background:U(N)}},N)),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"div",onClick:N=>{N.preventDefault(),N.stopPropagation()},children:i&&e.jsx(Le,{elm:t,onChange:()=>{c==null||c(t)}})}),e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"counters",children:t.images.map((N,A)=>e.jsx("div",{className:"counter "+(m==A?"active":"")},N))}),e.jsx("div",{className:"price",children:e.jsx("div",{className:"value",children:"12450.93 $"})}),e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:t.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:t.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((v=t.note)!=null&&v.star?"":"vide")}),e.jsx("div",{className:"note",children:((u=t.note)==null?void 0:u.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((g=t.note)==null?void 0:g.votes)||0}),e.jsx("div",{className:"users"}),!((y=t.note)!=null&&y.star)&&e.jsx("div",{className:"new",children:"New"})]}),e.jsx("div",{className:"add-btn unselectable",onClick:N=>{N.preventDefault(),N.stopPropagation()},children:t.quantity!=null&&t.quantity!=null&&parseInt(t.quantity+"")!=0&&t.quantity.toString()!="0"?e.jsx(ve,{canNull:!0,product:t,onChange:()=>{c==null||c(t)}}):e.jsxs("div",{className:"btn _limit-text",onClick:()=>{var N;return i?r({product_id:t.id,quantity:1,collected_features:(N=t.featuresCollector)==null?void 0:N.allCollectedFeatures()}).then(A=>{A!=null&&A.id&&(c==null||c(t))}):o(e.jsx(ie,{}),!1,"#3455")},children:["Add ",e.jsx("span",{children:" to cart"})]})})]})]})}const oe=ee((t,a)=>({visites:void 0,product:void 0,products:{limit:25,list:[],page:1,total:0},setProducts(s,n){t(({products:l})=>({products:(l||n)&&{...l,...n,...s}}))},setVisites(s,n){t(({visites:l})=>({visites:(l||n)&&{...l,...n,...s}}))},async setClientVisite(s){const n=b.getState().getHeaders();if(!(n!=null&&n.user))return;const l=new FormData;l.append("product_id",s),await fetch(`${E}/set_client_visited`,{headers:n.headers,body:l,method:"PUT"})},async fetchVisites({after_date:s,before_date:n,client_id:l,product_id:c,limit:r,page:o}){const i=b.getState().getHeaders();if(!i)return;const d={};d.store_id=i.store.id,d.product_id=c||"",d.client_id=l||"",d.limit=r||6,d.page=o||1,d.after_date=s||"",d.before_date=n||"",d.add_favorite=!0;const m=new URLSearchParams({});for(const u in d){const g=d[u];g!=null&&m.set(u,g)}const v=await(await fetch(`${E}/get_client_visited/?${m.toString()}`,{headers:i.headers})).json();!v||!v.list||t(()=>({visites:v}))},featuresCollector:void 0,async setProductById(s){if(!s.product_id)return;const n=a().products,l=n==null?void 0:n.list.find(c=>c.id==s.product_id);if(l)a().selectProduct(l),t(()=>({featuresCollector:l==null?void 0:l.featuresCollector}));else{const c=b.getState().store;if(!c)return;const r={};r.product_id=s.product_id,r.is_features_required=!0,r.store_id=c.id,r.by_product_category=!(n!=null&&n.list[0]);const o=new URLSearchParams({});for(const h in r){const v=r[h];v!=null&&o.set(h,v)}const d=await(await fetch(`${E}/get_products/?${o.toString()}`)).json();if(!d.list)return;const m=d.list.find(h=>h.id==s.product_id)||d.list[0];t(()=>({products:n?{...n,list:[...d.list.filter(h=>!n.list.find(v=>v.id==h.id)),...n.list]}:d,product:m,featuresCollector:m==null?void 0:m.featuresCollector})),a().selectProduct(m)}},fetchProducts:async s=>{const n=b.getState().getHeaders();if(!n)return;const l={...s};l.store_id=n.store.id,l.add_favorite=!0;const c=new URLSearchParams({});for(const i in l){const d=l[i];d!=null&&c.set(i,d)}const o=await(await fetch(`${E}/get_products/?${c.toString()}`,{headers:n.headers})).json();if(o!=null&&o.list)return s!=null&&s.no_save||t(()=>({products:o})),{...o}},async selectProduct(s,n){var c,r;if(!s)return t(()=>({product:void 0}));let l={};(r=(c=s==null?void 0:s.features)==null?void 0:c.list)==null||r.forEach(o=>{var i;l[o.name]=(i=o.components)==null?void 0:i.find(d=>d.is_default),console.log(o.components,l[o.name])}),s&&(s.featuresCollector={collectFeature(o,i){var d;if(i!=null)l[o.name]=i;else{const m=(d=o.components)==null?void 0:d.find(h=>h.is_default);m&&(l[o.name]=m)}t(()=>({featuresCollector:s.featuresCollector&&{...s.featuresCollector}}))},getCollectedFeatures(o){return l[o]},setAll(o){l=o},allCollectedFeatures(){return l}}),!n&&(t(()=>({product:s})),a().setClientVisite(s.id))}}));function ye({note:t}){return e.jsxs("div",{className:"note-stars",children:[e.jsx("div",{className:"icon first "+(t>=1?"full":t<=0?"vide":"half")}),e.jsx("div",{className:"icon "+(t>=2?"full":t<=1?"vide":"half")}),e.jsx("div",{className:"icon "+(t>=3?"full":t<=2?"vide":"half")}),e.jsx("div",{className:"icon "+(t>=4?"full":t<=3?"vide":"half")}),e.jsx("div",{className:"icon "+(t>=5?"full":t<=4?"vide":"half")})]})}const fe=ee(t=>({comments:void 0,index:void 0,lastPage:void 0,setLastPage(a){t(()=>({lastPage:a}))},setIndex(a){t(()=>({index:a}))},userComment:void 0,async getCommentIndex(a){const s=new URLSearchParams({});for(const c in a){const r=a[c];r!=null&&s.set(c,r)}return await(await fetch(`${E}/get_comment_index/?${s}`)).json()},async sendCommentResponse(a){const s=b.getState().getHeaders();if(!s)return;const n=new FormData;n.append("product_comment_id",a.comment_id.toString()),n.append("response",a.response);const c=await(await fetch(`${E}/set_product_comment_response`,{method:"PUT",body:n,headers:s.headers})).json();if(c!=null&&c.id)return t(({comments:r})=>({comments:r&&{...r,list:r.list.map(o=>o.id==a.comment_id?c:o)}})),c},async fetcheditCommentText(a){const s=b.getState().getHeaders();if(!s)return;const n=new FormData;n.append("product_comment_id",a.comment_id.toString()),n.append("text",a.text);const c=await(await fetch(`${E}/edit_product_comment_text`,{method:"PUT",body:n,headers:s.headers})).json();if(c!=null&&c.id)return t(({comments:r})=>({comments:r&&{...r,list:r.list.map(o=>o.id==a.comment_id?c:o)}})),c},async deleteComment(a,s){const n=b.getState().getHeaders();if(!n)return;const c=await(await fetch(`${E}/delete_product_comment/${a.id}`,{method:"DELETE",headers:n.headers})).json();if(c!=null&&c.deleted)return s&&setTimeout(()=>{t(({comments:r})=>({comments:r&&{...r,list:r.list.filter(o=>o.id!=a.id)}}))},s),c},async fetchProductComments(a){if(!b.getState().store)return;const n=new URLSearchParams({});for(const r in a){const o=a[r];n.set(r,o)}const c=await(await fetch(`${E}/get_product_comments/?${n.toString()}`)).json();return a!=null&&a.no_save||t(()=>({comments:c})),c},async fetchUserComment(){},async create_product_comment(a){const s=b.getState().getHeaders();if(!s)return;const n=new FormData;n.append("product_id",a.product_id),n.append("note",a.note+""),n.append("text",a.text);for(let r=0;r<a.photos.length;r++)n.append("photos_"+r,a.photos[r]);for(let r=0;r<a.videos.length;r++)n.append("videos_"+r,a.videos[r]);console.log(a);const c=await(await fetch(`${E}/create_product_comment`,{method:"POST",body:n,headers:s.headers})).json();if(c!=null&&c.id)return c}}));function xe({comment:t,canOpen:a,onClick:s}){var k,W;const[n,l]=x.useState(!1),[c,r]=x.useState(!1),{userStore:o,manager:i}=b(),{deleteComment:d,sendCommentResponse:m,fetcheditCommentText:h}=fe(),v=(i==null?void 0:i.type.toLocaleLowerCase())=="collaborator"||(i==null?void 0:i.type.toLocaleLowerCase())=="owner",[u,g]=x.useState(0),[y,N]=x.useState(!1),[A,S]=x.useState(!1),[R,D]=x.useState(t.text||""),[p,j]=x.useState(t.response||""),F=(o==null?void 0:o.user_id)==t.user_id,[B,V]=x.useState(null);return e.jsxs("div",{ref:V,className:"product-comment",onClick:()=>{s==null||s(),r(!1)},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"photo",style:{background:t.user?U(t.user.photos[0]):""},children:e.jsx("span",{style:{background:(k=t.user)!=null&&k.country_icon?U(t.user.country_icon):""}})}),e.jsxs("div",{className:"coment-right",children:[e.jsxs("div",{className:"flex",style:{flexWrap:"nowrap"},children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"name",children:(W=t.user)==null?void 0:W.name}),e.jsx(ye,{note:t.note})]}),(F||v)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"option",onClick:_=>{_.preventDefault(),_.stopPropagation(),r(!c)}}),e.jsxs("div",{className:"ctn-option "+(c?"open":""),onClick:()=>{r(!1)},children:[e.jsx("div",{className:"close",onClick:()=>{r(!1)}}),F&&e.jsx("div",{className:"edit-comment",onClick:()=>{N(!0),S(!1)},children:"Edit Comment"}),v&&e.jsx("div",{className:"edit-response",onClick:()=>{S(!0),N(!1)},children:t.response?"Edit Response":"Add Response"}),e.jsx("div",{className:"delete",onClick:()=>{d(t,300).then(_=>{_!=null&&_.deleted&&(B==null||B.classList.add("deleted"),setTimeout(()=>{B&&(B.style.display="none")},300))})},children:"Delete"})]})]})]}),e.jsx("div",{className:"date",children:new Date(t.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),e.jsx("div",{className:"message",children:y?e.jsxs("label",{htmlFor:"edit-comment-"+t.id,children:[e.jsx("input",{id:"edit-comment-"+t.id,type:"text",value:R,placeholder:"Edit Comment",onChange:_=>{D(_.currentTarget.value)}}),e.jsx("span",{onClick:()=>{S(!1),N(!1),h({comment_id:t.id,text:R}).then(_=>{_!=null&&_.id&&(t.text=_.text,g(u+1))})}})]}):t.text})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),a&&(t.photos_count>0||t.videos_count>0)&&e.jsxs("div",{className:"files-ctn",children:[t.photos.map((_,w)=>e.jsx("div",{style:{background:U(_)+",#4544"},onClick:L=>{L.preventDefault(),L.stopPropagation(),s==null||s({comment:t,relative:w})}},_)),t.videos.map((_,w)=>e.jsx("div",{onClick:L=>{L.preventDefault(),L.stopPropagation(),s==null||s({comment:t,relative:t.photos.length+w})},children:e.jsx("video",{width:60,height:60,src:`${E}${_}`})},_))]})]}),(a&&t.response||A)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"open-response "+(n||A?"open":""),onClick:()=>{l(!n),S(!1),N(!1)},children:[t.response?"Open response":"Add Response",e.jsx("span",{})]}),e.jsx("div",{className:"response "+(n||A?"open":""),children:A?e.jsxs("label",{htmlFor:"edit-response-"+t.id,children:[e.jsx("input",{id:"edit-response-"+t.id,type:"text",value:p,placeholder:"Edit Response",onChange:_=>{j(_.currentTarget.value)}}),e.jsx("span",{onClick:()=>{S(!1),l(!0),m({comment_id:t.id,response:p}).then(_=>{_!=null&&_.id&&(t.response=_.response,g(u+1))})}})]}):t.response})]})]})}function te({posistion:t,size:a,top:s,step:n}){return l=>{if(!l||l.dataset.init)return;l.dataset.init="init",l.style.scrollBehavior="smooth";const c=l.parentElement,r=document.createElement("div");r.style.width=l.style.width,r.style.position="relative",r.append(l),c.append(r);const o=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div");i.className="h-scroll-icon-ctn right",o.className="h-scroll-icon-ctn",a&&(i.style.width=`${a}px`,i.style.height=`${a}px`,o.style.width=`${a}px`,o.style.height=`${a}px`),t&&(i.style.right=`${-t}px`,o.style.left=`${-t}px`),s&&(i.style.top=`${s}px`,o.style.top=`${s}px`),m.className="h-scroll-icon right",d.className="h-scroll-icon",i.append(m),o.append(d),m.style.filter=$("#123").result.filter,d.style.filter=$("#123").result.filter,r.append(i,o);const h=()=>{l.scrollLeft<=0?o.style.display="none":o.style.display="block",l.scrollLeft>=l.scrollWidth-l.getBoundingClientRect().width-30?i.style.display="none":i.style.display="block"};o.addEventListener("click",()=>{n?l.scrollLeft-=n:l.scrollLeft-=l.getBoundingClientRect().width/2}),i.addEventListener("click",()=>{n?l.scrollLeft+=n:l.scrollLeft+=l.getBoundingClientRect().width/2}),l.addEventListener("scroll",h),setTimeout(()=>{h()},500)}}function Ie({product:t,setRef:a,userCommand:s,ImageComments:n,onRefresh:l}){const{userComment:c,comments:r,create_product_comment:o,fetchProductComments:i,setIndex:d}=fe(),{openChild:m}=se(),{user:h}=b(),{navBack:v,qs:u,current:g,json:y}=H(),[N,A]=x.useState([]),[S,R]=x.useState([]),[D,p]=x.useState(""),[j,F]=x.useState(0),[B,V]=x.useState(!1),[k,W]=x.useState(),[_,w]=x.useState(!1),[L,Y]=x.useState({order_by:"created_at_desc",order_text:"Date",with_photo:!1,with_video:!1,limit:20,page:1}),[ae,re]=x.useState(!1);return x.useEffect(()=>{i({product_id:t.id,...L})},[k,t,L,y]),g("comments")&&e.jsxs("section",{className:"page-comments "+(g("comments")?"open":"close"),ref:a,children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"return",onClick:()=>{v()}}),e.jsx("h1",{children:"Comments"}),e.jsx("div",{className:"option"})]}),e.jsx(Te,{images:n==null?void 0:n.images,more:n==null?void 0:n.more,product:t,onClick:()=>u().keepJson().setAbsPath(["products","detail","images"])}),e.jsxs("div",{className:"write-comment",children:[e.jsxs("div",{className:"top-prompt",children:[" Leave a comment ",e.jsx("span",{})]}),k?e.jsx("div",{children:"Thank you for the comment."}):c?e.jsxs("div",{children:["You have already commented on this product ",e.jsx("span",{onClick:()=>V(!0),children:" see my comment"})]}):s!=null&&s.payment_id?e.jsxs("div",{className:"zone-inputs",children:[e.jsxs("div",{className:"user-rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"icon "+(j>=1?"star":""),onClick:()=>F(1)}),e.jsx("div",{className:"icon "+(j>=2?"star":""),onClick:()=>F(2)}),e.jsx("div",{className:"icon "+(j>=3?"star":""),onClick:()=>F(3)}),e.jsx("div",{className:"icon "+(j>=4?"star":""),onClick:()=>F(4)}),e.jsx("div",{className:"icon "+(j==5?"star":""),onClick:()=>F(5)})]}),e.jsx("div",{className:"value",children:j})]}),!!j&&e.jsxs("label",{htmlFor:"comment-input-text",className:"input-text",children:[e.jsx("input",{id:"comment-input-text",autoFocus:!0,type:"text",value:D,placeholder:"Write Comment",onChange:P=>{p(P.target.value.substring(0,200))}}),e.jsxs("div",{className:"div",children:[D.length,"/200"]})]}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-photo",id:"comment-photo",accept:"image/*",onChange:P=>{if(P.target.files){for(const O of P.target.files)N.unshift(O);A([...N].slice(0,5))}}}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-video",id:"comment-video",accept:"video/*",onChange:P=>{if(P.target.files){for(const O of P.target.files)S.unshift(O);R([...S].slice(0,2))}}}),e.jsxs("div",{className:"files-ctn",style:{display:j&&D?"flex":"none"},children:[e.jsxs("div",{className:"photo-ctn",children:[e.jsxs("label",{htmlFor:"comment-photo",className:"photo",children:[e.jsx("span",{}),"Photo ",N.length,"/5"]}),e.jsx("div",{className:"files-photo",children:N.map(P=>e.jsx("div",{style:{background:U(URL.createObjectURL(P))},children:e.jsx("span",{onClick:()=>{A(N.filter(O=>O!=P))}})},P.name))})]}),e.jsxs("div",{className:"video-ctn",children:[e.jsxs("label",{htmlFor:"comment-video",className:"photo",children:[e.jsx("span",{}),"Video ",S.length,"/2"]}),e.jsx("div",{className:"files-video",children:S.map(P=>e.jsxs("div",{children:[e.jsx("video",{width:80,height:80,src:URL.createObjectURL(P)}),e.jsx("span",{onClick:()=>{R(S.filter(O=>O!=P))}})]},P.name))})]})]}),e.jsxs("div",{className:"send-comment "+(_?"loading":""),children:[e.jsx("span",{className:"text "+(D.trim()?"":"no"),onClick:()=>{if(!h)return m(e.jsx(ie,{}),!1,"#3455");j&&D&&(w(!0),o({note:j,photos:N,product_id:t.id,text:D,videos:S}).then(P=>{w(!1),P!=null&&P.id&&(W(P),l==null||l())}))},children:"Send"})," ",e.jsx("span",{className:"loading"})]})]}):e.jsx("div",{children:"Comments are allowed after purchasing the product"})]}),e.jsx("div",{className:"my-comment",children:c&&e.jsx(xe,{comment:c,canOpen:!0})}),e.jsxs("div",{className:"filter",children:[e.jsxs("div",{className:"date active",onClick:()=>{re(!ae)},children:[L.order_text,e.jsx("span",{className:L.order_by.includes("desc")?"desc":""}),e.jsxs("div",{className:ae?"open":"",children:[e.jsxs("div",{onClick:()=>Y({...L,order_by:"created_at_desc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>Y({...L,order_by:"created_at_asc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:""})]}),e.jsxs("div",{onClick:()=>Y({...L,order_by:"note_desc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>Y({...L,order_by:"note_asc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:""})]})]})]}),e.jsx("div",{className:"photo "+(L.with_photo?"active":""),onClick:()=>Y({...L,with_photo:!L.with_photo}),children:"With Photo"}),e.jsx("div",{className:"video "+(L.with_video?"active":""),onClick:()=>Y({...L,with_video:!L.with_video}),children:"With Video"})]}),e.jsx("div",{className:"comments",children:r==null?void 0:r.list.map(P=>e.jsx(xe,{comment:P,canOpen:!0,onClick:O=>{const de=O==null?void 0:O.comment;de&&(u().keepJson().setAbsPath(["products","detail","images"]),d({comment:de,relative:O.relative}))}},P.id))})]})}function Ge({product:t}){var p,j,F,B,V;const{current:a,navBack:s,pathList:n}=H(),{getCommentIndex:l,index:c,setIndex:r}=fe(),[o,i]=x.useState(null),[d,m]=x.useState((c==null?void 0:c.relative)||0),[h,v]=x.useState(),[u]=x.useState({}),[g,y]=x.useState(!1),[N,A]=x.useState({move:"",comment_id:c==null?void 0:c.comment.id});x.useEffect(()=>{a("images")&&t&&l({product_id:t.id,comment_id:N.comment_id||(c==null?void 0:c.comment.id),move:N.move||void 0}).then(k=>{var W;if(console.log({res:k}),(W=k==null?void 0:k.comment)!=null&&W.id){if(N.move=="back")m(k.comment.photos_count+k.comment.videos_count-1);else if(N.move=="next")m(0);else{let _=((c==null?void 0:c.relative)??d)||0;const w=k.comment.photos_count+k.comment.videos_count;_=_<=0?0:_>=w-1?w-1:_,m(_)}N.move="",N.comment_id=void 0,v(k)}})},[N,c,n]),x.useEffect(()=>{a("images")&&(A({comment_id:void 0,move:""}),v(void 0),console.log({commentIndex:h}))},[t,n]),x.useEffect(()=>{u.init||(u.init=!0,window.addEventListener("keyup",k=>{k.code=="ArrowRight"?u.moveNext():k.code=="ArrowLeft"&&u.moveBack()}))},[]);const S=()=>{d<=0?(console.log("back comment "),h&&A({...N,comment_id:h.comment.id,move:"back"})):(console.log("back image "),m(d-1))},R=()=>{d>=D.length-1?(console.log("next comment "),h&&A({...N,comment_id:h.comment.id,move:"next"})):(console.log("next image "),m(d+1))};u.moveNext=R,u.moveBack=S;const D=[...((p=h==null?void 0:h.comment)==null?void 0:p.photos)||[],...((j=h==null?void 0:h.comment)==null?void 0:j.videos)||[]];return a("images")&&!(h!=null&&h.comment)?e.jsxs("div",{className:"image-not-found",children:[e.jsx("p",{className:"text",children:"no images or videos found for this product."}),e.jsxs("div",{onClick:()=>s(),children:[e.jsx("span",{}),"go back"]})]}):a("images")&&(h==null?void 0:h.comment)&&e.jsxs("section",{className:"page-comment-image "+(a("images")?"open":"close"),children:[e.jsxs("div",{className:"page-top",children:[e.jsx("div",{className:"return",style:{filter:$("#fff").result.filter},onClick:()=>s()}),e.jsxs("div",{className:"count",children:[((h==null?void 0:h.befor)||0)+d," / ",(h==null?void 0:h.total)||0]})]}),e.jsxs("div",{className:"file-view _flex _center",children:[d>(((F=h==null?void 0:h.comment)==null?void 0:F.photos_count)||0)-1?e.jsx("div",{className:"video _flex",ref:k=>{if(!k||k.dataset.init)return;k.dataset.init="init",i(k);const W=()=>{const _=k.querySelector("video"),w=k.getBoundingClientRect();_.width=w.width};window.addEventListener("resize",W)},children:e.jsx("video",{loop:!0,autoPlay:!0,controls:!0,width:o==null?void 0:o.getBoundingClientRect().width,src:`${E}${D[d]}`})}):e.jsx("div",{className:"photo",children:e.jsx("div",{className:"img",style:{background:U(D[d],"100%")}})}),e.jsx("div",{className:"move-next",onClick:R,children:e.jsx("div",{className:"next",children:e.jsx("span",{})})}),e.jsx("div",{className:"move-back",onClick:S,children:e.jsx("div",{className:"back",children:e.jsx("span",{})})})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"top _flex _wrap",children:[e.jsx("div",{className:"name",children:ce(((B=h==null?void 0:h.comment.user)==null?void 0:B.name)||"",50)}),e.jsxs("div",{className:"_flex  _l-auto",children:[e.jsx(ye,{note:((V=h==null?void 0:h.comment)==null?void 0:V.note)||0}),e.jsx("div",{className:"open",onClick:()=>y(!0),children:"Open"})]})]}),e.jsx("div",{className:"message",children:ce((h==null?void 0:h.comment.text)||"",100)}),e.jsxs("div",{className:"preview-comment "+(g?"open":"close"),children:[e.jsx("div",{className:"close",onClick:()=>{y(!1)}}),e.jsx(xe,{comment:h.comment,canOpen:!0,onClick:k=>{const W=k==null?void 0:k.comment;W&&r({comment:W,relative:k.relative})}})]})]})]})}function _e({mode:t}){const{pathList:a,qs:s}=H(),{visites:n,fetchVisites:l,setVisites:c,fetchProducts:r}=oe(),{openChild:o}=se(),{user:i}=b(),d=m=>{r({product_id:m.id,no_save:!0}).then(h=>{if(h!=null&&h.list[0].id){const v={...h==null?void 0:h.list[0]};c({...n,list:n==null?void 0:n.list.map(u=>u.id==v.id?v:u)})}})};return x.useEffect(()=>{!n&&i&&l({})},[i,a]),e.jsxs("div",{className:"comp-visites "+(t||"h"),children:[e.jsxs("h1",{className:"title",children:["Products Visited",e.jsx("span",{})]}),e.jsxs("div",{className:"list",ref:te({posistion:20}),children:[!i&&e.jsx("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>o(e.jsx(ie,{}),!0,"#fffc"),children:"Connexion required"}),n==null?void 0:n.list.map(m=>e.jsx(ge,{aspect:t=="v"?1.4:void 0,mode:"inlist",product:m,onClick:()=>{s({product_id:m.id}).setAbsPath(["products","detail"])},onRefresh:h=>{d(h)}},m.id))]})]})}function Ce({mode:t}){const{qs:a}=H(),{product:s,fetchProducts:n}=oe(),{store:l}=b(),[c,r]=x.useState();x.useEffect(()=>{n({no_save:!0,category_id:s==null?void 0:s.category_id}).then(i=>{i!=null&&i.list&&r(i)})},[s,l]);const o=i=>{c&&n({product_id:i.id,no_save:!0,lol:!0}).then(d=>{if(d!=null&&d.list[0].id){const m={...d==null?void 0:d.list[0]};c&&r({...c,list:c.list.map(h=>h.id==m.id?m:h)})}})};return e.jsxs("div",{className:"more-products "+(t||"h"),children:[e.jsxs("h1",{className:"title more",children:["More Products",e.jsx("span",{})]}),e.jsx("div",{className:"list",ref:te({posistion:20}),children:c==null?void 0:c.list.map(i=>e.jsx(ge,{aspect:t=="v"?1.4:void 0,mode:"inlist",product:i,active:(s==null?void 0:s.id)==i.id,onClick:()=>{a({product_id:i.id}).setAbsPath(["products","detail"])},onRefresh:d=>{o(d)}},i.id))})]})}let z;function Xe({onRefresh:t}){var we,ke,Se,Pe;const{json:a,qs:s,check:n,current:l,navBack:c,pathList:r}=H(),{setProductById:o,product:i,selectProduct:d,products:m,fetchProducts:h,setProducts:v}=oe(),{fetchProductComments:u,setLastPage:g}=fe(),{addProductToCart:y,carts:N,fetchCarts:A}=X(),{user:S}=b(),{openChild:R}=se(),D=x.useRef(null),p=x.useRef(null),j=x.useRef(null),[F,B]=x.useState(!0),[V,k]=x.useState(0),[W,_]=x.useState(!1),[w,L]=x.useState(),[Y,ae]=x.useState(!1),[re]=x.useState(),[P]=x.useState({payment_id:"lol"}),[O,de]=x.useState(null),[J,Re]=x.useState(),[Q,De]=x.useState(),[I]=x.useState({}),[me]=x.useState({current:null}),he=()=>{if(!me.current)return;const f=me.current.getBoundingClientRect(),C=me.current.querySelectorAll(".img");let q=f.width-60;q=q>400?400:q;for(const T of C)T.style.height=`${q/1.295}px`,T.style.width=`${q}px`,T.style.minWidth=`${q}px`};he(),x.useEffect(()=>{n("detail")&&(a!=null&&a.product_id)&&a.product_id!=I.product_id&&(I.product_id=a.product_id,o({json:a}))},[a]),x.useEffect(()=>{i&&n("detail")&&(j.current&&(j.current.scrollTop=0),_(!1),k(0),z==null||z(0))},[i]),x.useEffect(()=>{var f,C,q;if(i&&n("detail"))if(console.log("new Comments fech"),u({product_id:i.id,no_save:!0,limit:4}).then(T=>Re(T)),u({product_id:i.id,no_save:!0,with_photo:!0,limit:5}).then(T=>{const M=T==null?void 0:T.list.map(G=>G.photos).flat();return De({images:(M==null?void 0:M.slice(0,5))||[],more:((M==null?void 0:M.length)||0)>5})}),(f=I.carts)!=null&&f.list){console.log("dans la list existant",(C=I.carts)==null?void 0:C.list);const T=I.carts.list.find(M=>{var G;return M.product_id==((G=I.product)==null?void 0:G.id)});T&&((q=I.product.featuresCollector)==null||q.setAll(T.collected_features))}else A({}).then(T=>{var M;if(console.log("dans la new  list"),T!=null&&T.list){const G=I.carts.list.find(ue=>{var ne;return ue.product_id==((ne=I.product)==null?void 0:ne.id)});G&&((M=I.product.featuresCollector)==null||M.setAll(G.collected_features))}})},[i,r]),x.useEffect(()=>(window.addEventListener("resize",he),setTimeout(()=>{he()},1e3),()=>{window.removeEventListener("resize",he)}),[]),x.useEffect(()=>{if(O){if(O.dataset.init)return;O.dataset.init="init",O.addEventListener("scroll",()=>{O.scrollTop>200?ae(!0):ae(!1)})}},[O]),I.product=i,I.carts=N;const be=()=>{i&&h({add_cart:!0,product_id:i.id,is_features_required:!0,no_save:!0}).then(f=>{if(f!=null&&f.list[0].id){const C={...f==null?void 0:f.list[0]};m&&v({...m,list:m==null?void 0:m.list.map(q=>q.id==C.id?C:q)}),(i==null?void 0:i.id)==C.id&&d(C)}})};return i&&e.jsxs("div",{className:"detail-product "+(i?"open":""),children:[i&&e.jsx(Ie,{onRefresh:t,ImageComments:Q,userComment:re,userCommand:P,setRef:de,product:i}),i&&e.jsx(Ge,{product:i}),e.jsxs("section",{className:"detail "+(l("products")||l("detail")?"open":"close"),ref:j,children:[e.jsxs("div",{className:"top-top _flex",children:[e.jsx("div",{className:"return",ref:f=>{if(!f||f.dataset.init)return;f.dataset.init="init";const C=()=>{window.innerWidth>940?f.style.display=" none":f.style.display="flex"};window.addEventListener("resize",C),C()},onClick:()=>{d(void 0),c()}}),e.jsx("div",{className:"label _lr-auto",children:"Detail Product"}),e.jsx("div",{className:"cart",onClick:()=>{s().setAbsPath(["cart"])}})]}),e.jsxs("div",{className:"top-infos",ref:f=>{if(!f||f.dataset.init)return;f.dataset.init="init";const C=f.querySelector(".images"),q=f.querySelector(".infos"),T=()=>{f.getBoundingClientRect().width<700?(f.style.flexWrap="wrap",C.style.width="",C.style.minWidth="",C.style.maxWidth="",q.style.width="",q.style.minWidth="",q.style.maxWidth=""):(f.style.flexWrap="",C.style.width="50%",C.style.minWidth="50%",C.style.maxWidth="50%",q.style.width="50%",q.style.minWidth="50%",q.style.maxWidth="50%")};window.addEventListener("resize",T),setTimeout(()=>{T(),z==null||z(0)},200)},children:[e.jsxs("div",{className:"images",children:[e.jsxs("div",{className:"list",ref:f=>{qe(C=>{z=C},k)(f),me.current=f},children:[e.jsx("div",{className:"gap"}),i==null?void 0:i.images.map((f,C)=>e.jsx("div",{className:"img card-h-c "+(V==C?"active":""),style:{background:U(f)},onClick:()=>{z==null||z(C),k(C)}},f+(i==null?void 0:i.id))),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"min-list",children:i==null?void 0:i.images.map((f,C)=>e.jsx("div",{className:"min-img "+(V==C?"active":""),style:{background:U(f)},onClick:()=>{k(C),z==null||z(C)}},f+(i==null?void 0:i.id)))})]}),e.jsx("div",{className:"infos",ref:D,children:e.jsxs("div",{className:"diff",ref:p,children:[e.jsxs("div",{className:"text "+(w&&F?"min":""),children:[e.jsxs("div",{className:"title",children:[i==null?void 0:i.title,e.jsx("span",{})]}),e.jsx("p",{className:"description",children:((i==null?void 0:i.description.length)||0)>100&&!W?e.jsxs(e.Fragment,{children:[ce((i==null?void 0:i.description)||"",100)," ",e.jsx("span",{onClick:()=>_(!0),children:"Read more"})]}):(i==null?void 0:i.description)||""})]}),(i==null?void 0:i.features)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"label-features",children:["Features",e.jsxs("span",{children:[" ",(w==null?void 0:w.name)&&" : "+(w==null?void 0:w.name)]})," ",w&&e.jsx("span",{className:"close",style:{filter:((we=$("#112233"))==null?void 0:we.result.filter)||""},onClick:()=>{L(void 0)}})]}),e.jsx("div",{className:"lol",children:e.jsx("div",{className:"features",ref:te({posistion:20}),children:i==null?void 0:i.features.list.map(f=>e.jsxs("div",{className:"feature "+((w==null?void 0:w.id)==f.id?"active":""),onClick:()=>{var C,q;if(!w){const T=((C=D.current)==null?void 0:C.getBoundingClientRect().height)||0,M=((q=p.current)==null?void 0:q.getBoundingClientRect().height)||0;T-M<150?B(!0):B(!1)}(w==null?void 0:w.id)==f.id?L(void 0):L(f)},children:[e.jsx("div",{className:"icon",style:{background:U(f.icon[0])}}),e.jsx("div",{className:"label",children:ce(f.name,10)})]},f.id))})})]}),w&&e.jsxs("div",{className:"label-components",children:["Components: ",e.jsx("span",{children:(Se=(ke=i==null?void 0:i.featuresCollector)==null?void 0:ke.allCollectedFeatures()[w.id])==null?void 0:Se.name})]}),e.jsx("div",{className:"lol "+(w?"open":""),children:e.jsx("div",{className:"components "+(w?"open":""),ref:te({posistion:20}),children:(Pe=w==null?void 0:w.components)==null?void 0:Pe.map(f=>{var C,q,T;return e.jsxs("div",{className:"component "+(((q=(C=i==null?void 0:i.featuresCollector)==null?void 0:C.allCollectedFeatures()[w.name])==null?void 0:q.id)==f.id?"active":""),onClick:()=>{var M,G,ue,ne,Ee;if(((G=(M=i==null?void 0:i.featuresCollector)==null?void 0:M.allCollectedFeatures()[w.name])==null?void 0:G.id)==f.id?(ue=i==null?void 0:i.featuresCollector)==null||ue.collectFeature(w,void 0):(ne=i==null?void 0:i.featuresCollector)==null||ne.collectFeature(w,f),N){let le=N.list.find(K=>K.product_id==i.id);le?y({product_id:i==null?void 0:i.id,command_id:le.id,collected_features:(Ee=i==null?void 0:i.featuresCollector)==null?void 0:Ee.allCollectedFeatures()}):A({}).then(K=>{var $e;K!=null&&K.list&&(le=K==null?void 0:K.list.find(Oe=>Oe.product_id==i.id),le&&y({product_id:i==null?void 0:i.id,command_id:le.id,collected_features:($e=i==null?void 0:i.featuresCollector)==null?void 0:$e.allCollectedFeatures()}))})}},children:[e.jsx("div",{className:"icon",style:{background:((T=f.images)==null?void 0:T[0])&&U(f.images[0],"cover")}}),e.jsx("div",{className:"label",children:ce(f.name,10)})]},f.id)})})})]})})]}),e.jsxs("div",{className:"detail-box",children:[e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"title",children:["product reviews",e.jsx("span",{})]}),i&&e.jsx(Te,{images:Q==null?void 0:Q.images,more:Q==null?void 0:Q.more,onClick:()=>{g(""),s().keepJson().setAbsPath(["products","detail","images"])},product:i}),e.jsxs("div",{className:"title",children:["Comments",e.jsx("span",{})]}),e.jsxs("div",{className:"min-comments",ref:te({posistion:20}),children:[J==null?void 0:J.list.map(f=>e.jsx(xe,{comment:f,onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])}},f.id)),e.jsxs("div",{className:"more-comment "+(J!=null&&J.list.length||0>0?"":"horizontal"),onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])},children:[e.jsx("div",{className:"icon "+(J!=null&&J.list.length||0>0?"":"add"),children:e.jsx("span",{style:{filter:$("#ffffff").result.filter}})}),e.jsx("div",{className:"label",children:J!=null&&J.list.length||0>0?"More":"Add First Comment"})]})]})]}),e.jsx(_e,{}),e.jsx(Ce,{})]})]}),(l("detail")||l("products"))&&e.jsx("div",{className:"price-zone",children:e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"price",children:[e.jsx("div",{children:"Price"}),e.jsxs("div",{className:"value",children:[(i==null?void 0:i.price)||0," $"]})]}),i.quantity!=null&&i.quantity!=null&&parseInt(i.quantity+"")!=0&&i.quantity.toString()!="0"?e.jsxs(e.Fragment,{children:[e.jsx(ve,{canNull:!0,product:i,onChange:()=>{be()}}),e.jsxs("div",{className:"buy",onClick:()=>{s().setAbsPath(["cart"])},children:["BUY ",e.jsx("span",{})]})]}):e.jsxs("div",{className:"add-to-cart",onClick:()=>{var f;return S?y({product_id:i.id,quantity:1,collected_features:{...(f=i.featuresCollector)==null?void 0:f.allCollectedFeatures()}}).then(C=>{C!=null&&C.id&&be()}):R(e.jsx(ie,{}),!1,"#3455")},children:["Add ",e.jsx("span",{children:" to cart"})]})]})}),l("comments")&&(Y||(P==null?void 0:P.payment_id)&&!re)&&e.jsxs("div",{className:"write-zone",children:[Y&&e.jsx("div",{className:"up-icon",onClick:()=>{O&&(O.scrollTop=0)},children:e.jsx("span",{})}),e.jsx("div",{className:"write-icon",children:e.jsx("span",{})})]})]})}function Te({product:t,onClick:a,images:s,more:n}){const{qs:l}=H();return e.jsxs("div",{className:"group-file-rating",children:[e.jsx("div",{className:"after-order",children:e.jsxs("div",{className:"ctn-mini-files",onClick:a,children:[s==null?void 0:s.map((c,r)=>e.jsx("div",{className:"w",children:e.jsx("div",{className:"mini-file",style:{background:U(c)}})},r)),n&&e.jsx("div",{className:"back",style:{background:(s==null?void 0:s[0])&&U(s==null?void 0:s[0])},children:e.jsx("div",{className:"more-files",children:"+ More"})})]})}),(t==null?void 0:t.note)&&e.jsxs("div",{className:"rating",onClick:()=>l().keepJson().setAbsPath(["products","detail","comments"]),children:[e.jsx("div",{className:"note",children:t.note.star}),e.jsx(ye,{note:t.note.star}),e.jsxs("div",{className:"vote",children:[t.note.votes," ",e.jsx("span",{})]})]})]})}const Ye=ee(t=>({categories:void 0,async fetchCategoies(a){const s=b.getState().store;if(!s)return;const n={...a};n.store_id=s.id;const l=new URLSearchParams({});for(const o in n){const i=n[o];l.set(o,i)}const r=await(await fetch(`${E}/get_categories/?${l.toString()}`)).json();if(r!=null&&r.list)return a!=null&&a.no_save||t(()=>({categories:r})),{...r}}}));let pe="";/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?pe="mobile-device":pe="not-mobile-device";document.body.classList.add(pe);const Fe=pe;function Ke(){const{json:t,qs:a,check:s,pathList:n}=H(),{products:l,fetchProducts:c,selectProduct:r,product:o,setProducts:i}=oe(),{store:d}=b(),[m,h]=x.useState({order_by:"date_desc",category_id:"",limit:18,add_cart:!0,lol:!0,is_features_required:!0,price_min:void 0,price_max:void 0,text:"",product_id:""}),{fetchCategoies:v}=Ye(),[u,g]=x.useState(),[y]=x.useState({}),[N,A]=x.useState(!1);x.useEffect(()=>{s("products")&&d&&c({...m}).then(p=>{p!=null&&p.list[0]&&!o&&window.innerWidth>940&&(r(p==null?void 0:p.list[0]),a({...t,product_id:p.list[0].id}).setAbsPath(["products","detail"]))})},[m,d,n]),x.useEffect(()=>{!u&&v({limit:25,no_save:!0}).then(p=>{p!=null&&p.list&&g(p)})},[d]),x.useEffect(()=>{var p;if(t!=null&&t.product_id){const j=(p=y.products)==null?void 0:p.list.find(F=>F.id==t.product_id);j&&r(j)}s("products")&&We(m,t||{})&&h({...m})},[t]),x.useEffect(()=>{window.addEventListener("resize",()=>{var p;window.innerWidth>940&&!y.product&&r((p=y.products)==null?void 0:p.list[0])})},[]),y.product=o,y.products=l,y.pathList=n;const[S,R]=x.useState("");x.useEffect(()=>{window.addEventListener("resize",()=>{R(`${window.innerWidth} / ${window.innerHeight}  / ${window.screen.height} => ${Fe}`)}),R(`${window.innerWidth} / ${window.innerHeight} / ${window.devicePixelRatio}  => ${Fe}`)},[]);const D=p=>{y.products&&c({add_cart:!0,product_id:p.id,no_save:!0,lol:!0,is_features_required:!0}).then(j=>{var F;if(j!=null&&j.list[0].id){const B={...j==null?void 0:j.list[0]};console.log(B),y.products&&i({...y.products,list:y.products.list.map(V=>V.id==B.id?B:V)}),((F=y.product)==null?void 0:F.id)==B.id&&r(B)}})};return s("products")&&e.jsxs("div",{className:"page-products",children:[e.jsx("div",{className:"left "+(N?"open":"")+" "+(s("detail")&&o?"product-detail":""),onClick:()=>{A(!1)},children:e.jsxs("div",{className:"filter-fram",children:[e.jsx("div",{className:"top",children:"Filter"}),e.jsx("div",{className:"categories",children:u==null?void 0:u.list.map(p=>e.jsx("div",{className:"category",onClick:()=>h({...m,category_id:p.id}),children:p.label},p.id))}),e.jsxs("div",{className:"prices",children:[e.jsxs("div",{className:"ctn",children:[e.jsx("label",{htmlFor:"product-price-min",children:e.jsx("input",{type:"text",id:"product-price-min",placeholder:"Min",value:m.price_min})}),e.jsx("label",{htmlFor:"product-price-max",children:e.jsx("input",{type:"text",id:"product-price-max",placeholder:"Max",value:m.price_max})})]}),e.jsx("div",{className:"set-price",children:e.jsx("div",{className:"btn",children:"Set Price"})})]})]})}),e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"search-zone",children:[e.jsxs("label",{htmlFor:"product-search",className:"search",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{id:"product-search",type:"text",placeholder:"Search Product",value:m.text,onChange:p=>{h({...m,text:p.currentTarget.value})}}),e.jsx("div",{className:"clear",onClick:()=>{h({...m,text:""})}})]}),e.jsx("div",{className:"search-text",children:m.text&&e.jsxs(e.Fragment,{children:['Search result for "',e.jsx("span",{children:m.text}),'"']})}),e.jsxs("div",{className:"sort",children:[e.jsx("div",{className:"label",onClick:()=>{A(!0)},children:"Sort"}),e.jsx("div",{className:"list",children:["date","name","price","popular"].map(p=>{var j;return e.jsx("div",{className:((j=(t==null?void 0:t.order_by)||m.order_by)==null?void 0:j.split("_")[0])==p?"active":"",onClick:()=>{a({...t,order_by:p+"_desc"}).apply()},children:p},p)})})]})]}),e.jsx("div",{className:"list",children:l==null?void 0:l.list.map(p=>e.jsx(ge,{canAddToCart:p.title.includes("321"),product:p,active:(o==null?void 0:o.id)==p.id,onClick:()=>{r({...p}),a({...t,product_id:p.id}).setAbsPath(["products","detail"])},onRefresh:j=>{D(j),console.log("onRefresh",j)}},p.id))})]}),e.jsx("div",{className:"right "+(o?"product":"")+" "+(s("detail")?"detail":""),children:e.jsx(Xe,{onRefresh:()=>{o&&D(o)}})})]})}function Ze(){var v;const{setAbsPath:t,pathList:a}=H(),[s,n]=x.useState(a[1]||"home"),[l,c]=x.useState(!1),[r,o]=x.useState(!1),{user:i,getAccess:d}=b(),m=Ue(),h=u=>{t([u]),n(u)};return x.useEffect(()=>{n(a[1]||"home")},[a]),x.useEffect(()=>{window.addEventListener("click",()=>{const u=document.querySelector(".top-bar .more-navs ul");(u==null?void 0:u.className)==""&&o(!1)})},[]),e.jsxs("div",{className:"top-bar",ref:Me(80,".web"),children:[e.jsxs("div",{className:"top-bar-ctn",children:[e.jsx("div",{className:"left",children:e.jsx("a",{href:"#products",className:"logo-ctn",onClick:u=>{u.preventDefault(),u.stopPropagation(),h("products")},children:e.jsx("div",{className:"icon"})})}),e.jsx("ul",{className:"top-bar-center",children:je.map((u,g)=>g*150<m.width-400?e.jsxs("li",{className:s==u.u?"active":"",onClick:()=>{h(u.u)},children:[e.jsx("span",{}),u.n]},g):null)}),e.jsxs("div",{className:"right",children:[e.jsx("div",{className:"ctn-icon",onClick:u=>{u.preventDefault(),u.stopPropagation(),o(!r)},children:e.jsx("div",{className:"icon",style:{filter:$("#345").result.filter}})}),i?e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${(v=i==null?void 0:i.photos[0])!=null&&v.startsWith("/")?E:""}${i==null?void 0:i.photos}),#bbb`},onClick:()=>{h("profile")}}):e.jsx("div",{className:"login",onClick:()=>d(),children:"Se connecter"})]})]}),e.jsx("div",{className:"more-navs",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:e.jsxs("ul",{className:r?"":"close",children:[je.map((u,g)=>g*150>=m.width-400?e.jsxs("li",{className:s==u.u?"active":"",onClick:()=>{h(u.u),o(!r)},children:[e.jsx("span",{}),u.n]},g):null),e.jsxs("li",{className:s=="mode-lite"?"active":"",style:{whiteSpace:"nowrap"},onClick:()=>{c(!l)},children:[e.jsx("span",{}),l?"Lite mode off":"Lite mode on"]})]})})]})}function Qe(){const{check:t,setAbsPath:a}=H();return e.jsx("div",{className:"bottom-nav",children:e.jsx("ul",{children:je.map((s,n)=>e.jsxs("li",{className:s.u+" "+(t(s.u)?"active":""),onClick:()=>a([s.u]),children:[e.jsx("span",{className:"label",children:s.n}),e.jsx("span",{className:"icon "+s.u})]},n))})})}function es(){const{check:t}=H();return t("categories")&&e.jsx("div",{className:"page-categories"})}function ss(){var h;const{pathList:t,check:a,navBack:s}=H(),{user:n}=b(),{favorites:l,fetchFavorites:c,setFavorites:r,deleteFavorite:o}=Ne(),{addProductToCart:i}=X(),[d,m]=x.useState("All");return x.useEffect(()=>{c({add_labels:!0,label:d=="All"?void 0:d})},[n,t,d]),a("favorites")&&(n?e.jsxs("div",{className:"page-favorites",children:[e.jsxs("div",{className:"top-favorites _flex",children:[e.jsx("div",{className:"return",onClick:()=>{s()}}),e.jsx("div",{className:"label _lr-auto",children:"Favorites"})]}),e.jsxs("div",{className:"favorites-ctn",children:[e.jsxs("div",{className:"left",children:[e.jsx("div",{className:"filter-by-label-ctn",children:e.jsxs("div",{className:"filter-by",ref:te({posistion:20}),children:[e.jsx("h4",{children:"labels : "}),e.jsx("span",{className:"label "+(d=="All"?"all":""),onClick:()=>{m("All")},children:"All"}),(h=l==null?void 0:l.labels)==null?void 0:h.map(v=>e.jsx("span",{className:"label",style:{background:d==v?Z(v):"",boxShadow:`${Z(v)} 0px 0px 3px, ${Z(v)} 0px 0px 3px, ${Z(v)} 0px 0px 3px`},onClick:()=>{m(v)},children:v}))]})}),l==null?void 0:l.list.map(v=>e.jsx(ts,{favorite:v,onQuantityChange:()=>{c({favorite_id:v.id}).then(u=>{if(u!=null&&u.list[0]){const g=u==null?void 0:u.list[0];l&&r({...u,list:l.list.map(y=>y.id==v.id?g:y)})}})},addProductToCart:()=>{v.product&&i({product_id:v.product.id,quantity:1}).then(u=>{u!=null&&u.id&&c({favorite_id:v.id}).then(g=>{if(g!=null&&g.list[0]){const y=g==null?void 0:g.list[0];l&&r({...g,list:l.list.map(N=>N.id==v.id?y:N)})}})})},onDelete:()=>{o(v.id)}},v.id))]}),e.jsx("div",{className:"right"})]}),e.jsx(_e,{}),e.jsx(Ce,{})]}):e.jsx("div",{className:"page-favorites",children:e.jsx(ie,{detail:"Google connexion is required to access your favorites"})}))}function ts({favorite:t,onClick:a,changeLabel:s,onDelete:n,onShare:l,onQuantityChange:c,addProductToCart:r}){var d,m,h,v,u,g;const o=t.product,{qs:i}=H();return console.log(t.id,(o==null?void 0:o.quantity)!=null,(o==null?void 0:o.quantity)!=null,parseInt((o==null?void 0:o.quantity)+"")!=0,((d=o==null?void 0:o.quantity)==null?void 0:d.toString())!="0"),o&&e.jsx("div",{className:"favorites-item",onClick:()=>{a==null||a(t),i({product_id:t.product_id}).setAbsPath(["products","detail"])},children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:U(o.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:o.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:o.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((m=o.note)!=null&&m.star?"":"vide")}),e.jsx("div",{className:"note",children:((h=o.note)==null?void 0:h.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((v=o.note)==null?void 0:v.votes)||0}),e.jsx("div",{className:"users"}),!((u=o.note)!=null&&u.star)&&e.jsx("div",{className:"new",children:"New"})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[o.price.toLocaleString()," ","$"]})}),o.quantity!=null&&o.quantity!=null&&parseInt(o.quantity+"")!=0&&((g=o.quantity)==null?void 0:g.toString())!="0"?e.jsx(ve,{canNull:!0,product:o,onChange:y=>{c==null||c(y)}}):e.jsxs("div",{className:"add-btn",onClick:y=>{r(),y.stopPropagation(),y.preventDefault()},children:["Add ",e.jsx("span",{children:" to cart"})]})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},onClick:y=>{y.stopPropagation(),y.preventDefault()},children:[e.jsx("div",{style:{filter:$("#123").result.filter},className:"delete",onClick:()=>{n==null||n(t)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:$("#123").result.filter},className:"share",onClick:()=>l==null?void 0:l(t),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"label",style:{background:Z(t.label)},onClick:y=>{s==null||s(t),y.stopPropagation(),y.preventDefault()},children:[t.label," "]})]})]})]})})}function is(){const{check:t,pathList:a,navBack:s,qs:n}=H(),{visites:l,fetchVisites:c}=oe(),{current:r}=H(),{user:o}=b(),{carts:i,fetchCarts:d,deleteCommand:m,confirmCommand:h}=X(),[v,u]=x.useState(0),[g,y]=x.useState(0),[N,A]=x.useState(0),[S,R]=x.useState((i==null?void 0:i.list.map(p=>p))||[]),[D]=x.useState({});return D.selecteds=S,x.useEffect(()=>{let p=0,j=0;S.forEach(F=>{p+=Number(F.quantity),j+=F.price*F.quantity}),y(j),A(p)},[v,S]),x.useEffect(()=>{R((i==null?void 0:i.list.filter(p=>!!D.selecteds.find(j=>j.id==p.id)))||[])},[i]),x.useEffect(()=>{o&&r("cart")&&d({}).then(p=>{p!=null&&p.list&&R(p.list)}),!l&&o&&r("cart")&&c({})},[o,a]),t("cart")&&(o?e.jsxs("div",{className:"page-cart",children:[e.jsxs("div",{className:"top-cart _flex",children:[e.jsx("div",{className:"return",onClick:()=>{s()}}),e.jsx("div",{className:"label _lr-auto",children:"Cart"})]}),e.jsxs("div",{className:"cart-ctn",children:[e.jsxs("div",{className:"items",children:[e.jsxs("div",{className:"select-all",children:[e.jsx("div",{className:"btn "+(S.length<((i==null?void 0:i.list.length)||0)?"":"select"),onClick:()=>{S.length<((i==null?void 0:i.list.length)||0)?R((i==null?void 0:i.list.map(p=>p))||[]):R([])},children:S.length<((i==null?void 0:i.list.length)||0)?"Select All":"Deselect All"}),e.jsxs("a",{className:"my-command ",onClick:()=>n({page:"command"}).setAbsPath(["profile"]),children:["my orders ",e.jsx("span",{})]})]}),i==null?void 0:i.list.map(p=>e.jsx(as,{selected:!!S.find(j=>j.id==p.id),cart:p,onSelect:j=>{S.find(F=>F.id==j.id)?R(S.filter(F=>F.id!=j.id)):R([...S,j])},onDelete:j=>{m(j.id)},onQuantityChange:()=>{u(v+1)},onLike:()=>{d({}).then(j=>{j!=null&&j.list&&R(j.list)})}},p.id))]}),e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"go-to-checkout",children:[e.jsx("div",{className:"title",onClick:()=>{h({list:S.map(p=>p.id)})},children:"Go to checkout"}),e.jsx("p",{children:"Available delivery methods and times can be selected when placing an order."}),e.jsxs("div",{className:"infos",children:[e.jsxs("div",{className:"count",children:[e.jsx("h2",{children:"Your cart"}),e.jsxs("div",{className:"val",children:[N," products ",e.jsx("span",{})," "]})]}),e.jsxs("div",{children:[e.jsxs("span",{children:["Products (",S.length,")"]}),e.jsxs("span",{className:"initial-price",children:[g.toLocaleString(),"$"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text",children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:"detail",children:["More details ",e.jsx("span",{})]})]}),e.jsxs("span",{className:"discount",children:[0 .toLocaleString(),"$"]})]})]}),e.jsxs("div",{className:"_flex",children:[e.jsx("h1",{children:"total cost"}),e.jsxs("h1",{className:"total",children:[g.toLocaleString(),"$"]})]})]}),e.jsx("div",{className:"cart-cover-image"})]})]}),e.jsx(_e,{mode:"h"}),e.jsx(Ce,{mode:"h"})]}):e.jsx("div",{className:"page-cart",children:e.jsx(ie,{detail:"Google connexion is required to access your cart"})}))}function as({cart:t,selected:a,onClick:s,onSelect:n,onDelete:l,onLike:c,onShare:r,onQuantityChange:o}){return e.jsx("div",{className:"cart-item",onClick:()=>s==null?void 0:s(t),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:U(t.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:t.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:t.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...t.collected_features}).slice(0,2).map(i=>{var d,m,h;return e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:i}),":",e.jsx("span",{className:"v",children:(d=(t.collected_features||{})[i])!=null&&d.name?(m=(t.collected_features||{})[i])==null?void 0:m.name:(h=(t.collected_features||{})[i])==null?void 0:h.toString()})]},i)}),Object.keys({...t.collected_features||{}}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(t.price*t.quantity).toLocaleString()," ","$"]})}),e.jsx(ve,{cart:t,onChange:()=>{o==null||o(t)}})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},children:[e.jsx(Le,{elm:t,onChange:()=>c==null?void 0:c(t)}),e.jsx("div",{style:{filter:$("#123").result.filter},className:"delete",onClick:()=>{l==null||l(t)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:$("#123").result.filter},className:"share",onClick:()=>r==null?void 0:r(t),children:e.jsx("span",{})})]}),e.jsx("div",{className:"check-box "+(a?"selected":""),onClick:()=>n==null?void 0:n(t),children:a?"selected":"not selected"})]})]})]})})}const ns={};function ls(){const{user:t}=b(),{commands:a,fetchCommands:s}=X();return x.useEffect(()=>{t&&s({})},[t]),e.jsx("div",{className:"page-command",children:e.jsx("div",{className:"orders",children:a==null?void 0:a.list.map(n=>e.jsx(cs,{order:n,onShare:()=>{},onClick:()=>{},onChat:()=>{}},n.id))})})}function cs({order:t,onClick:a,onChat:s,onShare:n,onComment:l}){return e.jsx("div",{className:"order-item",onClick:()=>a==null?void 0:a(t),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:U(t.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:t.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:t.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...t.collected_features}).slice(0,2).map(c=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:c}),":",e.jsx("span",{className:"v",children:(t.collected_features||{})[c]})]},c)),Object.keys(t.collected_features||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(t.price*t.quantity).toLocaleString()," ","$"]})}),e.jsx("div",{className:"status",style:{background:ns[t.status]},children:t.status})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",children:[e.jsx("div",{style:{filter:$("#123").result.filter},className:"chat-service",onClick:()=>s==null?void 0:s(t),children:e.jsx("span",{})}),e.jsx("div",{style:{filter:$("#123").result.filter},className:"start-comment",onClick:()=>{l==null||l(t)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:$("#123").result.filter},className:"share",onClick:()=>n==null?void 0:n(t),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"ref-id",onClick:c=>{navigator.clipboard.writeText("#"+t.id.split("-")[0]);const o=c.currentTarget.querySelector("span");o.classList.add("anim-top"),setTimeout(()=>{o.classList.remove("anim-top"),o.classList.add("anim-btm"),setTimeout(()=>{o.classList.remove("anim-btm")},300)},300)},children:["Ref Id : #",t.id.split("-")[0]," ",e.jsx("span",{style:{filter:$("#333").result.filter}})]})]})]})]})})}function os(){const{updateUser:t,user:a}=b(),[s,n]=x.useState({});return x.useEffect(()=>{n({name:a==null?void 0:a.name,address:(a==null?void 0:a.address)||"Yopouon",phone:(a==null?void 0:a.phone)||"+7(999)862-74-41",date:a==null?void 0:a.created_at,money:(a==null?void 0:a.money)||"USD"})},[a]),e.jsxs("div",{className:"page-edit",children:[e.jsx("div",{className:"photo",style:{background:a&&U(a.photos[0])},children:e.jsx("div",{className:"div",children:e.jsx("label",{htmlFor:"new-photo",className:"new-photo",children:e.jsx("input",{style:{display:"none"},type:"file",name:"new-photo",id:"new-photo",onChange:l=>{var c;t({photo:(c=l.currentTarget.files)==null?void 0:c[0]})}})})})}),e.jsxs("div",{className:"infos",children:[e.jsxs("label",{htmlFor:"edit-email",className:"edit-email",children:[e.jsx("div",{className:"prompt",children:"User Email"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-email",type:"text",placeholder:"Edit Name",value:a==null?void 0:a.email})]}),e.jsxs("label",{htmlFor:"edit-name",className:"edit-name",children:[e.jsx("div",{className:"prompt",children:"Name"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-name",type:"text",placeholder:"Edit Name",value:s.name,onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-phone",className:"edit-phone",children:[e.jsx("div",{className:"prompt",children:"Phone"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-phone",type:"text",placeholder:"Search Product",value:s.phone,onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-address",className:"edit-address",children:[e.jsx("div",{className:"prompt",children:"Address"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-address",type:"text",placeholder:"Search Product",value:s.address,onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-date",className:"edit-date",children:[e.jsx("div",{className:"prompt",children:"date of birth"}),e.jsx("div",{className:"icon"}),e.jsx("input",{type:"text",placeholder:"dd-mm-yyyy",value:new Date(s.date).toDateString(),onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("input",{style:{display:"none"},id:"edit-date",type:"date",min:"1997-01-01",max:new Date().toDateString(),placeholder:new Date().toDateString(),onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-devise",className:"edit-devise",children:[e.jsx("div",{className:"prompt",children:"Default Money"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-devise",type:"text",placeholder:"Search Product",value:s.money,onChange:l=>{n({...s,text:l.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]})]})]})}const Ae={edit:"Edit Profile",command:"Orders",messages:"Messages",setting:"Setting"};function rs(){const{check:t,json:a}=H(),{user:s,disconnection:n,getAccess:l}=b(),[c,r]=x.useState(!0),[o,i]=x.useState("");x.useEffect(()=>{t("profile")&&i((a==null?void 0:a.page)||"")},[a]);const d={command:e.jsx(ls,{}),edit:e.jsx(os,{})};return t("profile")&&e.jsxs("div",{className:"page-profile",children:[e.jsx("div",{className:"nav "+(c?"open":"close"),onClick:()=>{r(!1)},children:e.jsxs("div",{className:"nav-ctn",onClick:m=>{m.preventDefault(),m.stopPropagation()},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"close",onClick:()=>{r(!1)}}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"cover-image"}),e.jsx("div",{className:"photo",style:{background:(s==null?void 0:s.photos[0])&&U(s==null?void 0:s.photos[0])}})]}):e.jsxs("div",{className:"login",onClick:()=>{l()},children:[e.jsx("div",{className:"icon",style:{}}),e.jsx("h3",{className:"label",children:"Login"}),e.jsx("span",{className:"next"})]})]}),e.jsx("h1",{className:"name",children:s==null?void 0:s.name}),s&&e.jsx("div",{className:"email _limit-text",children:s==null?void 0:s.email}),e.jsxs("ul",{children:[e.jsxs("li",{className:"edit "+(o=="edit"?"active":"")+" "+(s?"":"hide"),onClick:()=>{r(!1),i("edit")},children:[" ",e.jsx("span",{className:"icon",style:{filter:$("#123").result.filter}}),"Edit Profile",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"command "+(o=="command"?"active":"")+" "+(s?"":"hide"),onClick:()=>{r(!1),i("command")},children:[" ",e.jsx("span",{className:"icon",style:{filter:$("#123").result.filter}}),"My Orders",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"messages "+(o=="messages"?"active":"")+" "+(s?"":"hide"),onClick:()=>{r(!1),i("messages")},children:[" ",e.jsx("span",{className:"icon",style:{filter:$("#123").result.filter}}),"messages",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"setting "+(o=="setting"?"active":"")+" "+(s?"":"hide"),onClick:()=>{r(!1),i("setting")},children:[" ",e.jsx("span",{className:"icon",style:{filter:$("#123").result.filter}}),"setting",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"about "+(o=="about"?"active":""),onClick:()=>{r(!1),i("about")},children:[" ",e.jsx("span",{className:"icon",style:{filter:$("#123").result.filter}}),"about",e.jsx("span",{className:"next"})]})]}),e.jsx("div",{className:"version",children:"By Sublymus Studio v:1.0.1"}),s&&e.jsxs("div",{className:"disconnect",onClick:()=>{n()},children:[e.jsx("span",{className:"icon",style:{filter:$("#c43d4c").result.filter}}),"Log out"]})]})}),e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"title",children:[e.jsx("span",{className:"option-nav",onClick:()=>{r(!0)}}),e.jsxs("h1",{children:[" ",Ae[o]||Ae.edit]})]}),s?d[o]||d.edit:d.about]})]})}function ds(){const{authenticateUser:t}=b(),{openChild:a,currentChild:s,back_color:n,blur:l}=se(),c=x.useRef(null),{pathList:r}=H();return x.useEffect(()=>{a(void 0)},[r]),x.useEffect(()=>{t(),window.addEventListener("blur",()=>{})},[]),e.jsxs("div",{className:"app",style:{width:"100%",height:"100%"},ref:o=>{},children:[s&&e.jsx("div",{className:"child-viewer",onContextMenu:o=>{o.preventDefault(),a(void 0)},children:e.jsx("div",{className:"child-viewer-ctn",style:{background:n},onClick:()=>{a(void 0)},onContextMenu:o=>{o.preventDefault(),a(void 0)},children:s})}),e.jsx(Ze,{}),e.jsxs("div",{ref:c,className:"app-ctn",style:{filter:l?"blur(10px)":""},children:[e.jsx(Ke,{}),e.jsx(es,{}),e.jsx(ss,{}),e.jsx(is,{}),e.jsx(rs,{})]}),e.jsx(Qe,{})]})}const ms=t=>t,ps=ms(e.jsx(He.StrictMode,{children:e.jsx(ds,{})}));export{ps as ClientView};
