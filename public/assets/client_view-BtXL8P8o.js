import{c as G,S as Ee,j as e,g as D,L as J,l as Z,u as Ae,b as Fe}from"./BindToParentScroll-BDRfL-P5.js";import{H as P,r as p,R as qe}from"./index-BgsS2K5R.js";import{f as Le}from"./DataBase-u9YpBFfJ.js";const C=G(i=>({user:void 0,store:void 0,userStore:void 0,manager:void 0,openAuth:!1,async updateUser(s){const t=C.getState().getHeaders();if(!t)return;const a=new FormData;s.photos_0=s.photo,delete s.photo;for(const l in s)s[l]&&a.append(l,s[l]);a.append("photos",'["photos_0"]');const c=await(await fetch(`${P}/edit_me`,{method:"PUT",body:a,headers:t.headers})).json();console.log({user:c}),c.id&&(i(()=>({user:c})),localStorage.setItem("user",JSON.stringify({...t.user,...c})))},async disconnection(){const s=C.getState().getHeaders();if(!s)return;const t={method:"GET",headers:s.headers};await fetch(`${P}/disconnection`,t),localStorage.removeItem("user"),i(()=>({user:void 0,store:void 0,userStore:void 0,openAuth:!0}))},async getAccess(){window.open(`${P}/google_connexion`,void 0,"popup");const s=setInterval(()=>{const t=localStorage.getItem("user"),a=t&&JSON.parse(t);a&&(console.log("getAccess",{token:a.token}),i(()=>({user:a})),clearInterval(s),C.getState().authenticateUser())},100)},async authenticateUser(){let s=localStorage.getItem("user");const t=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];try{if(s){const a=JSON.parse(s),n=new Headers;n.append("Authorization",`Bearer ${a.token}`);const c={method:"GET",headers:n},l=await fetch(`${P}/can_use_store/${t}`,c);let o;try{if(o=await l.json(),!o.store)return}catch{return}const r=(o==null?void 0:o.user)&&{...a,...o.user};i(()=>({user:r,manager:o.manager,userStore:o.userStore,store:o.store,openAuth:!1})),o!=null&&o.user&&localStorage.setItem("user",JSON.stringify(r));return}}catch{}await C.getState().getStore()},async getStore(){const s=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];if(s){const t=await fetch(`${P}/get_store_by_name/${s}`);try{let a=await t.json();i(()=>({store:a})),console.log(a)}catch{}}},getHeaders(){const s=C.getState().store;if(!s)return;let t=C.getState().user;const a=new Headers;return a.append("Authorization",`Bearer ${t==null?void 0:t.token}`),{store:s,headers:a,user:t}}})),de=[{u:"products",n:"Home",i:"/src/res/application.png"},{u:"categories",n:"Categories",i:"/src/res/catalog.png"},{u:"favorites",n:"Favorites",i:"/src/res/shopping-cart.png"},{u:"cart",n:"Cart",i:"/src/res/chat.png"},{u:"profile",n:"Prolife",i:"/src/res/chat.png"}],Re={"/":{loading:{},products:{detail:{comments:{},images:{}}},categories:{},favorites:{},cart:{payment:{}},profile:{command:{}}}},X=G(i=>({T:localStorage.getItem("theme"),storeVar:void 0,usersVar:void 0,back_color:"",blur:!1,openNav:"max",setOpenNav(s){i(()=>({openNav:s}))},setT(s){s&&localStorage.setItem("theme",s),i(()=>({T:s}))},currentChild:void 0,openChild(s,t,a){i(()=>({currentChild:s,blur:t,back_color:s&&a||""}))}})),B=new Ee(Re,["/","products"]).getStore(),Te=(i,s)=>{const t=setInterval(()=>{let a=!1,n=i,c=0;for(;!a;){if(n==document.body){clearInterval(t),s(),a=!0;return}else n==null||c>100?a=!0:n=n.parentElement;c++}},100)},ke=(i,s)=>t=>{if(!t)return;if(t.dataset.init)return i==null?void 0:i(t.setIndex);t.dataset.init="init:"+Math.trunc(Math.random()*1e3)/1e3;const a=()=>{let n=0;const c=r=>{const d=t.querySelectorAll(".card-h-c");if(n=r,d.length<=0)return;n=n>=d.length?d.length-1:n<0?0:n;const m=t.getBoundingClientRect(),h=m.width,u=d[n].getBoundingClientRect(),f=u.x-m.x+u.width/2;t.scrollTo({behavior:"smooth",left:t.scrollLeft-(h/2-f)})};t.setIndex=c;const l=()=>{const r=t.getBoundingClientRect().width;c(n);const d=t.querySelectorAll(".gap");for(const m of d)m.style.width=`${r/2}px`,m.style.minWidth=`${r/2}px`,m.style.maxWidth=`${r/2}px`};window.addEventListener("resize",l),l();const o=.1;t.addEventListener("scrollend",()=>{const r=t.getBoundingClientRect(),d=r.width,m=d*o,v=t.querySelectorAll(".card-h-c")[n].getBoundingClientRect(),u=v.x-r.x+v.width/2;let f=n;u<d/2-m?(f=n+1,c(f)):u>d/2+m?(f=n-1,c(f)):c(n),s==null||s(f)}),i==null||i(c)};Te(t,()=>{a()})};class Se{constructor(s,t,a){this.set(s,t,a)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(s,t,a){this.r=this.clamp(s),this.g=this.clamp(t),this.b=this.clamp(a)}hueRotate(s=0){s=s/180*Math.PI;const t=Math.sin(s),a=Math.cos(s);this.multiply([.213+a*.787-t*.213,.715-a*.715-t*.715,.072-a*.072+t*.928,.213-a*.213+t*.143,.715+a*.285+t*.14,.072-a*.072-t*.283,.213-a*.213-t*.787,.715-a*.715+t*.715,.072+a*.928+t*.072])}grayscale(s=1){this.multiply([.2126+.7874*(1-s),.7152-.7152*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152+.2848*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152-.7152*(1-s),.0722+.9278*(1-s)])}sepia(s=1){this.multiply([.393+.607*(1-s),.769-.769*(1-s),.189-.189*(1-s),.349-.349*(1-s),.686+.314*(1-s),.168-.168*(1-s),.272-.272*(1-s),.534-.534*(1-s),.131+.869*(1-s)])}saturate(s=1){this.multiply([.213+.787*s,.715-.715*s,.072-.072*s,.213-.213*s,.715+.285*s,.072-.072*s,.213-.213*s,.715-.715*s,.072+.928*s])}multiply(s){const t=this.clamp(this.r*s[0]+this.g*s[1]+this.b*s[2]),a=this.clamp(this.r*s[3]+this.g*s[4]+this.b*s[5]),n=this.clamp(this.r*s[6]+this.g*s[7]+this.b*s[8]);this.r=t,this.g=a,this.b=n}brightness(s=1){this.linear(s)}contrast(s=1){this.linear(s,-(.5*s)+.5)}linear(s=1,t=0){this.r=this.clamp(this.r*s+t*255),this.g=this.clamp(this.g*s+t*255),this.b=this.clamp(this.b*s+t*255)}invert(s=1){this.r=this.clamp((s+this.r/255*(1-2*s))*255),this.g=this.clamp((s+this.g/255*(1-2*s))*255),this.b=this.clamp((s+this.b/255*(1-2*s))*255)}hsl(){const s=this.r/255,t=this.g/255,a=this.b/255,n=Math.max(s,t,a),c=Math.min(s,t,a);let l,o,r=(n+c)/2;if(n===c)l=o=0;else{const d=n-c;switch(o=r>.5?d/(2-n-c):d/(n+c),n){case s:l=(t-a)/d+(t<a?6:0);break;case t:l=(a-s)/d+2;break;case a:l=(s-t)/d+4;break}l/=6}return{h:l*100,s:o*100,l:r*100}}clamp(s){return s>255?s=255:s<0&&(s=0),s}}class De{constructor(s,t){this.target=s,this.targetHSL=s.hsl(),this.reusedColor=new Se(0,0,0)}solve(){const s=this.solveNarrow(this.solveWide());return{values:s.values,loss:s.loss,filter:this.css(s.values)}}solveWide(){const a=[60,180,18e3,600,1.2,1.2];let n={loss:1/0};for(let c=0;n.loss>25&&c<3;c++){const l=[50,20,3750,50,100,100],o=this.spsa(5,a,15,l,1e3);o.loss<n.loss&&(n=o)}return n}solveNarrow(s){const t=s.loss,a=2,n=t+1,c=[.25*n,.25*n,n,.25*n,.2*n,.2*n];return this.spsa(t,c,a,s.values,500)}spsa(s,t,a,n,c){const o=.16666666666666666;let r=null,d=1/0;const m=new Array(6),h=new Array(6),v=new Array(6);for(let f=0;f<c;f++){const _=a/Math.pow(f+1,o);for(let y=0;y<6;y++)m[y]=Math.random()>.5?1:-1,h[y]=n[y]+_*m[y],v[y]=n[y]-_*m[y];const j=this.loss(h)-this.loss(v);for(let y=0;y<6;y++){const L=j/(2*_)*m[y],$=t[y]/Math.pow(s+f+1,1);n[y]=u(n[y]-$*L,y)}const q=this.loss(n);q<d&&(r=n.slice(0),d=q)}return{values:r,loss:d};function u(f,_){let j=100;return _===2?j=7500:(_===4||_===5)&&(j=200),_===3?f>j?f%=j:f<0&&(f=j+f%j):f<0?f=0:f>j&&(f=j),f}}loss(s){const t=this.reusedColor;t.set(0,0,0),t.invert(s[0]/100),t.sepia(s[1]/100),t.saturate(s[2]/100),t.hueRotate(s[3]*3.6),t.brightness(s[4]/100),t.contrast(s[5]/100);const a=t.hsl();return Math.abs(t.r-this.target.r)+Math.abs(t.g-this.target.g)+Math.abs(t.b-this.target.b)+Math.abs(a.h-this.targetHSL.h)+Math.abs(a.s-this.targetHSL.s)+Math.abs(a.l-this.targetHSL.l)}css(s){function t(a,n=1){return Math.round(s[a]*n)}return`invert(${t(0)}%) sepia(${t(1)}%) saturate(${t(2)}%) hue-rotate(${t(3,3.6)}deg) brightness(${t(4)}%) contrast(${t(5)}%)`}}function Me(i){const s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;i=i.replace(s,(a,n,c,l)=>n+n+c+c+l+l);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}const ce={},S=i=>{if(ce[i])return ce[i];const s=Me(i);if(s.length!==3){alert("Invalid format!");return}const t=new Se(s[0],s[1],s[2]),n=new De(t).solve(),c={color:t,result:n};return ce[i]=c,c},z=G(i=>({commands:void 0,carts:void 0,async deleteCommand(s){const t=C.getState().getHeaders();if(!t)return!1;if((await(await fetch(`${P}/delete_command/${s}`,{headers:t.headers,method:"DELETE"})).json()).deleted){const c=z.getState().carts;return i(()=>({carts:{limit:(c==null?void 0:c.limit)||25,page:(c==null?void 0:c.page)||1,total:(c==null?void 0:c.total)||0,list:((c==null?void 0:c.list)||[]).filter(l=>l.id!=s)}})),!0}return!1},async addProductToCart(s){const t=C.getState().getHeaders();if(!t||!(s.product_id||s.command_id))return;const a=new FormData,n={};a.append("store_id",t.store.id),s.product_id&&a.append("product_id",s.product_id+""),s.command_id&&a.append("command_id",s.command_id+""),s.quantity&&a.append("quantity",s.quantity+""),s.collected_features&&a.append("collected_features",JSON.stringify(s.collected_features));const c=new URLSearchParams({});for(const d in n){const m=n[d];c.set(d,m)}const o=await(await fetch(`${P}/add_command`,{method:"POST",headers:t.headers,body:a})).json();if(!o.id)return;const r=z.getState().carts;return i(()=>({carts:{limit:(r==null?void 0:r.limit)||25,page:(r==null?void 0:r.page)||1,total:(r==null?void 0:r.total)||0,list:[...((r==null?void 0:r.list)||[]).map(d=>d.id==o.id?o:d)]}})),o},async confirmCommand(s){const t=C.getState().getHeaders();if(!t)return!1;const a=new FormData;return s!=null&&s.list&&a.append("list",JSON.stringify(s.list)),(await(await fetch(`${P}/client_confirm_command`,{headers:t.headers,method:"PUT",body:a})).json()).success?(z.getState().fetchCarts({}),z.getState().fetchCommands({}),!0):!1},async fetchCarts(){const s=C.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.status="CART",t.add_favorite=!0;const a=new URLSearchParams({});for(const l in t){const o=t[l];a.set(l,o)}const c=await(await fetch(`${P}/get_commands/?${a.toString()}`,{headers:s.headers})).json();return i(()=>({carts:c})),c},async fetchCommands(){const s=C.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.no_status="CART",t.add_favorite=!0;const a=new URLSearchParams({});for(const l in t){const o=t[l];a.set(l,o)}const c=await(await fetch(`${P}/get_commands/?${a.toString()}`,{headers:s.headers})).json();return i(()=>({commands:c})),console.log(c),c}}));function ae({cart:i,canNull:s,product:t,onChange:a}){var o,r;let[n,c]=p.useState(Number((i==null?void 0:i.quantity)||(t==null?void 0:t.quantity)||0)||0);const{addProductToCart:l}=z();return p.useEffect(()=>{c(Number((i==null?void 0:i.quantity)||(t==null?void 0:t.quantity)||0)||0)},[t,i]),e.jsxs("div",{className:"cart-quantity",onClick:d=>{d.preventDefault(),d.stopPropagation()},children:[e.jsx("div",{className:"min "+(n<=(s?0:1)?"bloc":""),onClick:()=>{let d=parseInt(n+"");d=d-1<(s?0:1)?s?0:1:d-1,c(d),console.log("counter===>>>> ",d),(t||i)&&l({product_id:t==null?void 0:t.id,command_id:i==null?void 0:i.id,quantity:d}).then(()=>{a==null||a(n)})},children:e.jsx("span",{style:{filter:n<=(s?0:1)||!1?S("#fff").result.filter:S("#358f27").result.filter}})}),e.jsx("div",{className:"count",children:n}),e.jsx("div",{className:"max "+(n>=(((o=t||i)==null?void 0:o.stock)||Number.MAX_VALUE)?"bloc":""),onClick:()=>{var m,h,v;let d=parseInt(n+"");d=d<(((m=t||i)==null?void 0:m.stock)||Number.MAX_VALUE)?d:((h=t||i)==null?void 0:h.stock)||Number.MAX_VALUE,d=d+1,!(d>parseInt((((v=t||i)==null?void 0:v.stock)||Number.MAX_VALUE)+""))&&(c(d),(t||t||i)&&l({product_id:t==null?void 0:t.id,command_id:i==null?void 0:i.id,quantity:d}).then(()=>{a==null||a(n)}))},children:e.jsx("span",{style:{filter:n>=(((r=t||i)==null?void 0:r.stock)||Number.MAX_VALUE)?S("#fff").result.filter:S("#358f27").result.filter}})})]})}function Y({detail:i,image:s,title:t}){const{getAccess:a}=C();return e.jsx("div",{className:"page-auth",children:e.jsxs("div",{className:"auth-ctn",onClick:n=>{n.stopPropagation(),n.preventDefault()},children:[e.jsx("div",{className:"image",style:{background:s&&D(s)}}),e.jsxs("div",{className:"form",children:[e.jsx("h1",{className:"auth-title",children:t||"JOIN US NOW"}),e.jsxs("h5",{className:"auth-prompt",children:["Read more ?"," ",e.jsx("span",{onClick:()=>{},children:"Click here"})]}),e.jsxs("div",{className:"google",onClick:()=>{a()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Connexion"})]}),e.jsx("p",{children:i||"Google connexion is required to get access to sublymus service."})]})]})})}const he=G((i,s)=>({favorites:void 0,setFavorites(t){i(()=>({favorites:t}))},async deleteFavorite(t){const a=C.getState().getHeaders();if(!(a!=null&&a.user))return!1;if((await(await fetch(`${P}/delete_favorite/${t}`,{headers:a.headers,method:"DELETE"})).json()).deleted){const l=s().favorites;return i(()=>({favorites:{limit:(l==null?void 0:l.limit)||25,page:(l==null?void 0:l.page)||1,total:(l==null?void 0:l.total)||0,list:[...(l==null?void 0:l.list)||[]].filter(o=>o.id!=t).map(o=>({...o}))}})),!0}return!1},async addFavorite(t){const a=C.getState().getHeaders();if(!(a!=null&&a.user)||!t.product_id)return;const n=new FormData,c={};n.append("product_id",t.product_id),t.label&&n.append("label",t.label);const l=new URLSearchParams({});for(const m in c){const h=c[m];l.set(m,h)}const r=await(await fetch(`${P}/add_favorite`,{method:"POST",headers:a.headers,body:n})).json();if(!r.id)return;const d=s().favorites;return i(()=>({favorites:{limit:(d==null?void 0:d.limit)||25,page:(d==null?void 0:d.page)||1,total:(d==null?void 0:d.total)||0,list:[...((d==null?void 0:d.list)||[]).map(m=>m.id==r.id?r:m)]}})),r},async fetchFavorites(t){const a=C.getState().getHeaders();if(!(a!=null&&a.user))return;const n={...t};n.store_id=a.store.id,n.add_product=!0;const c=new URLSearchParams({});for(const r in n){const d=n[r];d&&c.set(r,d)}const o=await(await fetch(`${P}/get_favorites/?${c.toString()}`,{headers:a.headers})).json();if(o!=null&&o.list)return t!=null&&t.no_save||i(()=>({favorites:o})),console.log("favorites",o),{...o}}}));function Pe({elm:i,onChange:s}){const{addFavorite:t,deleteFavorite:a}=he(),{openChild:n}=X(),c=i.product_id||i.id,[l,o]=p.useState(!1),[r,d]=p.useState(0),[m]=p.useState({});return m.counter=r,m.isOpen=l,e.jsxs("div",{className:"favorites-btn "+(i.favorite?"favorite":"")+" "+(l?"open":""),onClick:()=>{l?(c&&n(e.jsx(Oe,{product_id:c,onChange:()=>s==null?void 0:s(i)}),!1,"#3455"),o(!1)):i.favorite?a(i.favorite).then(()=>{s==null||s(i)}):(()=>{o(!0),d(3);const h=setInterval(()=>{console.log(m.counter),m.counter>1&&m.isOpen?d(m.counter-1):(clearInterval(h),m.isOpen&&(o(!1),t({product_id:c,label:"default"}).then(()=>{s==null||s(i)})))},1e3)})()},children:[e.jsx("span",{className:"icon",style:{display:l?"none":"",filter:i.favorite&&S("#c00").result.filter}}),e.jsx("span",{className:"plus",style:{display:l?"":"none",filter:i.favorite&&S("#c00").result.filter}}),e.jsx("span",{className:"down",style:{display:l?"":"none",filter:i.favorite&&S("#c00").result.filter},children:r})]})}function Oe({product_id:i,onChange:s}){var h,v;const{openChild:t}=X(),[a,n]=p.useState(!1),[c,l]=p.useState(""),{addFavorite:o,favorites:r,fetchFavorites:d}=he(),m=u=>{(u||c)&&(console.log(u,c),o({product_id:i,label:u||c}).then(()=>{s==null||s(),l(""),t(void 0)}))};return p.useEffect(()=>{!(r!=null&&r.labels)&&d({add_labels:!0})}),e.jsx("div",{className:"choise-label",onClick:()=>t(void 0),children:e.jsxs("div",{className:"ctn",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:[e.jsx("h1",{children:"Choise Label"}),e.jsx("div",{className:"list",children:(v=((h=r==null?void 0:r.labels)==null?void 0:h.length)==0?["default"]:r==null?void 0:r.labels)==null?void 0:v.map(u=>e.jsxs("div",{className:"label",style:{borderBottom:`${J(u)} 2px solid`,border:`${J(u)} 2px solid`},onClick:()=>{m(u)},children:[u," ",e.jsx("span",{style:{background:J(u)}})]}))}),a?e.jsx("div",{className:"new-label",children:e.jsxs("label",{htmlFor:"new-label",children:[e.jsx("span",{className:"plus",onClick:()=>{m()}}),e.jsx("input",{type:"text",autoFocus:!0,id:"new-label",value:c,onKeyUp:u=>{console.log(u.code),u.code=="Enter"&&m()},onChange:u=>{l(u.currentTarget.value.toLowerCase().trim())}}),e.jsx("span",{className:"send",onClick:()=>{m()}})]})}):e.jsx("div",{className:"add-new",onClick:()=>{n(!0)},children:"Add New Label"})]})})}function ue({product:i,active:s,onClick:t,aspect:a,mode:n,onRefresh:c}){var v,u,f,_;const{addProductToCart:l}=z(),{openChild:o}=X(),{user:r}=C(),d=p.useRef(null),[m,h]=p.useState(0);return p.useEffect(()=>{const j=()=>{d.current&&a!=null&&n=="v"&&(d.current.style.height=`${d.current.getBoundingClientRect().width*(a||1)}px`)};return a!=null&&n=="v"&&window.addEventListener("resize",j),d.current&&(!a||n=="h")&&(d.current.style.height=""),j(),()=>{window.removeEventListener("resize",j)}},[d,a,n]),e.jsxs("div",{className:"product-card "+n+" "+(s?"active":""),onClick:t,ref:d,children:[e.jsx("div",{className:"div",onClick:j=>{j.preventDefault(),j.stopPropagation()},children:r&&e.jsx(Pe,{elm:i,onChange:()=>{c==null||c(i)}})}),e.jsxs("div",{className:"images",ref:ke(void 0,h),children:[e.jsx("div",{className:"gap"}),i.images.map(j=>e.jsx("div",{className:"image card-h-c ",style:{background:D(j)}},j)),e.jsx("div",{className:"gap"})]}),e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"counters",children:i.images.map((j,q)=>e.jsx("div",{className:"counter "+(m==q?"active":"")},j))}),e.jsx("div",{className:"price",children:e.jsx("div",{className:"value",children:"12450.93 $"})}),e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((v=i.note)!=null&&v.star?"":"vide")}),e.jsx("div",{className:"note",children:((u=i.note)==null?void 0:u.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((f=i.note)==null?void 0:f.votes)||0}),e.jsx("div",{className:"users"}),!((_=i.note)!=null&&_.star)&&e.jsx("div",{className:"new",children:"New"})]}),e.jsx("div",{className:"add-btn unselectable",onClick:j=>{j.preventDefault(),j.stopPropagation()},children:i.quantity!=null&&i.quantity!=null&&parseInt(i.quantity+"")!=0&&i.quantity.toString()!="0"?e.jsx(ae,{canNull:!0,product:i,onChange:()=>{c==null||c(i)}}):e.jsxs("div",{className:"btn",onClick:()=>r?l({product_id:i.id,quantity:1}).then(j=>{j!=null&&j.id&&(c==null||c(i))}):o(e.jsx(Y,{}),!1,"#3455"),children:["Add ",e.jsx("span",{children:" to cart"})]})})]})]})}const Q=G((i,s)=>({visites:void 0,product:void 0,products:{limit:25,list:[],page:1,total:0},setProducts(t,a){i(({products:n})=>({products:(n||a)&&{...n,...a,...t}}))},setVisites(t,a){i(({visites:n})=>({visites:(n||a)&&{...n,...a,...t}}))},async setClientVisite(t){const a=C.getState().getHeaders();if(!(a!=null&&a.user))return;const n=new FormData;n.append("product_id",t),await fetch(`${P}/set_client_visited`,{headers:a.headers,body:n,method:"PUT"})},async fetchVisites({after_date:t,before_date:a,client_id:n,product_id:c,limit:l,page:o}){const r=C.getState().getHeaders();if(!r)return;const d={};d.store_id=r.store.id,d.product_id=c||"",d.client_id=n||"",d.limit=l||6,d.page=o||1,d.after_date=t||"",d.before_date=a||"",d.add_favorite=!0;const m=new URLSearchParams({});for(const u in d){const f=d[u];f!=null&&m.set(u,f)}const v=await(await fetch(`${P}/get_client_visited/?${m.toString()}`,{headers:r.headers})).json();!v||!v.list||i(()=>({visites:v}))},featuresCollector:void 0,async setProductById(t){if(!t.product_id)return;const a=s().products,n=a==null?void 0:a.list.find(c=>c.id==t.product_id);if(n)s().selectProduct(n),i(()=>({featuresCollector:n==null?void 0:n.featuresCollector})),console.log(t);else{const c=C.getState().store;if(!c)return;const l={};l.product_id=t.product_id,l.is_features_required=!0,l.store_id=c.id,l.by_product_category=!(a!=null&&a.list[0]);const o=new URLSearchParams({});for(const h in l){const v=l[h];v!=null&&o.set(h,v)}const d=await(await fetch(`${P}/get_products/?${o.toString()}`)).json();if(!d.list)return;const m=d.list.find(h=>h.id==t.product_id)||d.list[0];i(()=>({products:a?{...a,list:[...d.list.filter(h=>!a.list.find(v=>v.id==h.id)),...a.list]}:d,product:m,featuresCollector:m==null?void 0:m.featuresCollector})),s().selectProduct(m)}},fetchProducts:async t=>{const a=C.getState().getHeaders();if(!a)return;const n={...t};n.store_id=a.store.id,n.add_favorite=!0;const c=new URLSearchParams({});for(const r in n){const d=n[r];d!=null&&c.set(r,d)}const o=await(await fetch(`${P}/get_products/?${c.toString()}`,{headers:a.headers})).json();if(o!=null&&o.list)return t!=null&&t.no_save||i(()=>({products:o})),{...o}},async selectProduct(t){if(!t)return i(()=>({product:void 0}));t.features=Le;const a={};t.features.list.forEach(n=>{var c;n.default_value?a[n.id]=n.default_value:(console.log("nnnnnnnnnn"),a[n.id]=(c=n.components)==null?void 0:c.find(l=>!!l.is_default),n.default_value=a[n.id])}),t.featuresCollector={collectFeature(n,c){c!=null?a[n.id]=c:n.default_value&&(a[n.id]=n.default_value),i(()=>({featuresCollector:t.featuresCollector&&{...t.featuresCollector}}))},getCollectedFeatures(n){return a[n]},allCollectedFeatures(){return a}},i(()=>({product:t})),s().setClientVisite(t.id)}}));function pe({note:i}){return e.jsxs("div",{className:"note-stars",children:[e.jsx("div",{className:"icon first "+(i>=1?"full":i<=0?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=2?"full":i<=1?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=3?"full":i<=2?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=4?"full":i<=3?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=5?"full":i<=4?"vide":"half")})]})}const ne=G(i=>({comments:void 0,index:void 0,lastPage:void 0,setLastPage(s){i(()=>({lastPage:s}))},setIndex(s){i(()=>({index:s}))},userComment:void 0,async getCommentIndex(s){const t=new URLSearchParams({});for(const c in s){const l=s[c];l!=null&&t.set(c,l)}return await(await fetch(`${P}/get_comment_index/?${t}`)).json()},async sendCommentResponse(s){const t=C.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_comment_id",s.comment_id.toString()),a.append("response",s.response);const c=await(await fetch(`${P}/set_product_comment_response`,{method:"PUT",body:a,headers:t.headers})).json();if(c!=null&&c.id)return i(({comments:l})=>({comments:l&&{...l,list:l.list.map(o=>o.id==s.comment_id?c:o)}})),c},async fetcheditCommentText(s){const t=C.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_comment_id",s.comment_id.toString()),a.append("text",s.text);const c=await(await fetch(`${P}/edit_product_comment_text`,{method:"PUT",body:a,headers:t.headers})).json();if(c!=null&&c.id)return i(({comments:l})=>({comments:l&&{...l,list:l.list.map(o=>o.id==s.comment_id?c:o)}})),c},async deleteComment(s,t){const a=C.getState().getHeaders();if(!a)return;const c=await(await fetch(`${P}/delete_product_comment/${s.id}`,{method:"DELETE",headers:a.headers})).json();if(c!=null&&c.deleted)return t&&setTimeout(()=>{i(({comments:l})=>({comments:l&&{...l,list:l.list.filter(o=>o.id!=s.id)}}))},t),c},async fetchProductComments(s){if(!C.getState().store)return;const a=new URLSearchParams({});for(const l in s){const o=s[l];a.set(l,o)}const c=await(await fetch(`${P}/get_product_comments/?${a.toString()}`)).json();return s!=null&&s.no_save||i(()=>({comments:c})),c},async fetchUserComment(){},async create_product_comment(s){const t=C.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_id",s.product_id),a.append("note",s.note+""),a.append("text",s.text);for(let l=0;l<s.photos.length;l++)a.append("photos_"+l,s.photos[l]);for(let l=0;l<s.videos.length;l++)a.append("videos_"+l,s.videos[l]);console.log(s);const c=await(await fetch(`${P}/create_product_comment`,{method:"POST",body:a,headers:t.headers})).json();if(c!=null&&c.id)return c}}));function te({comment:i,canOpen:s,onClick:t}){var w,O;const[a,n]=p.useState(!1),[c,l]=p.useState(!1),{userStore:o,manager:r}=C(),{deleteComment:d,sendCommentResponse:m,fetcheditCommentText:h}=ne(),v=(r==null?void 0:r.type.toLocaleLowerCase())=="collaborator"||(r==null?void 0:r.type.toLocaleLowerCase())=="owner",[u,f]=p.useState(0),[_,j]=p.useState(!1),[q,y]=p.useState(!1),[L,$]=p.useState(i.text||""),[x,b]=p.useState(i.response||""),R=(o==null?void 0:o.user_id)==i.user_id,[M,k]=p.useState(null);return e.jsxs("div",{ref:k,className:"product-comment",onClick:()=>{t==null||t(),l(!1)},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"photo",style:{background:i.user?D(i.user.photos[0]):""},children:e.jsx("span",{style:{background:(w=i.user)!=null&&w.country_icon?D(i.user.country_icon):""}})}),e.jsxs("div",{className:"coment-right",children:[e.jsxs("div",{className:"flex",style:{flexWrap:"nowrap"},children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"name",children:(O=i.user)==null?void 0:O.name}),e.jsx(pe,{note:i.note})]}),(R||v)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"option",onClick:N=>{N.preventDefault(),N.stopPropagation(),l(!c)}}),e.jsxs("div",{className:"ctn-option "+(c?"open":""),onClick:()=>{l(!1)},children:[e.jsx("div",{className:"close",onClick:()=>{l(!1)}}),R&&e.jsx("div",{className:"edit-comment",onClick:()=>{j(!0),y(!1)},children:"Edit Comment"}),v&&e.jsx("div",{className:"edit-response",onClick:()=>{y(!0),j(!1)},children:i.response?"Edit Response":"Add Response"}),e.jsx("div",{className:"delete",onClick:()=>{d(i,300).then(N=>{N!=null&&N.deleted&&(M==null||M.classList.add("deleted"),setTimeout(()=>{M&&(M.style.display="none")},300))})},children:"Delete"})]})]})]}),e.jsx("div",{className:"date",children:new Date(i.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),e.jsx("div",{className:"message",children:_?e.jsxs("label",{htmlFor:"edit-comment-"+i.id,children:[e.jsx("input",{id:"edit-comment-"+i.id,type:"text",value:L,placeholder:"Edit Comment",onChange:N=>{$(N.currentTarget.value)}}),e.jsx("span",{onClick:()=>{y(!1),j(!1),h({comment_id:i.id,text:L}).then(N=>{N!=null&&N.id&&(i.text=N.text,f(u+1))})}})]}):i.text})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),s&&(i.photos_count>0||i.videos_count>0)&&e.jsxs("div",{className:"files-ctn",children:[i.photos.map((N,T)=>e.jsx("div",{style:{background:D(N)+",#4544"},onClick:H=>{H.preventDefault(),H.stopPropagation(),t==null||t({comment:i,relative:T})}},N)),i.videos.map((N,T)=>e.jsx("div",{onClick:H=>{H.preventDefault(),H.stopPropagation(),t==null||t({comment:i,relative:i.photos.length+T})},children:e.jsx("video",{width:60,height:60,src:`${P}${N}`})},N))]})]}),(s&&i.response||q)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"open-response "+(a||q?"open":""),onClick:()=>{n(!a),y(!1),j(!1)},children:[i.response?"Open response":"Add Response",e.jsx("span",{})]}),e.jsx("div",{className:"response "+(a||q?"open":""),children:q?e.jsxs("label",{htmlFor:"edit-response-"+i.id,children:[e.jsx("input",{id:"edit-response-"+i.id,type:"text",value:x,placeholder:"Edit Response",onChange:N=>{b(N.currentTarget.value)}}),e.jsx("span",{onClick:()=>{y(!1),n(!0),m({comment_id:i.id,response:x}).then(N=>{N!=null&&N.id&&(i.response=N.response,f(u+1))})}})]}):i.response})]})]})}function le({posistion:i,size:s,top:t,step:a}){return n=>{if(!n||n.dataset.init)return;n.dataset.init="init",n.style.scrollBehavior="smooth";const c=n.parentElement,l=document.createElement("div");l.style.width=n.style.width,l.style.position="relative",l.append(n),c.append(l);const o=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div");r.className="h-scroll-icon-ctn right",o.className="h-scroll-icon-ctn",s&&(r.style.width=`${s}px`,r.style.height=`${s}px`,o.style.width=`${s}px`,o.style.height=`${s}px`),i&&(r.style.right=`${-i}px`,o.style.left=`${-i}px`),t&&(r.style.top=`${t}px`,o.style.top=`${t}px`),m.className="h-scroll-icon right",d.className="h-scroll-icon",r.append(m),o.append(d),m.style.filter=S("#123").result.filter,d.style.filter=S("#123").result.filter,l.append(r,o);const h=()=>{n.scrollLeft<=0?o.style.display="none":o.style.display="block",n.scrollLeft>=n.scrollWidth-n.getBoundingClientRect().width-30?r.style.display="none":r.style.display="block"};o.addEventListener("click",()=>{a?n.scrollLeft-=a:n.scrollLeft-=n.getBoundingClientRect().width/2}),r.addEventListener("click",()=>{a?n.scrollLeft+=a:n.scrollLeft+=n.getBoundingClientRect().width/2}),n.addEventListener("scroll",h),setTimeout(()=>{h()},500)}}function Be({product:i,setRef:s,userCommand:t}){const{userComment:a,comments:n,create_product_comment:c,fetchProductComments:l,setIndex:o}=ne(),{openChild:r}=X(),{user:d}=C(),{navBack:m,qs:h,current:v,json:u}=B(),[f,_]=p.useState([]),[j,q]=p.useState([]),[y,L]=p.useState(""),[$,x]=p.useState(0),[b,R]=p.useState(!1),[M,k]=p.useState(),[w,O]=p.useState(!1),[N,T]=p.useState({order_by:"created_at_desc",order_text:"Date",with_photo:!1,with_video:!1,limit:20,page:1}),[H,W]=p.useState(!1);return p.useEffect(()=>{l({product_id:i.id,...N})},[M,i,N,u]),v("comments")&&e.jsxs("section",{className:"page-comments "+(v("comments")?"open":"close"),ref:s,children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"return",onClick:()=>{m()}}),e.jsx("h1",{children:"Comments"}),e.jsx("div",{className:"option"})]}),e.jsx($e,{product:i,onClick:()=>h().keepJson().setAbsPath(["products","detail","images"])}),e.jsxs("div",{className:"write-comment",children:[e.jsxs("div",{className:"top-prompt",children:[" Leave a comment ",e.jsx("span",{})]}),M?e.jsx("div",{children:"Thank you for the comment."}):a?e.jsxs("div",{children:["You have already commented on this product ",e.jsx("span",{onClick:()=>R(!0),children:" see my comment"})]}):t!=null&&t.payment_id?e.jsxs("div",{className:"zone-inputs",children:[e.jsxs("div",{className:"user-rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"icon "+($>=1?"star":""),onClick:()=>x(1)}),e.jsx("div",{className:"icon "+($>=2?"star":""),onClick:()=>x(2)}),e.jsx("div",{className:"icon "+($>=3?"star":""),onClick:()=>x(3)}),e.jsx("div",{className:"icon "+($>=4?"star":""),onClick:()=>x(4)}),e.jsx("div",{className:"icon "+($==5?"star":""),onClick:()=>x(5)})]}),e.jsx("div",{className:"value",children:$})]}),!!$&&e.jsxs("label",{htmlFor:"comment-input-text",className:"input-text",children:[e.jsx("input",{id:"comment-input-text",autoFocus:!0,type:"text",value:y,placeholder:"Write Comment",onChange:A=>{L(A.target.value.substring(0,200))}}),e.jsxs("div",{className:"div",children:[y.length,"/200"]})]}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-photo",id:"comment-photo",accept:"image/*",onChange:A=>{if(A.target.files){for(const F of A.target.files)f.unshift(F);_([...f].slice(0,5))}}}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-video",id:"comment-video",accept:"video/*",onChange:A=>{if(A.target.files){for(const F of A.target.files)j.unshift(F);q([...j].slice(0,2))}}}),e.jsxs("div",{className:"files-ctn",style:{display:$&&y?"flex":"none"},children:[e.jsxs("div",{className:"photo-ctn",children:[e.jsxs("label",{htmlFor:"comment-photo",className:"photo",children:[e.jsx("span",{}),"Photo ",f.length,"/5"]}),e.jsx("div",{className:"files-photo",children:f.map(A=>e.jsx("div",{style:{background:D(URL.createObjectURL(A))},children:e.jsx("span",{onClick:()=>{_(f.filter(F=>F!=A))}})},A.name))})]}),e.jsxs("div",{className:"video-ctn",children:[e.jsxs("label",{htmlFor:"comment-video",className:"photo",children:[e.jsx("span",{}),"Video ",j.length,"/2"]}),e.jsx("div",{className:"files-video",children:j.map(A=>e.jsxs("div",{children:[e.jsx("video",{width:80,height:80,src:URL.createObjectURL(A)}),e.jsx("span",{onClick:()=>{q(j.filter(F=>F!=A))}})]},A.name))})]})]}),e.jsxs("div",{className:"send-comment "+(w?"loading":""),children:[e.jsx("span",{className:"text "+(y.trim()?"":"no"),onClick:()=>{if(!d)return r(e.jsx(Y,{}),!1,"#3455");$&&y&&(O(!0),c({note:$,photos:f,product_id:i.id,text:y,videos:j}).then(A=>{O(!1),A!=null&&A.id&&k(A)}))},children:"Send"})," ",e.jsx("span",{className:"loading"})]})]}):e.jsx("div",{children:"Comments are allowed after purchasing the product"})]}),e.jsx("div",{className:"my-comment",children:a&&e.jsx(te,{comment:a,canOpen:!0})}),e.jsxs("div",{className:"filter",children:[e.jsxs("div",{className:"date active",onClick:()=>{W(!H)},children:[N.order_text,e.jsx("span",{className:N.order_by.includes("desc")?"desc":""}),e.jsxs("div",{className:H?"open":"",children:[e.jsxs("div",{onClick:()=>T({...N,order_by:"created_at_desc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>T({...N,order_by:"created_at_asc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:""})]}),e.jsxs("div",{onClick:()=>T({...N,order_by:"note_desc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>T({...N,order_by:"note_asc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:""})]})]})]}),e.jsx("div",{className:"photo "+(N.with_photo?"active":""),onClick:()=>T({...N,with_photo:!N.with_photo}),children:"With Photo"}),e.jsx("div",{className:"video "+(N.with_video?"active":""),onClick:()=>T({...N,with_video:!N.with_video}),children:"With Video"})]}),e.jsx("div",{className:"comments",children:n==null?void 0:n.list.map(A=>e.jsx(te,{comment:A,canOpen:!0,onClick:F=>{const ee=F==null?void 0:F.comment;ee&&(h().keepJson().setAbsPath(["products","detail","images"]),o({comment:ee,relative:F.relative}))}},A.id))})]})}function Ue({product:i}){var x,b,R,M,k;const{current:s,navBack:t,pathList:a}=B(),{getCommentIndex:n,index:c,setIndex:l}=ne(),[o,r]=p.useState(null),[d,m]=p.useState((c==null?void 0:c.relative)||0),[h,v]=p.useState(),[u]=p.useState({}),[f,_]=p.useState(!1),[j,q]=p.useState({move:"",comment_id:c==null?void 0:c.comment.id});p.useEffect(()=>{s("images")&&i&&n({product_id:i.id,comment_id:j.comment_id||(c==null?void 0:c.comment.id),move:j.move||void 0}).then(w=>{var O;if(console.log({res:w}),(O=w==null?void 0:w.comment)!=null&&O.id){if(j.move=="back")m(w.comment.photos_count+w.comment.videos_count-1);else if(j.move=="next")m(0);else{let N=((c==null?void 0:c.relative)??d)||0;const T=w.comment.photos_count+w.comment.videos_count;N=N<=0?0:N>=T-1?T-1:N,m(N)}j.move="",j.comment_id=void 0,v(w)}})},[j,c,a]),p.useEffect(()=>{s("images")&&(q({comment_id:void 0,move:""}),v(void 0),console.log({commentIndex:h}))},[i,a]),p.useEffect(()=>{u.init||(u.init=!0,window.addEventListener("keyup",w=>{w.code=="ArrowRight"?u.moveNext():w.code=="ArrowLeft"&&u.moveBack()}))},[]);const y=()=>{d<=0?(console.log("back comment "),h&&q({...j,comment_id:h.comment.id,move:"back"})):(console.log("back image "),m(d-1))},L=()=>{d>=$.length-1?(console.log("next comment "),h&&q({...j,comment_id:h.comment.id,move:"next"})):(console.log("next image "),m(d+1))};u.moveNext=L,u.moveBack=y;const $=[...((x=h==null?void 0:h.comment)==null?void 0:x.photos)||[],...((b=h==null?void 0:h.comment)==null?void 0:b.videos)||[]];return s("images")&&!(h!=null&&h.comment)?e.jsxs("div",{className:"image-not-found",children:[e.jsx("p",{className:"text",children:"no images or videos found for this product."}),e.jsxs("div",{onClick:()=>t(),children:[e.jsx("span",{}),"go back"]})]}):s("images")&&(h==null?void 0:h.comment)&&e.jsxs("section",{className:"page-comment-image "+(s("images")?"open":"close"),children:[e.jsxs("div",{className:"page-top",children:[e.jsx("div",{className:"return",style:{filter:S("#fff").result.filter},onClick:()=>t()}),e.jsxs("div",{className:"count",children:[((h==null?void 0:h.befor)||0)+d," / ",(h==null?void 0:h.total)||0]})]}),e.jsxs("div",{className:"file-view _flex _center",children:[d>(((R=h==null?void 0:h.comment)==null?void 0:R.photos_count)||0)-1?e.jsx("div",{className:"video _flex",ref:w=>{if(!w||w.dataset.init)return;w.dataset.init="init",r(w);const O=()=>{const N=w.querySelector("video"),T=w.getBoundingClientRect();N.width=T.width};window.addEventListener("resize",O)},children:e.jsx("video",{loop:!0,autoPlay:!0,controls:!0,width:o==null?void 0:o.getBoundingClientRect().width,src:`${P}${$[d]}`})}):e.jsx("div",{className:"photo",children:e.jsx("div",{className:"img",style:{background:D($[d],"100%")}})}),e.jsx("div",{className:"move-next",onClick:L,children:e.jsx("div",{className:"next",children:e.jsx("span",{})})}),e.jsx("div",{className:"move-back",onClick:y,children:e.jsx("div",{className:"back",children:e.jsx("span",{})})})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"top _flex _wrap",children:[e.jsx("div",{className:"name",children:Z(((M=h==null?void 0:h.comment.user)==null?void 0:M.name)||"",50)}),e.jsxs("div",{className:"_flex  _l-auto",children:[e.jsx(pe,{note:((k=h==null?void 0:h.comment)==null?void 0:k.note)||0}),e.jsx("div",{className:"open",onClick:()=>_(!0),children:"Open"})]})]}),e.jsx("div",{className:"message",children:Z((h==null?void 0:h.comment.text)||"",100)}),e.jsxs("div",{className:"preview-comment "+(f?"open":"close"),children:[e.jsx("div",{className:"close",onClick:()=>{_(!1)}}),e.jsx(te,{comment:h.comment,canOpen:!0,onClick:w=>{const O=w==null?void 0:w.comment;O&&l({comment:O,relative:w.relative})}})]})]})]})}function xe({mode:i}){const{pathList:s,qs:t}=B(),{visites:a,fetchVisites:n,setVisites:c,fetchProducts:l}=Q(),{openChild:o}=X(),{user:r}=C(),d=m=>{l({product_id:m.id,no_save:!0}).then(h=>{if(h!=null&&h.list[0].id){const v={...h==null?void 0:h.list[0]};c({...a,list:a==null?void 0:a.list.map(u=>u.id==v.id?v:u)})}})};return p.useEffect(()=>{!a&&r&&n({})},[r,s]),e.jsxs("div",{className:"comp-visites "+(i||"h"),children:[e.jsxs("h1",{className:"title",children:["Products Visited",e.jsx("span",{})]}),e.jsxs("div",{className:"list",ref:le({posistion:20}),children:[!r&&e.jsx("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>o(e.jsx(Y,{}),!0,"#fffc"),children:"Connexion required"}),a==null?void 0:a.list.map(m=>e.jsx(ue,{aspect:i=="v"?1.4:void 0,mode:"inlist",product:m,onClick:()=>{t({product_id:m.id}).setAbsPath(["products","detail"])},onRefresh:h=>{d(h)}},m.id))]})]})}function ve({mode:i}){const{qs:s}=B(),{product:t,fetchProducts:a}=Q(),{store:n}=C(),[c,l]=p.useState();p.useEffect(()=>{a({no_save:!0,category_id:t==null?void 0:t.category_id}).then(r=>{r!=null&&r.list&&l(r)})},[t,n]);const o=r=>{c&&a({product_id:r.id,no_save:!0,lol:!0}).then(d=>{if(d!=null&&d.list[0].id){const m={...d==null?void 0:d.list[0]};c&&l({...c,list:c.list.map(h=>h.id==m.id?m:h)})}})};return e.jsxs("div",{className:"more-products "+(i||"h"),children:[e.jsxs("h1",{className:"title more",children:["More Products",e.jsx("span",{})]}),e.jsx("div",{className:"list",ref:le({posistion:20}),children:c==null?void 0:c.list.map(r=>e.jsx(ue,{aspect:i=="v"?1.4:void 0,mode:"inlist",product:r,active:(t==null?void 0:t.id)==r.id,onClick:()=>{s({product_id:r.id}).setAbsPath(["products","detail"])},onRefresh:d=>{o(d)}},r.id))})]})}const Ce={more:!0,list:["/fs/1hvrng7iv_29tvf0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1lpqtk_27y870_products_model_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1mieub_19ahe0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hvrng7iv_29tvf0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1lpqtk_27y870_products_model_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg"]};let I;function He(){var ge,Ne,ye,_e;const{json:i,qs:s,check:t,current:a,navBack:n}=B(),{setProductById:c,product:l,selectProduct:o,products:r,fetchProducts:d,setProducts:m}=Q(),{fetchProductComments:h,setLastPage:v}=ne(),{addProductToCart:u}=z(),{user:f}=C(),{openChild:_}=X(),j=p.useRef(null),q=p.useRef(null),y=p.useRef(null),[L,$]=p.useState(!0),[x,b]=p.useState(0),[R,M]=p.useState(!1),[k,w]=p.useState(),[O,N]=p.useState(!1),[T]=p.useState(),[H]=p.useState({payment_id:"lol"}),[W,A]=p.useState(null),[F,ee]=p.useState(),[fe]=p.useState({});p.useEffect(()=>{t("detail")&&(i!=null&&i.product_id)&&i.product_id!=fe.product_id&&(fe.product_id=i.product_id,c(i))},[i]),p.useEffect(()=>{l&&t("detail")&&(M(!1),b(0),I==null||I(0),s().keepJson().setAbsPath(["products","detail"]))},[l]),p.useEffect(()=>{l&&t("detail")&&(console.log("new Comments fech"),h({product_id:l.id,no_save:!0,limit:4}).then(g=>ee(g)))},[l]),p.useEffect(()=>{if(W){if(W.dataset.init)return;W.dataset.init="init",W.addEventListener("scroll",()=>{W.scrollTop>200?N(!0):N(!1)})}},[W]);const je=()=>{l&&d({add_cart:!0,product_id:l.id,no_save:!0}).then(g=>{if(g!=null&&g.list[0].id){const E={...g==null?void 0:g.list[0]};r&&m({...r,list:r==null?void 0:r.list.map(U=>U.id==(g==null?void 0:g.list[0].id)?E:U)}),(l==null?void 0:l.id)==(g==null?void 0:g.list[0].id)&&o(E)}})};return l&&e.jsxs("div",{className:"detail-product "+(l?"open":""),children:[l&&e.jsx(Be,{userComment:T,userCommand:H,setRef:A,product:l}),l&&e.jsx(Ue,{product:l}),e.jsxs("section",{className:"detail "+(a("products")||a("detail")?"open":"close"),ref:y,children:[e.jsxs("div",{className:"top-top _flex",children:[e.jsx("div",{className:"return",ref:g=>{if(!g||g.dataset.init)return;g.dataset.init="init";const E=()=>{window.innerWidth>940?g.style.display=" none":g.style.display="flex"};window.addEventListener("resize",E),E()},onClick:()=>{o(void 0),n()}}),e.jsx("div",{className:"label _lr-auto",children:"Detail Product"})]}),e.jsxs("div",{className:"top-infos",ref:g=>{if(!g||g.dataset.init)return;g.dataset.init="init";const E=g.querySelector(".images"),U=g.querySelector(".infos"),V=()=>{g.getBoundingClientRect().width<700?(g.style.flexWrap="wrap",E.style.width="",E.style.minWidth="",E.style.maxWidth="",U.style.width="",U.style.minWidth="",U.style.maxWidth=""):(g.style.flexWrap="",E.style.width="50%",E.style.minWidth="50%",E.style.maxWidth="50%",U.style.width="50%",U.style.minWidth="50%",U.style.maxWidth="50%")};window.addEventListener("resize",V),setTimeout(()=>{V(),I==null||I(0)},200)},children:[e.jsxs("div",{className:"images",children:[e.jsxs("div",{className:"list",ref:ke(g=>{I=g},b),children:[e.jsx("div",{className:"gap"}),l==null?void 0:l.images.map((g,E)=>e.jsx("div",{className:"img card-h-c "+(x==E?"active":""),style:{background:D(g)},onClick:()=>{I==null||I(E),b(E)}},g+(l==null?void 0:l.id))),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"min-list",children:l==null?void 0:l.images.map((g,E)=>e.jsx("div",{className:"min-img "+(x==E?"active":""),style:{background:D(g)},onClick:()=>{b(E),I==null||I(E)}},g+(l==null?void 0:l.id)))})]}),e.jsx("div",{className:"infos",ref:j,children:e.jsxs("div",{className:"diff",ref:q,children:[e.jsxs("div",{className:"text "+(k&&L?"min":""),children:[e.jsxs("div",{className:"title",children:[l==null?void 0:l.title,e.jsx("span",{})]}),e.jsx("p",{className:"description",children:((l==null?void 0:l.description.length)||0)>100&&!R?e.jsxs(e.Fragment,{children:[Z((l==null?void 0:l.description)||"",100)," ",e.jsx("span",{onClick:()=>M(!0),children:"Read more"})]}):(l==null?void 0:l.description)||""})]}),(l==null?void 0:l.features)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"label-features",children:["Features",e.jsxs("span",{children:[" ",(k==null?void 0:k.name)&&" : "+(k==null?void 0:k.name)]})," ",k&&e.jsx("span",{className:"close",style:{filter:((ge=S("#112233"))==null?void 0:ge.result.filter)||""},onClick:()=>{w(void 0)}})]}),e.jsx("div",{className:"features",children:l==null?void 0:l.features.list.map(g=>{var E;return e.jsxs("div",{className:"feature "+((k==null?void 0:k.id)==g.id?"active":""),style:{filter:((E=S("#358f27"))==null?void 0:E.result.filter)||""},onClick:()=>{var U,V;if(!k){const K=((U=j.current)==null?void 0:U.getBoundingClientRect().height)||0,se=((V=q.current)==null?void 0:V.getBoundingClientRect().height)||0;K-se<150?$(!0):$(!1)}(k==null?void 0:k.id)==g.id?w(void 0):w(g)},children:[e.jsx("div",{className:"icon",style:{background:D(g.icon)}}),e.jsx("div",{className:"label",children:Z(g.name,10)})]},g.id)})})]}),k&&e.jsxs("div",{className:"label-components",children:["Components: ",e.jsx("span",{children:(ye=(Ne=l==null?void 0:l.featuresCollector)==null?void 0:Ne.allCollectedFeatures()[k.id])==null?void 0:ye.name})]}),e.jsx("div",{className:"components "+(k?"open":""),children:(_e=k==null?void 0:k.components)==null?void 0:_e.map(g=>{var E,U;return e.jsxs("div",{className:"component "+(((U=(E=l==null?void 0:l.featuresCollector)==null?void 0:E.allCollectedFeatures()[k.id])==null?void 0:U.id)==g.id?"active":""),onClick:()=>{var V,K,se,be;((K=(V=l==null?void 0:l.featuresCollector)==null?void 0:V.allCollectedFeatures()[k.id])==null?void 0:K.id)==g.id?(se=l==null?void 0:l.featuresCollector)==null||se.collectFeature(k,void 0):(be=l==null?void 0:l.featuresCollector)==null||be.collectFeature(k,g)},children:[e.jsx("div",{className:"icon",style:{background:D(g.icon[0],"contain")}}),e.jsx("div",{className:"label",children:Z(g.name,10)})]})})})]})})]}),e.jsxs("div",{className:"detail-box",children:[e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"title",children:["product reviews",e.jsx("span",{})]}),l&&e.jsx($e,{onClick:()=>{v(""),s().keepJson().setAbsPath(["products","detail","images"])},product:l}),e.jsxs("div",{className:"title",children:["Comments",e.jsx("span",{})]}),e.jsxs("div",{className:"min-comments",ref:le({posistion:20}),children:[F==null?void 0:F.list.map(g=>e.jsx(te,{comment:g,onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])}},g.id)),e.jsxs("div",{className:"more-comment "+(F!=null&&F.list.length||0>0?"":"horizontal"),onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])},children:[e.jsx("div",{className:"icon "+(F!=null&&F.list.length||0>0?"":"add"),children:e.jsx("span",{style:{filter:S("#ffffff").result.filter}})}),e.jsx("div",{className:"label",children:F!=null&&F.list.length||0>0?"More":"Add First Comment"})]})]})]}),e.jsx(xe,{}),e.jsx(ve,{})]})]}),a("detail")&&e.jsx("div",{className:"price-zone",children:e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"price",children:[e.jsx("div",{children:"Price"}),e.jsxs("div",{className:"value",children:[(l==null?void 0:l.price)||0," $"]})]}),l.quantity!=null&&l.quantity!=null&&parseInt(l.quantity+"")!=0&&l.quantity.toString()!="0"?e.jsx(ae,{canNull:!0,product:l,onChange:()=>{je()}}):e.jsxs("div",{className:"add-to-cart",onClick:()=>f?u({product_id:l.id,quantity:1}).then(g=>{g!=null&&g.id&&je()}):_(e.jsx(Y,{}),!1,"#3455"),children:["Add ",e.jsx("span",{children:" to cart"})]})]})}),a("comments")&&(O||(H==null?void 0:H.payment_id)&&!T)&&e.jsxs("div",{className:"write-zone",children:[O&&e.jsx("div",{className:"up-icon",onClick:()=>{W&&(W.scrollTop=0)},children:e.jsx("span",{})}),e.jsx("div",{className:"write-icon",children:e.jsx("span",{})})]})]})}function $e({product:i,onClick:s}){const{qs:t}=B();return e.jsxs("div",{className:"group-file-rating",children:[e.jsx("div",{className:"after-order",children:e.jsxs("div",{className:"ctn-mini-files",onClick:s,children:[Ce.list.map((a,n)=>e.jsx("div",{className:"w",children:e.jsx("div",{className:"mini-file",style:{background:D(a)}})},n)),e.jsx("div",{className:"back",style:{background:D(Ce.list[0])},children:e.jsx("div",{className:"more-files",children:"+ More"})})]})}),(i==null?void 0:i.note)&&e.jsxs("div",{className:"rating",onClick:()=>t().keepJson().setAbsPath(["products","detail","comments"]),children:[e.jsx("div",{className:"note",children:i.note.star}),e.jsx(pe,{note:i.note.star}),e.jsxs("div",{className:"vote",children:[i.note.votes," ",e.jsx("span",{})]})]})]})}const Ie=G(i=>({categories:void 0,async fetchCategoies(s){const t=C.getState().store;if(!t)return;const a={...s};a.store_id=t.id;const n=new URLSearchParams({});for(const o in a){const r=a[o];n.set(o,r)}const l=await(await fetch(`${P}/get_categories/?${n.toString()}`)).json();if(l!=null&&l.list)return s!=null&&s.no_save||i(()=>({categories:l})),{...l}}}));let ie="";/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?ie="mobile-device":ie="not-mobile-device";document.body.classList.add(ie);const me=ie,We=(i,s)=>{let t=!1;for(const a in s)i[a]!=s[a]&&(t=!0,i[a]=s[a]);return delete i.product_id,t};function ze(){const{json:i,qs:s,check:t,pathList:a}=B(),{products:n,fetchProducts:c,selectProduct:l,product:o,setProducts:r}=Q(),{store:d}=C(),[m,h]=p.useState({order_by:"date_desc",category_id:"",limit:18,add_cart:!0,lol:!0,is_features_required:!0,price_min:void 0,price_max:void 0,text:"",product_id:""}),{fetchCategoies:v}=Ie(),[u,f]=p.useState(),[_]=p.useState({}),[j,q]=p.useState(!1);p.useEffect(()=>{t("products")&&c({...m}).then(x=>{x!=null&&x.list[0]&&!o&&window.innerWidth>940&&(l(x==null?void 0:x.list[0]),s({...i,product_id:x.list[0].id}).setAbsPath(["products","detail"]))})},[m,d,a]),p.useEffect(()=>{!u&&v({limit:25,no_save:!0}).then(x=>{x!=null&&x.list&&f(x)})},[d]),p.useEffect(()=>{t("products")&&We(m,i||{})&&h({...m})},[i]),p.useEffect(()=>{window.addEventListener("resize",()=>{var x;window.innerWidth>940&&!_.product&&l((x=_.products)==null?void 0:x.list[0])})},[]),_.product=o,_.products=n;const[y,L]=p.useState("");p.useEffect(()=>{window.addEventListener("resize",()=>{L(`${window.innerWidth} / ${window.innerHeight}  / ${window.screen.height} => ${me}`)}),L(`${window.innerWidth} / ${window.innerHeight} / ${window.devicePixelRatio}  => ${me}`)},[]);const $=x=>{n&&c({add_cart:!0,product_id:x.id,no_save:!0,lol:!0,is_features_required:!0}).then(b=>{if(b!=null&&b.list[0].id){const R={...b==null?void 0:b.list[0]};n&&r({...n,list:n.list.map(M=>M.id==R.id?R:M)})}})};return t("products")&&e.jsxs("div",{className:"page-products",children:[e.jsx("div",{className:"left "+(j?"open":"")+" "+(t("detail")&&o?"product-detail":""),onClick:()=>{q(!1)},children:e.jsxs("div",{className:"filter-fram",children:[e.jsx("div",{className:"top",children:"Filter"}),e.jsx("div",{className:"categories",children:u==null?void 0:u.list.map(x=>e.jsx("div",{className:"category",onClick:()=>h({...m,category_id:x.id}),children:x.label},x.id))}),e.jsxs("div",{className:"prices",children:[e.jsxs("div",{className:"ctn",children:[e.jsx("label",{htmlFor:"product-price-min",children:e.jsx("input",{type:"text",id:"product-price-min",placeholder:"Min",value:m.price_min})}),e.jsx("label",{htmlFor:"product-price-max",children:e.jsx("input",{type:"text",id:"product-price-max",placeholder:"Max",value:m.price_max})})]}),e.jsx("div",{className:"set-price",children:e.jsx("div",{className:"btn",children:"Set Price"})})]})]})}),e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"search-zone",children:[e.jsxs("label",{htmlFor:"product-search",className:"search",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{id:"product-search",type:"text",placeholder:"Search Product",value:m.text,onChange:x=>{h({...m,text:x.currentTarget.value})}}),e.jsx("div",{className:"clear",onClick:()=>{h({...m,text:""})}})]}),e.jsx("div",{className:"search-text",children:m.text&&e.jsxs(e.Fragment,{children:['Search result for "',e.jsx("span",{children:m.text}),'"']})}),e.jsxs("div",{className:"sort",children:[e.jsx("div",{className:"label",onClick:()=>{q(!0)},children:"Sort"}),e.jsx("div",{className:"list",children:["date","name","price","popular"].map(x=>{var b;return e.jsx("div",{className:((b=(i==null?void 0:i.order_by)||m.order_by)==null?void 0:b.split("_")[0])==x?"active":"",onClick:()=>{s({...i,order_by:x+"_desc"}).apply()},children:x},x)})})]})]}),e.jsx("div",{className:"list",children:n==null?void 0:n.list.map(x=>e.jsx(ue,{canAddToCart:x.title.includes("321"),product:x,active:(o==null?void 0:o.id)==x.id,onClick:()=>{l({...x}),s({...i,product_id:x.id}).setAbsPath(["products","detail"])},onRefresh:b=>{$(b)}},x.id))})]}),e.jsx("div",{className:"right "+(o?"product":"")+" "+(t("detail")?"detail":""),children:e.jsx(He,{})})]})}function Ve(){var v;const{setAbsPath:i,pathList:s}=B(),[t,a]=p.useState(s[1]||"home"),[n,c]=p.useState(!1),[l,o]=p.useState(!1),{user:r,getAccess:d}=C(),m=Ae(),h=u=>{i([u]),a(u)};return p.useEffect(()=>{a(s[1]||"home")},[s]),p.useEffect(()=>{window.addEventListener("click",()=>{const u=document.querySelector(".top-bar .more-navs ul");(u==null?void 0:u.className)==""&&o(!1)})},[]),e.jsxs("div",{className:"top-bar",ref:Fe(80,".web"),children:[e.jsxs("div",{className:"top-bar-ctn",children:[e.jsx("div",{className:"left",children:e.jsx("a",{href:"#products",className:"logo-ctn",onClick:u=>{u.preventDefault(),u.stopPropagation(),h("products")},children:e.jsx("div",{className:"icon"})})}),e.jsx("ul",{className:"top-bar-center",children:de.map((u,f)=>f*150<m.width-400?e.jsxs("li",{className:t==u.u?"active":"",onClick:()=>{h(u.u)},children:[e.jsx("span",{}),u.n]},f):null)}),e.jsxs("div",{className:"right",children:[e.jsx("div",{className:"ctn-icon",onClick:u=>{u.preventDefault(),u.stopPropagation(),o(!l)},children:e.jsx("div",{className:"icon",style:{filter:S("#345").result.filter}})}),r?e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${(v=r==null?void 0:r.photos[0])!=null&&v.startsWith("/")?P:""}${r==null?void 0:r.photos}),#bbb`},onClick:()=>{h("profile")}}):e.jsx("div",{className:"login",onClick:()=>d(),children:"Se connecter"})]})]}),e.jsx("div",{className:"more-navs",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:e.jsxs("ul",{className:l?"":"close",children:[de.map((u,f)=>f*150>=m.width-400?e.jsxs("li",{className:t==u.u?"active":"",onClick:()=>{h(u.u),o(!l)},children:[e.jsx("span",{}),u.n]},f):null),e.jsxs("li",{className:t=="mode-lite"?"active":"",style:{whiteSpace:"nowrap"},onClick:()=>{c(!n)},children:[e.jsx("span",{}),n?"Lite mode off":"Lite mode on"]})]})})]})}function Je(){const{check:i,setAbsPath:s}=B();return e.jsx("div",{className:"bottom-nav",children:e.jsx("ul",{children:de.map((t,a)=>e.jsxs("li",{className:t.u+" "+(i(t.u)?"active":""),onClick:()=>s([t.u]),children:[e.jsx("span",{className:"label",children:t.n}),e.jsx("span",{className:"icon "+t.u})]},a))})})}function Ge(){const{check:i}=B();return i("categories")&&e.jsx("div",{className:"page-categories"})}function Xe(){var h;const{pathList:i,check:s,navBack:t}=B(),{user:a}=C(),{favorites:n,fetchFavorites:c,setFavorites:l,deleteFavorite:o}=he(),{addProductToCart:r}=z();console.log({favorites:n});const[d,m]=p.useState("All");return p.useEffect(()=>{c({add_labels:!0,label:d=="All"?void 0:d})},[a,i,d]),s("favorites")&&(a?e.jsxs("div",{className:"page-favorites",children:[e.jsxs("div",{className:"top-favorites _flex",children:[e.jsx("div",{className:"return",onClick:()=>{t()}}),e.jsx("div",{className:"label _lr-auto",children:"Favorites"})]}),e.jsxs("div",{className:"favorites-ctn",children:[e.jsxs("div",{className:"left",children:[e.jsxs("div",{className:"filter-by",ref:le({posistion:20}),children:[e.jsx("h4",{children:"labels : "}),e.jsx("span",{className:"label "+(d=="All"?"all":""),onClick:()=>{m("All")},children:"All"}),(h=n==null?void 0:n.labels)==null?void 0:h.map(v=>e.jsx("span",{className:"label",style:{background:d==v?J(v):"",boxShadow:`${J(v)} 0px 0px 3px, ${J(v)} 0px 0px 3px, ${J(v)} 0px 0px 3px`},onClick:()=>{m(v)},children:v}))]}),n==null?void 0:n.list.map(v=>e.jsx(Ye,{favorite:v,onQuantityChange:()=>{c({favorite_id:v.id}).then(u=>{if(u!=null&&u.list[0]){const f=u==null?void 0:u.list[0];n&&l({...u,list:n.list.map(_=>_.id==v.id?f:_)})}})},addProductToCart:()=>{v.product&&r({product_id:v.product.id,quantity:1}).then(u=>{u!=null&&u.id&&c({favorite_id:v.id}).then(f=>{if(f!=null&&f.list[0]){const _=f==null?void 0:f.list[0];n&&l({...f,list:n.list.map(j=>j.id==v.id?_:j)})}})})},onDelete:()=>{o(v.id)}},v.id))]}),e.jsx("div",{className:"right"})]}),e.jsx(xe,{}),e.jsx(ve,{})]}):e.jsx("div",{className:"page-favorites",children:e.jsx(Y,{detail:"Google connexion is required to access your favorites"})}))}function Ye({favorite:i,onClick:s,changeLabel:t,onDelete:a,onShare:n,onQuantityChange:c,addProductToCart:l}){var d,m,h,v,u,f;const o=i.product,{qs:r}=B();return console.log(i.id,(o==null?void 0:o.quantity)!=null,(o==null?void 0:o.quantity)!=null,parseInt((o==null?void 0:o.quantity)+"")!=0,((d=o==null?void 0:o.quantity)==null?void 0:d.toString())!="0"),o&&e.jsx("div",{className:"favorites-item",onClick:()=>{s==null||s(i),r({product_id:i.product_id}).setAbsPath(["products","detail"])},children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:D(o.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:o.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:o.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((m=o.note)!=null&&m.star?"":"vide")}),e.jsx("div",{className:"note",children:((h=o.note)==null?void 0:h.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((v=o.note)==null?void 0:v.votes)||0}),e.jsx("div",{className:"users"}),!((u=o.note)!=null&&u.star)&&e.jsx("div",{className:"new",children:"New"})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[o.price.toLocaleString()," ","$"]})}),o.quantity!=null&&o.quantity!=null&&parseInt(o.quantity+"")!=0&&((f=o.quantity)==null?void 0:f.toString())!="0"?e.jsx(ae,{canNull:!0,product:o,onChange:_=>{c==null||c(_)}}):e.jsxs("div",{className:"add-btn",onClick:_=>{l(),_.stopPropagation(),_.preventDefault()},children:["Add ",e.jsx("span",{children:" to cart"})]})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},onClick:_=>{_.stopPropagation(),_.preventDefault()},children:[e.jsx("div",{style:{filter:S("#123").result.filter},className:"delete",onClick:()=>{a==null||a(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:S("#123").result.filter},className:"share",onClick:()=>n==null?void 0:n(i),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"label",style:{background:J(i.label)},onClick:_=>{t==null||t(i),_.stopPropagation(),_.preventDefault()},children:[i.label," "]})]})]})]})})}function Ke(){const{check:i,pathList:s,navBack:t,qs:a}=B(),{visites:n,fetchVisites:c}=Q(),{current:l}=B(),{user:o}=C(),{carts:r,fetchCarts:d,deleteCommand:m,confirmCommand:h}=z(),[v,u]=p.useState(0),[f,_]=p.useState(0),[j,q]=p.useState(0),[y,L]=p.useState((r==null?void 0:r.list.map(x=>x))||[]),[$]=p.useState({});return $.selecteds=y,p.useEffect(()=>{let x=0,b=0;y.forEach(R=>{x+=Number(R.quantity),b+=R.price*R.quantity}),_(b),q(x)},[v,y]),p.useEffect(()=>{L((r==null?void 0:r.list.filter(x=>!!$.selecteds.find(b=>b.id==x.id)))||[])},[r]),p.useEffect(()=>{o&&l("cart")&&d({}).then(x=>{x!=null&&x.list&&L(x.list)}),!n&&o&&l("cart")&&c({})},[o,s]),i("cart")&&(o?e.jsxs("div",{className:"page-cart",children:[e.jsxs("div",{className:"top-cart _flex",children:[e.jsx("div",{className:"return",onClick:()=>{t()}}),e.jsx("div",{className:"label _lr-auto",children:"Cart"})]}),e.jsxs("div",{className:"cart-ctn",children:[e.jsxs("div",{className:"items",children:[e.jsxs("div",{className:"select-all",children:[e.jsx("div",{className:"btn "+(y.length<((r==null?void 0:r.list.length)||0)?"":"select"),onClick:()=>{y.length<((r==null?void 0:r.list.length)||0)?L((r==null?void 0:r.list.map(x=>x))||[]):L([])},children:y.length<((r==null?void 0:r.list.length)||0)?"Select All":"Deselect All"}),e.jsxs("a",{className:"my-command ",onClick:()=>a({page:"command"}).setAbsPath(["profile"]),children:["my orders ",e.jsx("span",{})]})]}),r==null?void 0:r.list.map(x=>e.jsx(Ze,{selected:!!y.find(b=>b.id==x.id),cart:x,onSelect:b=>{y.find(R=>R.id==b.id)?L(y.filter(R=>R.id!=b.id)):L([...y,b])},onDelete:b=>{m(b.id)},onQuantityChange:()=>{u(v+1)},onLike:()=>{d({}).then(b=>{b!=null&&b.list&&L(b.list)})}},x.id))]}),e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"go-to-checkout",children:[e.jsx("div",{className:"title",onClick:()=>{h({list:y.map(x=>x.id)})},children:"Go to checkout"}),e.jsx("p",{children:"Available delivery methods and times can be selected when placing an order."}),e.jsxs("div",{className:"infos",children:[e.jsxs("div",{className:"count",children:[e.jsx("h2",{children:"Your cart"}),e.jsxs("div",{className:"val",children:[j," products ",e.jsx("span",{})," "]})]}),e.jsxs("div",{children:[e.jsxs("span",{children:["Products (",y.length,")"]}),e.jsxs("span",{className:"initial-price",children:[f.toLocaleString(),"$"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text",children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:"detail",children:["More details ",e.jsx("span",{})]})]}),e.jsxs("span",{className:"discount",children:[0 .toLocaleString(),"$"]})]})]}),e.jsxs("div",{className:"_flex",children:[e.jsx("h1",{children:"total cost"}),e.jsxs("h1",{className:"total",children:[f.toLocaleString(),"$"]})]})]}),e.jsx("div",{className:"cart-cover-image"})]})]}),e.jsx(xe,{mode:"h"}),e.jsx(ve,{mode:"h"})]}):e.jsx("div",{className:"page-cart",children:e.jsx(Y,{detail:"Google connexion is required to access your cart"})}))}let oe={metal:"gold",gem:"Diamon",size:56};function Ze({cart:i,selected:s,onClick:t,onSelect:a,onDelete:n,onLike:c,onShare:l,onQuantityChange:o}){return e.jsx("div",{className:"cart-item",onClick:()=>t==null?void 0:t(i),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:D(i.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...oe}).slice(0,2).map(r=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:r}),":",e.jsx("span",{className:"v",children:(oe||{})[r]})]},r)),Object.keys(oe||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(i.price*i.quantity).toLocaleString()," ","$"]})}),e.jsx(ae,{cart:i,onChange:()=>{o==null||o(i)}})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},children:[e.jsx(Pe,{elm:i,onChange:()=>c==null?void 0:c(i)}),e.jsx("div",{style:{filter:S("#123").result.filter},className:"delete",onClick:()=>{n==null||n(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:S("#123").result.filter},className:"share",onClick:()=>l==null?void 0:l(i),children:e.jsx("span",{})})]}),e.jsx("div",{className:"check-box "+(s?"selected":""),onClick:()=>a==null?void 0:a(i),children:s?"selected":"not selected"})]})]})]})})}const Qe={};function es(){const{user:i}=C(),{commands:s,fetchCommands:t}=z();return p.useEffect(()=>{i&&t({})},[i]),e.jsx("div",{className:"page-command",children:e.jsx("div",{className:"orders",children:s==null?void 0:s.list.map(a=>e.jsx(ss,{order:a,onShare:()=>{},onClick:()=>{},onLike:()=>{}},a.id))})})}let re={metal:"gold",gem:"Diamon",size:56};function ss({order:i,onClick:s,onLike:t,onShare:a,onComment:n}){return e.jsx("div",{className:"order-item",onClick:()=>s==null?void 0:s(i),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:D(i.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...re}).slice(0,2).map(c=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:c}),":",e.jsx("span",{className:"v",children:(re||{})[c]})]},c)),Object.keys(re||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(i.price*i.quantity).toLocaleString()," ","$"]})}),e.jsx("div",{className:"status",style:{background:Qe[i.status]},children:i.status})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",children:[e.jsx("div",{style:{filter:S("#123").result.filter},className:"to-favorites",onClick:()=>t==null?void 0:t(i),children:e.jsx("span",{})}),e.jsx("div",{style:{filter:S("#123").result.filter},className:"start-comment",onClick:()=>{n==null||n(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:S("#123").result.filter},className:"share",onClick:()=>a==null?void 0:a(i),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"ref-id",onClick:c=>{navigator.clipboard.writeText("#"+i.id.split("-")[0]);const o=c.currentTarget.querySelector("span");o.classList.add("anim-top"),setTimeout(()=>{o.classList.remove("anim-top"),o.classList.add("anim-btm"),setTimeout(()=>{o.classList.remove("anim-btm")},300)},300)},children:["Ref Id : #",i.id.split("-")[0]," ",e.jsx("span",{style:{filter:S("#333").result.filter}})]})]})]})]})})}function ts(){const{updateUser:i,user:s}=C(),[t,a]=p.useState({});return p.useEffect(()=>{a({name:s==null?void 0:s.name,address:(s==null?void 0:s.address)||"Yopouon",phone:(s==null?void 0:s.phone)||"+7(999)862-74-41",date:s==null?void 0:s.created_at,money:(s==null?void 0:s.money)||"USD"})},[s]),e.jsxs("div",{className:"page-edit",children:[e.jsx("div",{className:"photo",style:{background:s&&D(s.photos[0])},children:e.jsx("div",{className:"div",children:e.jsx("label",{htmlFor:"new-photo",className:"new-photo",children:e.jsx("input",{style:{display:"none"},type:"file",name:"new-photo",id:"new-photo",onChange:n=>{var c;i({photo:(c=n.currentTarget.files)==null?void 0:c[0]})}})})})}),e.jsxs("div",{className:"infos",children:[e.jsxs("label",{htmlFor:"edit-email",className:"edit-email",children:[e.jsx("div",{className:"prompt",children:"User Email"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-email",type:"text",placeholder:"Edit Name",value:s==null?void 0:s.email})]}),e.jsxs("label",{htmlFor:"edit-name",className:"edit-name",children:[e.jsx("div",{className:"prompt",children:"Name"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-name",type:"text",placeholder:"Edit Name",value:t.name,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-phone",className:"edit-phone",children:[e.jsx("div",{className:"prompt",children:"Phone"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-phone",type:"text",placeholder:"Search Product",value:t.phone,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-address",className:"edit-address",children:[e.jsx("div",{className:"prompt",children:"Address"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-address",type:"text",placeholder:"Search Product",value:t.address,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-date",className:"edit-date",children:[e.jsx("div",{className:"prompt",children:"date of birth"}),e.jsx("div",{className:"icon"}),e.jsx("input",{type:"text",placeholder:"dd-mm-yyyy",value:new Date(t.date).toDateString(),onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("input",{style:{display:"none"},id:"edit-date",type:"date",min:"1997-01-01",max:new Date().toDateString(),placeholder:new Date().toDateString(),onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-devise",className:"edit-devise",children:[e.jsx("div",{className:"prompt",children:"Default Money"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-devise",type:"text",placeholder:"Search Product",value:t.money,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]})]})]})}const we={edit:"Edit Profile",command:"Orders",messages:"Messages",setting:"Setting"};function is(){const{check:i,json:s}=B(),{user:t,disconnection:a,getAccess:n}=C(),[c,l]=p.useState(!0),[o,r]=p.useState("");p.useEffect(()=>{i("profile")&&r((s==null?void 0:s.page)||"")},[s]);const d={command:e.jsx(es,{}),edit:e.jsx(ts,{})};return i("profile")&&e.jsxs("div",{className:"page-profile",children:[e.jsx("div",{className:"nav "+(c?"open":"close"),onClick:()=>{l(!1)},children:e.jsxs("div",{className:"nav-ctn",onClick:m=>{m.preventDefault(),m.stopPropagation()},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"close",onClick:()=>{l(!1)}}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"cover-image"}),e.jsx("div",{className:"photo",style:{background:(t==null?void 0:t.photos[0])&&D(t==null?void 0:t.photos[0])}})]}):e.jsxs("div",{className:"login",onClick:()=>{n()},children:[e.jsx("div",{className:"icon",style:{}}),e.jsx("h3",{className:"label",children:"Login"}),e.jsx("span",{className:"next"})]})]}),e.jsx("h1",{className:"name",children:t==null?void 0:t.name}),t&&e.jsx("div",{className:"email _limit-text",children:t==null?void 0:t.email}),e.jsxs("ul",{children:[e.jsxs("li",{className:"edit "+(o=="edit"?"active":"")+" "+(t?"":"hide"),onClick:()=>{l(!1),r("edit")},children:[" ",e.jsx("span",{className:"icon",style:{filter:S("#123").result.filter}}),"Edit Profile",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"command "+(o=="command"?"active":"")+" "+(t?"":"hide"),onClick:()=>{l(!1),r("command")},children:[" ",e.jsx("span",{className:"icon",style:{filter:S("#123").result.filter}}),"My Orders",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"messages "+(o=="messages"?"active":"")+" "+(t?"":"hide"),onClick:()=>{l(!1),r("messages")},children:[" ",e.jsx("span",{className:"icon",style:{filter:S("#123").result.filter}}),"messages",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"setting "+(o=="setting"?"active":"")+" "+(t?"":"hide"),onClick:()=>{l(!1),r("setting")},children:[" ",e.jsx("span",{className:"icon",style:{filter:S("#123").result.filter}}),"setting",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"about "+(o=="about"?"active":""),onClick:()=>{l(!1),r("about")},children:[" ",e.jsx("span",{className:"icon",style:{filter:S("#123").result.filter}}),"about",e.jsx("span",{className:"next"})]})]}),e.jsx("div",{className:"version",children:"By Sublymus Studio v:1.0.1"}),t&&e.jsxs("div",{className:"disconnect",onClick:()=>{a()},children:[e.jsx("span",{className:"icon",style:{filter:S("#c43d4c").result.filter}}),"Log out"]})]})}),e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"title",children:[e.jsx("span",{className:"option-nav",onClick:()=>{l(!0)}}),e.jsxs("h1",{children:[" ",we[o]||we.edit]})]}),t?d[o]||d.edit:d.about]})]})}function as(){const{authenticateUser:i}=C(),{openChild:s,currentChild:t,back_color:a,blur:n}=X(),c=p.useRef(null),{pathList:l}=B();return p.useEffect(()=>{s(void 0)},[l]),p.useEffect(()=>{i(),window.addEventListener("blur",()=>{})},[]),e.jsxs("div",{className:"app",style:{width:"100%",height:"100%"},ref:o=>{},children:[t&&e.jsx("div",{className:"child-viewer",onContextMenu:o=>{o.preventDefault(),s(void 0)},children:e.jsx("div",{className:"child-viewer-ctn",style:{background:a},onClick:()=>{s(void 0)},onContextMenu:o=>{o.preventDefault(),s(void 0)},children:t})}),e.jsx(Ve,{}),e.jsxs("div",{ref:c,className:"app-ctn",style:{filter:n?"blur(10px)":"",height:`calc(100% - var(--bottom-nav-height) - ${me=="mobile-device"?window.screen.height-window.innerHeight:0}px)`},children:[e.jsx(ze,{}),e.jsx(Ge,{}),e.jsx(Xe,{}),e.jsx(Ke,{}),e.jsx(is,{})]}),e.jsx(Je,{})]})}const ns=i=>i,rs=ns(e.jsx(qe.StrictMode,{children:e.jsx(as,{})}));export{rs as ClientView};
