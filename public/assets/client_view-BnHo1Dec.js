import{c as K,S as Te,j as e,g as M,L as G,l as se,u as Re,b as De}from"./BindToParentScroll-C408W_26.js";import{H as $,r as p,R as Me}from"./index-D3_GZIYq.js";import{f as Oe}from"./DataBase-u9YpBFfJ.js";const w=K(i=>({user:void 0,store:void 0,userStore:void 0,manager:void 0,openAuth:!1,async updateUser(s){const t=w.getState().getHeaders();if(!t)return;const a=new FormData;s.photos_0=s.photo,delete s.photo;for(const r in s)s[r]&&a.append(r,s[r]);a.append("photos",'["photos_0"]');const c=await(await fetch(`${$}/edit_me`,{method:"PUT",body:a,headers:t.headers})).json();console.log({user:c}),c.id&&(i(()=>({user:c})),localStorage.setItem("user",JSON.stringify({...t.user,...c})))},async disconnection(){const s=w.getState().getHeaders();if(!s)return;const t={method:"GET",headers:s.headers};await fetch(`${$}/disconnection`,t),localStorage.removeItem("user"),i(()=>({user:void 0,store:void 0,userStore:void 0,openAuth:!0}))},async getAccess(){window.open(`${$}/google_connexion`,void 0,"popup");const s=setInterval(()=>{const t=localStorage.getItem("user"),a=t&&JSON.parse(t);a&&(console.log("getAccess",{token:a.token}),i(()=>({user:a})),clearInterval(s),w.getState().authenticateUser())},100)},async authenticateUser(){let s=localStorage.getItem("user");const t=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];try{if(s){const a=JSON.parse(s),n=new Headers;n.append("Authorization",`Bearer ${a.token}`);const c={method:"GET",headers:n},r=await fetch(`${$}/can_use_store/${t}`,c);let o;try{if(o=await r.json(),!o.store)return}catch{return}const l=(o==null?void 0:o.user)&&{...a,...o.user};i(()=>({user:l,manager:o.manager,userStore:o.userStore,store:o.store,openAuth:!1})),o!=null&&o.user&&localStorage.setItem("user",JSON.stringify(l));return}}catch{}await w.getState().getStore()},async getStore(){const s=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];if(s){const t=await fetch(`${$}/get_store_by_name/${s}`);try{let a=await t.json();i(()=>({store:a})),console.log(a)}catch{}}},getHeaders(){const s=w.getState().store;if(!s)return;let t=w.getState().user;const a=new Headers;return a.append("Authorization",`Bearer ${t==null?void 0:t.token}`),{store:s,headers:a,user:t}}})),xe=[{u:"products",n:"Home",i:"/src/res/application.png"},{u:"categories",n:"Categories",i:"/src/res/catalog.png"},{u:"favorites",n:"Favorites",i:"/src/res/shopping-cart.png"},{u:"cart",n:"Cart",i:"/src/res/chat.png"},{u:"profile",n:"Prolife",i:"/src/res/chat.png"}],Be={"/":{loading:{},products:{detail:{comments:{},images:{}}},categories:{},favorites:{},cart:{payment:{}},profile:{command:{}}}},Z=K(i=>({T:localStorage.getItem("theme"),storeVar:void 0,usersVar:void 0,back_color:"",blur:!1,openNav:"max",setOpenNav(s){i(()=>({openNav:s}))},setT(s){s&&localStorage.setItem("theme",s),i(()=>({T:s}))},currentChild:void 0,openChild(s,t,a){i(()=>({currentChild:s,blur:t,back_color:s&&a||""}))}})),B=new Te(Be,["/","products"]).getStore(),Ue=(i,s)=>{const t=setInterval(()=>{let a=!1,n=i,c=0;for(;!a;){if(n==document.body){clearInterval(t),s(),a=!0;return}else n==null||c>100?a=!0:n=n.parentElement;c++}},100)},Ee=(i,s)=>t=>{if(!t)return;if(t.dataset.init)return i==null?void 0:i(t.setIndex);t.dataset.init="init:"+Math.trunc(Math.random()*1e3)/1e3;const a=()=>{let n=0;const c=l=>{const d=t.querySelectorAll(".card-h-c");if(n=l,d.length<=0)return;n=n>=d.length?d.length-1:n<0?0:n;const m=t.getBoundingClientRect(),h=m.width,u=d[n].getBoundingClientRect(),j=u.x-m.x+u.width/2;t.scrollTo({behavior:"smooth",left:t.scrollLeft-(h/2-j)})};t.setIndex=c;const r=()=>{const l=t.getBoundingClientRect().width;c(n);const d=t.querySelectorAll(".gap");for(const m of d)m.style.width=`${l/2}px`,m.style.minWidth=`${l/2}px`,m.style.maxWidth=`${l/2}px`};window.addEventListener("resize",r),r();const o=.1;t.addEventListener("scrollend",()=>{const l=t.getBoundingClientRect(),d=l.width,m=d*o,x=t.querySelectorAll(".card-h-c")[n].getBoundingClientRect(),u=x.x-l.x+x.width/2;let j=n;u<d/2-m?(j=n+1,c(j)):u>d/2+m?(j=n-1,c(j)):c(n),s==null||s(j)}),i==null||i(c)};Ue(t,()=>{a()})};class Ae{constructor(s,t,a){this.set(s,t,a)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(s,t,a){this.r=this.clamp(s),this.g=this.clamp(t),this.b=this.clamp(a)}hueRotate(s=0){s=s/180*Math.PI;const t=Math.sin(s),a=Math.cos(s);this.multiply([.213+a*.787-t*.213,.715-a*.715-t*.715,.072-a*.072+t*.928,.213-a*.213+t*.143,.715+a*.285+t*.14,.072-a*.072-t*.283,.213-a*.213-t*.787,.715-a*.715+t*.715,.072+a*.928+t*.072])}grayscale(s=1){this.multiply([.2126+.7874*(1-s),.7152-.7152*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152+.2848*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152-.7152*(1-s),.0722+.9278*(1-s)])}sepia(s=1){this.multiply([.393+.607*(1-s),.769-.769*(1-s),.189-.189*(1-s),.349-.349*(1-s),.686+.314*(1-s),.168-.168*(1-s),.272-.272*(1-s),.534-.534*(1-s),.131+.869*(1-s)])}saturate(s=1){this.multiply([.213+.787*s,.715-.715*s,.072-.072*s,.213-.213*s,.715+.285*s,.072-.072*s,.213-.213*s,.715-.715*s,.072+.928*s])}multiply(s){const t=this.clamp(this.r*s[0]+this.g*s[1]+this.b*s[2]),a=this.clamp(this.r*s[3]+this.g*s[4]+this.b*s[5]),n=this.clamp(this.r*s[6]+this.g*s[7]+this.b*s[8]);this.r=t,this.g=a,this.b=n}brightness(s=1){this.linear(s)}contrast(s=1){this.linear(s,-(.5*s)+.5)}linear(s=1,t=0){this.r=this.clamp(this.r*s+t*255),this.g=this.clamp(this.g*s+t*255),this.b=this.clamp(this.b*s+t*255)}invert(s=1){this.r=this.clamp((s+this.r/255*(1-2*s))*255),this.g=this.clamp((s+this.g/255*(1-2*s))*255),this.b=this.clamp((s+this.b/255*(1-2*s))*255)}hsl(){const s=this.r/255,t=this.g/255,a=this.b/255,n=Math.max(s,t,a),c=Math.min(s,t,a);let r,o,l=(n+c)/2;if(n===c)r=o=0;else{const d=n-c;switch(o=l>.5?d/(2-n-c):d/(n+c),n){case s:r=(t-a)/d+(t<a?6:0);break;case t:r=(a-s)/d+2;break;case a:r=(s-t)/d+4;break}r/=6}return{h:r*100,s:o*100,l:l*100}}clamp(s){return s>255?s=255:s<0&&(s=0),s}}class He{constructor(s,t){this.target=s,this.targetHSL=s.hsl(),this.reusedColor=new Ae(0,0,0)}solve(){const s=this.solveNarrow(this.solveWide());return{values:s.values,loss:s.loss,filter:this.css(s.values)}}solveWide(){const a=[60,180,18e3,600,1.2,1.2];let n={loss:1/0};for(let c=0;n.loss>25&&c<3;c++){const r=[50,20,3750,50,100,100],o=this.spsa(5,a,15,r,1e3);o.loss<n.loss&&(n=o)}return n}solveNarrow(s){const t=s.loss,a=2,n=t+1,c=[.25*n,.25*n,n,.25*n,.2*n,.2*n];return this.spsa(t,c,a,s.values,500)}spsa(s,t,a,n,c){const o=.16666666666666666;let l=null,d=1/0;const m=new Array(6),h=new Array(6),x=new Array(6);for(let j=0;j<c;j++){const _=a/Math.pow(j+1,o);for(let g=0;g<6;g++)m[g]=Math.random()>.5?1:-1,h[g]=n[g]+_*m[g],x[g]=n[g]-_*m[g];const N=this.loss(h)-this.loss(x);for(let g=0;g<6;g++){const q=N/(2*_)*m[g],L=t[g]/Math.pow(s+j+1,1);n[g]=u(n[g]-L*q,g)}const R=this.loss(n);R<d&&(l=n.slice(0),d=R)}return{values:l,loss:d};function u(j,_){let N=100;return _===2?N=7500:(_===4||_===5)&&(N=200),_===3?j>N?j%=N:j<0&&(j=N+j%N):j<0?j=0:j>N&&(j=N),j}}loss(s){const t=this.reusedColor;t.set(0,0,0),t.invert(s[0]/100),t.sepia(s[1]/100),t.saturate(s[2]/100),t.hueRotate(s[3]*3.6),t.brightness(s[4]/100),t.contrast(s[5]/100);const a=t.hsl();return Math.abs(t.r-this.target.r)+Math.abs(t.g-this.target.g)+Math.abs(t.b-this.target.b)+Math.abs(a.h-this.targetHSL.h)+Math.abs(a.s-this.targetHSL.s)+Math.abs(a.l-this.targetHSL.l)}css(s){function t(a,n=1){return Math.round(s[a]*n)}return`invert(${t(0)}%) sepia(${t(1)}%) saturate(${t(2)}%) hue-rotate(${t(3,3.6)}deg) brightness(${t(4)}%) contrast(${t(5)}%)`}}function We(i){const s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;i=i.replace(s,(a,n,c,r)=>n+n+c+c+r+r);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}const he={},P=i=>{if(he[i])return he[i];const s=We(i);if(s.length!==3){alert("Invalid format!");return}const t=new Ae(s[0],s[1],s[2]),n=new He(t).solve(),c={color:t,result:n};return he[i]=c,c},V=K(i=>({commands:void 0,carts:void 0,async deleteCommand(s){const t=w.getState().getHeaders();if(!t)return!1;if((await(await fetch(`${$}/delete_command/${s}`,{headers:t.headers,method:"DELETE"})).json()).deleted){const c=V.getState().carts;return i(()=>({carts:{limit:(c==null?void 0:c.limit)||25,page:(c==null?void 0:c.page)||1,total:(c==null?void 0:c.total)||0,list:((c==null?void 0:c.list)||[]).filter(r=>r.id!=s)}})),!0}return!1},async addProductToCart(s){const t=w.getState().getHeaders();if(!t||!(s.product_id||s.command_id))return;const a=new FormData,n={};a.append("store_id",t.store.id),s.product_id&&a.append("product_id",s.product_id+""),s.command_id&&a.append("command_id",s.command_id+""),s.quantity&&a.append("quantity",s.quantity+""),s.collected_features&&a.append("collected_features",JSON.stringify(s.collected_features));const c=new URLSearchParams({});for(const d in n){const m=n[d];c.set(d,m)}const o=await(await fetch(`${$}/add_command`,{method:"POST",headers:t.headers,body:a})).json();if(!o.id)return;const l=V.getState().carts;return i(()=>({carts:{limit:(l==null?void 0:l.limit)||25,page:(l==null?void 0:l.page)||1,total:(l==null?void 0:l.total)||0,list:[...((l==null?void 0:l.list)||[]).map(d=>d.id==o.id?o:d)]}})),o},async confirmCommand(s){const t=w.getState().getHeaders();if(!t)return!1;const a=new FormData;return s!=null&&s.list&&a.append("list",JSON.stringify(s.list)),(await(await fetch(`${$}/client_confirm_command`,{headers:t.headers,method:"PUT",body:a})).json()).success?(V.getState().fetchCarts({}),V.getState().fetchCommands({}),!0):!1},async fetchCarts(){const s=w.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.status="CART",t.add_favorite=!0;const a=new URLSearchParams({});for(const r in t){const o=t[r];a.set(r,o)}const c=await(await fetch(`${$}/get_commands/?${a.toString()}`,{headers:s.headers})).json();return i(()=>({carts:c})),c},async fetchCommands(){const s=w.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.no_status="CART",t.add_favorite=!0;const a=new URLSearchParams({});for(const r in t){const o=t[r];a.set(r,o)}const c=await(await fetch(`${$}/get_commands/?${a.toString()}`,{headers:s.headers})).json();return i(()=>({commands:c})),console.log(c),c}}));function oe({cart:i,canNull:s,product:t,onChange:a}){var o,l;let[n,c]=p.useState(Number((i==null?void 0:i.quantity)||(t==null?void 0:t.quantity)||0)||0);const{addProductToCart:r}=V();return p.useEffect(()=>{c(Number((i==null?void 0:i.quantity)||(t==null?void 0:t.quantity)||0)||0)},[t,i]),e.jsxs("div",{className:"cart-quantity",onClick:d=>{d.preventDefault(),d.stopPropagation()},children:[e.jsx("div",{className:"min "+(n<=(s?0:1)?"bloc":""),onClick:()=>{let d=parseInt(n+"");d=d-1<(s?0:1)?s?0:1:d-1,c(d),console.log("counter===>>>> ",d),(t||i)&&r({product_id:t==null?void 0:t.id,command_id:i==null?void 0:i.id,quantity:d}).then(()=>{a==null||a(n)})},children:e.jsx("span",{style:{filter:n<=(s?0:1)||!1?P("#fff").result.filter:P("#358f27").result.filter}})}),e.jsx("div",{className:"count",children:n}),e.jsx("div",{className:"max "+(n>=(((o=t||i)==null?void 0:o.stock)||Number.MAX_VALUE)?"bloc":""),onClick:()=>{var m,h,x;let d=parseInt(n+"");d=d<(((m=t||i)==null?void 0:m.stock)||Number.MAX_VALUE)?d:((h=t||i)==null?void 0:h.stock)||Number.MAX_VALUE,d=d+1,!(d>parseInt((((x=t||i)==null?void 0:x.stock)||Number.MAX_VALUE)+""))&&(c(d),(t||t||i)&&r({product_id:t==null?void 0:t.id,command_id:i==null?void 0:i.id,quantity:d}).then(()=>{a==null||a(n)}))},children:e.jsx("span",{style:{filter:n>=(((l=t||i)==null?void 0:l.stock)||Number.MAX_VALUE)?P("#fff").result.filter:P("#358f27").result.filter}})})]})}function Q({detail:i,image:s,title:t}){const{getAccess:a}=w();return e.jsx("div",{className:"page-auth",children:e.jsxs("div",{className:"auth-ctn",onClick:n=>{n.stopPropagation(),n.preventDefault()},children:[e.jsx("div",{className:"image",style:{background:s&&M(s)}}),e.jsxs("div",{className:"form",children:[e.jsx("h1",{className:"auth-title",children:t||"JOIN US NOW"}),e.jsxs("h5",{className:"auth-prompt",children:["Read more ?"," ",e.jsx("span",{onClick:()=>{},children:"Click here"})]}),e.jsxs("div",{className:"google",onClick:()=>{a()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Connexion"})]}),e.jsx("p",{children:i||"Google connexion is required to get access to sublymus service."})]})]})})}const ve=K((i,s)=>({favorites:void 0,setFavorites(t){i(()=>({favorites:t}))},async deleteFavorite(t){const a=w.getState().getHeaders();if(!(a!=null&&a.user))return!1;if((await(await fetch(`${$}/delete_favorite/${t}`,{headers:a.headers,method:"DELETE"})).json()).deleted){const r=s().favorites;return i(()=>({favorites:{limit:(r==null?void 0:r.limit)||25,page:(r==null?void 0:r.page)||1,total:(r==null?void 0:r.total)||0,list:[...(r==null?void 0:r.list)||[]].filter(o=>o.id!=t).map(o=>({...o}))}})),!0}return!1},async addFavorite(t){const a=w.getState().getHeaders();if(!(a!=null&&a.user)||!t.product_id)return;const n=new FormData,c={};n.append("product_id",t.product_id),t.label&&n.append("label",t.label);const r=new URLSearchParams({});for(const m in c){const h=c[m];r.set(m,h)}const l=await(await fetch(`${$}/add_favorite`,{method:"POST",headers:a.headers,body:n})).json();if(!l.id)return;const d=s().favorites;return i(()=>({favorites:{limit:(d==null?void 0:d.limit)||25,page:(d==null?void 0:d.page)||1,total:(d==null?void 0:d.total)||0,list:[...((d==null?void 0:d.list)||[]).map(m=>m.id==l.id?l:m)]}})),l},async fetchFavorites(t){const a=w.getState().getHeaders();if(!(a!=null&&a.user))return;const n={...t};n.store_id=a.store.id,n.add_product=!0;const c=new URLSearchParams({});for(const l in n){const d=n[l];d&&c.set(l,d)}const o=await(await fetch(`${$}/get_favorites/?${c.toString()}`,{headers:a.headers})).json();if(o!=null&&o.list)return t!=null&&t.no_save||i(()=>({favorites:o})),console.log("favorites",o),{...o}}}));function Fe({elm:i,onChange:s}){const{addFavorite:t,deleteFavorite:a}=ve(),{openChild:n}=Z(),c=i.product_id||i.id,[r,o]=p.useState(!1),[l,d]=p.useState(0),[m]=p.useState({});return m.counter=l,m.isOpen=r,e.jsxs("div",{className:"favorites-btn "+(i.favorite?"favorite":"")+" "+(r?"open":""),onClick:()=>{r?(c&&n(e.jsx(ze,{product_id:c,onChange:()=>s==null?void 0:s(i)}),!1,"#3455"),o(!1)):i.favorite?a(i.favorite).then(()=>{s==null||s(i)}):(()=>{o(!0),d(3);const h=setInterval(()=>{console.log(m.counter),m.counter>1&&m.isOpen?d(m.counter-1):(clearInterval(h),m.isOpen&&(o(!1),t({product_id:c,label:"default"}).then(()=>{s==null||s(i)})))},1e3)})()},children:[e.jsx("span",{className:"icon",style:{display:r?"none":"",filter:i.favorite&&P("#c00").result.filter}}),e.jsx("span",{className:"plus",style:{display:r?"":"none",filter:i.favorite&&P("#c00").result.filter}}),e.jsx("span",{className:"down",style:{display:r?"":"none",filter:i.favorite&&P("#c00").result.filter},children:l})]})}function ze({product_id:i,onChange:s}){var h,x;const{openChild:t}=Z(),[a,n]=p.useState(!1),[c,r]=p.useState(""),{addFavorite:o,favorites:l,fetchFavorites:d}=ve(),m=u=>{(u||c)&&(console.log(u,c),o({product_id:i,label:u||c}).then(()=>{s==null||s(),r(""),t(void 0)}))};return p.useEffect(()=>{!(l!=null&&l.labels)&&d({add_labels:!0})}),e.jsx("div",{className:"choise-label",onClick:()=>t(void 0),children:e.jsxs("div",{className:"ctn",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:[e.jsx("h1",{children:"Choise Label"}),e.jsx("div",{className:"list",children:(x=((h=l==null?void 0:l.labels)==null?void 0:h.length)==0?["default"]:l==null?void 0:l.labels)==null?void 0:x.map(u=>e.jsxs("div",{className:"label",style:{borderBottom:`${G(u)} 2px solid`,border:`${G(u)} 2px solid`},onClick:()=>{m(u)},children:[u," ",e.jsx("span",{style:{background:G(u)}})]}))}),a?e.jsx("div",{className:"new-label",children:e.jsxs("label",{htmlFor:"new-label",children:[e.jsx("span",{className:"plus",onClick:()=>{m()}}),e.jsx("input",{type:"text",autoFocus:!0,id:"new-label",value:c,onKeyUp:u=>{console.log(u.code),u.code=="Enter"&&m()},onChange:u=>{r(u.currentTarget.value.toLowerCase().trim())}}),e.jsx("span",{className:"send",onClick:()=>{m()}})]})}):e.jsx("div",{className:"add-new",onClick:()=>{n(!0)},children:"Add New Label"})]})})}function fe({product:i,active:s,onClick:t,aspect:a,mode:n,onRefresh:c}){var x,u,j,_;const{addProductToCart:r}=V(),{openChild:o}=Z(),{user:l}=w(),d=p.useRef(null),[m,h]=p.useState(0);return p.useEffect(()=>{const N=()=>{d.current&&a!=null&&n=="v"&&(d.current.style.height=`${d.current.getBoundingClientRect().width*(a||1)}px`)};return a!=null&&n=="v"&&window.addEventListener("resize",N),d.current&&(!a||n=="h")&&(d.current.style.height=""),N(),()=>{window.removeEventListener("resize",N)}},[d,a,n]),e.jsxs("div",{className:"product-card "+n+" "+(s?"active":""),onClick:t,ref:d,children:[e.jsx("div",{className:"back"}),e.jsxs("div",{className:"images",ref:Ee(void 0,h),children:[e.jsx("div",{className:"gap"}),i.images.map(N=>e.jsx("div",{className:"image card-h-c ",style:{background:M(N)}},N)),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"div",onClick:N=>{N.preventDefault(),N.stopPropagation()},children:l&&e.jsx(Fe,{elm:i,onChange:()=>{c==null||c(i)}})}),e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"counters",children:i.images.map((N,R)=>e.jsx("div",{className:"counter "+(m==R?"active":"")},N))}),e.jsx("div",{className:"price",children:e.jsx("div",{className:"value",children:"12450.93 $"})}),e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((x=i.note)!=null&&x.star?"":"vide")}),e.jsx("div",{className:"note",children:((u=i.note)==null?void 0:u.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((j=i.note)==null?void 0:j.votes)||0}),e.jsx("div",{className:"users"}),!((_=i.note)!=null&&_.star)&&e.jsx("div",{className:"new",children:"New"})]}),e.jsx("div",{className:"add-btn unselectable",onClick:N=>{N.preventDefault(),N.stopPropagation()},children:i.quantity!=null&&i.quantity!=null&&parseInt(i.quantity+"")!=0&&i.quantity.toString()!="0"?e.jsx(oe,{canNull:!0,product:i,onChange:()=>{c==null||c(i)}}):e.jsxs("div",{className:"btn _limit-text",onClick:()=>l?r({product_id:i.id,quantity:1}).then(N=>{N!=null&&N.id&&(c==null||c(i))}):o(e.jsx(Q,{}),!1,"#3455"),children:["Add ",e.jsx("span",{children:" to cart"})]})})]})]})}const te=K((i,s)=>({visites:void 0,product:void 0,products:{limit:25,list:[],page:1,total:0},setProducts(t,a){i(({products:n})=>({products:(n||a)&&{...n,...a,...t}}))},setVisites(t,a){i(({visites:n})=>({visites:(n||a)&&{...n,...a,...t}}))},async setClientVisite(t){const a=w.getState().getHeaders();if(!(a!=null&&a.user))return;const n=new FormData;n.append("product_id",t),await fetch(`${$}/set_client_visited`,{headers:a.headers,body:n,method:"PUT"})},async fetchVisites({after_date:t,before_date:a,client_id:n,product_id:c,limit:r,page:o}){const l=w.getState().getHeaders();if(!l)return;const d={};d.store_id=l.store.id,d.product_id=c||"",d.client_id=n||"",d.limit=r||6,d.page=o||1,d.after_date=t||"",d.before_date=a||"",d.add_favorite=!0;const m=new URLSearchParams({});for(const u in d){const j=d[u];j!=null&&m.set(u,j)}const x=await(await fetch(`${$}/get_client_visited/?${m.toString()}`,{headers:l.headers})).json();!x||!x.list||i(()=>({visites:x}))},featuresCollector:void 0,async setProductById(t){if(!t.product_id)return;const a=s().products,n=a==null?void 0:a.list.find(c=>c.id==t.product_id);if(n)s().selectProduct(n),i(()=>({featuresCollector:n==null?void 0:n.featuresCollector})),console.log(t);else{const c=w.getState().store;if(!c)return;const r={};r.product_id=t.product_id,r.is_features_required=!0,r.store_id=c.id,r.by_product_category=!(a!=null&&a.list[0]);const o=new URLSearchParams({});for(const h in r){const x=r[h];x!=null&&o.set(h,x)}const d=await(await fetch(`${$}/get_products/?${o.toString()}`)).json();if(!d.list)return;const m=d.list.find(h=>h.id==t.product_id)||d.list[0];i(()=>({products:a?{...a,list:[...d.list.filter(h=>!a.list.find(x=>x.id==h.id)),...a.list]}:d,product:m,featuresCollector:m==null?void 0:m.featuresCollector})),s().selectProduct(m)}},fetchProducts:async t=>{const a=w.getState().getHeaders();if(!a)return;const n={...t};n.store_id=a.store.id,n.add_favorite=!0;const c=new URLSearchParams({});for(const l in n){const d=n[l];d!=null&&c.set(l,d)}const o=await(await fetch(`${$}/get_products/?${c.toString()}`,{headers:a.headers})).json();if(o!=null&&o.list)return t!=null&&t.no_save||i(()=>({products:o})),{...o}},async selectProduct(t){if(!t)return i(()=>({product:void 0}));t.features=Oe;const a={};t.features.list.forEach(n=>{var c;n.default_value?a[n.id]=n.default_value:(console.log("nnnnnnnnnn"),a[n.id]=(c=n.components)==null?void 0:c.find(r=>!!r.is_default),n.default_value=a[n.id])}),t.featuresCollector={collectFeature(n,c){c!=null?a[n.id]=c:n.default_value&&(a[n.id]=n.default_value),i(()=>({featuresCollector:t.featuresCollector&&{...t.featuresCollector}}))},getCollectedFeatures(n){return a[n]},allCollectedFeatures(){return a}},i(()=>({product:t})),s().setClientVisite(t.id)}}));function je({note:i}){return e.jsxs("div",{className:"note-stars",children:[e.jsx("div",{className:"icon first "+(i>=1?"full":i<=0?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=2?"full":i<=1?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=3?"full":i<=2?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=4?"full":i<=3?"vide":"half")}),e.jsx("div",{className:"icon "+(i>=5?"full":i<=4?"vide":"half")})]})}const re=K(i=>({comments:void 0,index:void 0,lastPage:void 0,setLastPage(s){i(()=>({lastPage:s}))},setIndex(s){i(()=>({index:s}))},userComment:void 0,async getCommentIndex(s){const t=new URLSearchParams({});for(const c in s){const r=s[c];r!=null&&t.set(c,r)}return await(await fetch(`${$}/get_comment_index/?${t}`)).json()},async sendCommentResponse(s){const t=w.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_comment_id",s.comment_id.toString()),a.append("response",s.response);const c=await(await fetch(`${$}/set_product_comment_response`,{method:"PUT",body:a,headers:t.headers})).json();if(c!=null&&c.id)return i(({comments:r})=>({comments:r&&{...r,list:r.list.map(o=>o.id==s.comment_id?c:o)}})),c},async fetcheditCommentText(s){const t=w.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_comment_id",s.comment_id.toString()),a.append("text",s.text);const c=await(await fetch(`${$}/edit_product_comment_text`,{method:"PUT",body:a,headers:t.headers})).json();if(c!=null&&c.id)return i(({comments:r})=>({comments:r&&{...r,list:r.list.map(o=>o.id==s.comment_id?c:o)}})),c},async deleteComment(s,t){const a=w.getState().getHeaders();if(!a)return;const c=await(await fetch(`${$}/delete_product_comment/${s.id}`,{method:"DELETE",headers:a.headers})).json();if(c!=null&&c.deleted)return t&&setTimeout(()=>{i(({comments:r})=>({comments:r&&{...r,list:r.list.filter(o=>o.id!=s.id)}}))},t),c},async fetchProductComments(s){if(!w.getState().store)return;const a=new URLSearchParams({});for(const r in s){const o=s[r];a.set(r,o)}const c=await(await fetch(`${$}/get_product_comments/?${a.toString()}`)).json();return s!=null&&s.no_save||i(()=>({comments:c})),c},async fetchUserComment(){},async create_product_comment(s){const t=w.getState().getHeaders();if(!t)return;const a=new FormData;a.append("product_id",s.product_id),a.append("note",s.note+""),a.append("text",s.text);for(let r=0;r<s.photos.length;r++)a.append("photos_"+r,s.photos[r]);for(let r=0;r<s.videos.length;r++)a.append("videos_"+r,s.videos[r]);console.log(s);const c=await(await fetch(`${$}/create_product_comment`,{method:"POST",body:a,headers:t.headers})).json();if(c!=null&&c.id)return c}}));function le({comment:i,canOpen:s,onClick:t}){var S,C;const[a,n]=p.useState(!1),[c,r]=p.useState(!1),{userStore:o,manager:l}=w(),{deleteComment:d,sendCommentResponse:m,fetcheditCommentText:h}=re(),x=(l==null?void 0:l.type.toLocaleLowerCase())=="collaborator"||(l==null?void 0:l.type.toLocaleLowerCase())=="owner",[u,j]=p.useState(0),[_,N]=p.useState(!1),[R,g]=p.useState(!1),[q,L]=p.useState(i.text||""),[v,y]=p.useState(i.response||""),E=(o==null?void 0:o.user_id)==i.user_id,[O,J]=p.useState(null);return e.jsxs("div",{ref:J,className:"product-comment",onClick:()=>{t==null||t(),r(!1)},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"photo",style:{background:i.user?M(i.user.photos[0]):""},children:e.jsx("span",{style:{background:(S=i.user)!=null&&S.country_icon?M(i.user.country_icon):""}})}),e.jsxs("div",{className:"coment-right",children:[e.jsxs("div",{className:"flex",style:{flexWrap:"nowrap"},children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"name",children:(C=i.user)==null?void 0:C.name}),e.jsx(je,{note:i.note})]}),(E||x)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"option",onClick:b=>{b.preventDefault(),b.stopPropagation(),r(!c)}}),e.jsxs("div",{className:"ctn-option "+(c?"open":""),onClick:()=>{r(!1)},children:[e.jsx("div",{className:"close",onClick:()=>{r(!1)}}),E&&e.jsx("div",{className:"edit-comment",onClick:()=>{N(!0),g(!1)},children:"Edit Comment"}),x&&e.jsx("div",{className:"edit-response",onClick:()=>{g(!0),N(!1)},children:i.response?"Edit Response":"Add Response"}),e.jsx("div",{className:"delete",onClick:()=>{d(i,300).then(b=>{b!=null&&b.deleted&&(O==null||O.classList.add("deleted"),setTimeout(()=>{O&&(O.style.display="none")},300))})},children:"Delete"})]})]})]}),e.jsx("div",{className:"date",children:new Date(i.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),e.jsx("div",{className:"message",children:_?e.jsxs("label",{htmlFor:"edit-comment-"+i.id,children:[e.jsx("input",{id:"edit-comment-"+i.id,type:"text",value:q,placeholder:"Edit Comment",onChange:b=>{L(b.currentTarget.value)}}),e.jsx("span",{onClick:()=>{g(!1),N(!1),h({comment_id:i.id,text:q}).then(b=>{b!=null&&b.id&&(i.text=b.text,j(u+1))})}})]}):i.text})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),s&&(i.photos_count>0||i.videos_count>0)&&e.jsxs("div",{className:"files-ctn",children:[i.photos.map((b,U)=>e.jsx("div",{style:{background:M(b)+",#4544"},onClick:D=>{D.preventDefault(),D.stopPropagation(),t==null||t({comment:i,relative:U})}},b)),i.videos.map((b,U)=>e.jsx("div",{onClick:D=>{D.preventDefault(),D.stopPropagation(),t==null||t({comment:i,relative:i.photos.length+U})},children:e.jsx("video",{width:60,height:60,src:`${$}${b}`})},b))]})]}),(s&&i.response||R)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"open-response "+(a||R?"open":""),onClick:()=>{n(!a),g(!1),N(!1)},children:[i.response?"Open response":"Add Response",e.jsx("span",{})]}),e.jsx("div",{className:"response "+(a||R?"open":""),children:R?e.jsxs("label",{htmlFor:"edit-response-"+i.id,children:[e.jsx("input",{id:"edit-response-"+i.id,type:"text",value:v,placeholder:"Edit Response",onChange:b=>{y(b.currentTarget.value)}}),e.jsx("span",{onClick:()=>{g(!1),n(!0),m({comment_id:i.id,response:v}).then(b=>{b!=null&&b.id&&(i.response=b.response,j(u+1))})}})]}):i.response})]})]})}function de({posistion:i,size:s,top:t,step:a}){return n=>{if(!n||n.dataset.init)return;n.dataset.init="init",n.style.scrollBehavior="smooth";const c=n.parentElement,r=document.createElement("div");r.style.width=n.style.width,r.style.position="relative",r.append(n),c.append(r);const o=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div");l.className="h-scroll-icon-ctn right",o.className="h-scroll-icon-ctn",s&&(l.style.width=`${s}px`,l.style.height=`${s}px`,o.style.width=`${s}px`,o.style.height=`${s}px`),i&&(l.style.right=`${-i}px`,o.style.left=`${-i}px`),t&&(l.style.top=`${t}px`,o.style.top=`${t}px`),m.className="h-scroll-icon right",d.className="h-scroll-icon",l.append(m),o.append(d),m.style.filter=P("#123").result.filter,d.style.filter=P("#123").result.filter,r.append(l,o);const h=()=>{n.scrollLeft<=0?o.style.display="none":o.style.display="block",n.scrollLeft>=n.scrollWidth-n.getBoundingClientRect().width-30?l.style.display="none":l.style.display="block"};o.addEventListener("click",()=>{a?n.scrollLeft-=a:n.scrollLeft-=n.getBoundingClientRect().width/2}),l.addEventListener("click",()=>{a?n.scrollLeft+=a:n.scrollLeft+=n.getBoundingClientRect().width/2}),n.addEventListener("scroll",h),setTimeout(()=>{h()},500)}}function Ve({product:i,setRef:s,userCommand:t,ImageComments:a,onRefresh:n}){const{userComment:c,comments:r,create_product_comment:o,fetchProductComments:l,setIndex:d}=re(),{openChild:m}=Z(),{user:h}=w(),{navBack:x,qs:u,current:j,json:_}=B(),[N,R]=p.useState([]),[g,q]=p.useState([]),[L,v]=p.useState(""),[y,E]=p.useState(0),[O,J]=p.useState(!1),[S,C]=p.useState(),[b,U]=p.useState(!1),[D,I]=p.useState({order_by:"created_at_desc",order_text:"Date",with_photo:!1,with_video:!1,limit:20,page:1}),[X,z]=p.useState(!1);return p.useEffect(()=>{l({product_id:i.id,...D})},[S,i,D,_]),j("comments")&&e.jsxs("section",{className:"page-comments "+(j("comments")?"open":"close"),ref:s,children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"return",onClick:()=>{x()}}),e.jsx("h1",{children:"Comments"}),e.jsx("div",{className:"option"})]}),e.jsx(qe,{images:a==null?void 0:a.images,more:a==null?void 0:a.more,product:i,onClick:()=>u().keepJson().setAbsPath(["products","detail","images"])}),e.jsxs("div",{className:"write-comment",children:[e.jsxs("div",{className:"top-prompt",children:[" Leave a comment ",e.jsx("span",{})]}),S?e.jsx("div",{children:"Thank you for the comment."}):c?e.jsxs("div",{children:["You have already commented on this product ",e.jsx("span",{onClick:()=>J(!0),children:" see my comment"})]}):t!=null&&t.payment_id?e.jsxs("div",{className:"zone-inputs",children:[e.jsxs("div",{className:"user-rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"icon "+(y>=1?"star":""),onClick:()=>E(1)}),e.jsx("div",{className:"icon "+(y>=2?"star":""),onClick:()=>E(2)}),e.jsx("div",{className:"icon "+(y>=3?"star":""),onClick:()=>E(3)}),e.jsx("div",{className:"icon "+(y>=4?"star":""),onClick:()=>E(4)}),e.jsx("div",{className:"icon "+(y==5?"star":""),onClick:()=>E(5)})]}),e.jsx("div",{className:"value",children:y})]}),!!y&&e.jsxs("label",{htmlFor:"comment-input-text",className:"input-text",children:[e.jsx("input",{id:"comment-input-text",autoFocus:!0,type:"text",value:L,placeholder:"Write Comment",onChange:A=>{v(A.target.value.substring(0,200))}}),e.jsxs("div",{className:"div",children:[L.length,"/200"]})]}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-photo",id:"comment-photo",accept:"image/*",onChange:A=>{if(A.target.files){for(const F of A.target.files)N.unshift(F);R([...N].slice(0,5))}}}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-video",id:"comment-video",accept:"video/*",onChange:A=>{if(A.target.files){for(const F of A.target.files)g.unshift(F);q([...g].slice(0,2))}}}),e.jsxs("div",{className:"files-ctn",style:{display:y&&L?"flex":"none"},children:[e.jsxs("div",{className:"photo-ctn",children:[e.jsxs("label",{htmlFor:"comment-photo",className:"photo",children:[e.jsx("span",{}),"Photo ",N.length,"/5"]}),e.jsx("div",{className:"files-photo",children:N.map(A=>e.jsx("div",{style:{background:M(URL.createObjectURL(A))},children:e.jsx("span",{onClick:()=>{R(N.filter(F=>F!=A))}})},A.name))})]}),e.jsxs("div",{className:"video-ctn",children:[e.jsxs("label",{htmlFor:"comment-video",className:"photo",children:[e.jsx("span",{}),"Video ",g.length,"/2"]}),e.jsx("div",{className:"files-video",children:g.map(A=>e.jsxs("div",{children:[e.jsx("video",{width:80,height:80,src:URL.createObjectURL(A)}),e.jsx("span",{onClick:()=>{q(g.filter(F=>F!=A))}})]},A.name))})]})]}),e.jsxs("div",{className:"send-comment "+(b?"loading":""),children:[e.jsx("span",{className:"text "+(L.trim()?"":"no"),onClick:()=>{if(!h)return m(e.jsx(Q,{}),!1,"#3455");y&&L&&(U(!0),o({note:y,photos:N,product_id:i.id,text:L,videos:g}).then(A=>{U(!1),A!=null&&A.id&&(C(A),n==null||n())}))},children:"Send"})," ",e.jsx("span",{className:"loading"})]})]}):e.jsx("div",{children:"Comments are allowed after purchasing the product"})]}),e.jsx("div",{className:"my-comment",children:c&&e.jsx(le,{comment:c,canOpen:!0})}),e.jsxs("div",{className:"filter",children:[e.jsxs("div",{className:"date active",onClick:()=>{z(!X)},children:[D.order_text,e.jsx("span",{className:D.order_by.includes("desc")?"desc":""}),e.jsxs("div",{className:X?"open":"",children:[e.jsxs("div",{onClick:()=>I({...D,order_by:"created_at_desc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>I({...D,order_by:"created_at_asc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:""})]}),e.jsxs("div",{onClick:()=>I({...D,order_by:"note_desc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>I({...D,order_by:"note_asc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:""})]})]})]}),e.jsx("div",{className:"photo "+(D.with_photo?"active":""),onClick:()=>I({...D,with_photo:!D.with_photo}),children:"With Photo"}),e.jsx("div",{className:"video "+(D.with_video?"active":""),onClick:()=>I({...D,with_video:!D.with_video}),children:"With Video"})]}),e.jsx("div",{className:"comments",children:r==null?void 0:r.list.map(A=>e.jsx(le,{comment:A,canOpen:!0,onClick:F=>{const ie=F==null?void 0:F.comment;ie&&(u().keepJson().setAbsPath(["products","detail","images"]),d({comment:ie,relative:F.relative}))}},A.id))})]})}function Ie({product:i}){var v,y,E,O,J;const{current:s,navBack:t,pathList:a}=B(),{getCommentIndex:n,index:c,setIndex:r}=re(),[o,l]=p.useState(null),[d,m]=p.useState((c==null?void 0:c.relative)||0),[h,x]=p.useState(),[u]=p.useState({}),[j,_]=p.useState(!1),[N,R]=p.useState({move:"",comment_id:c==null?void 0:c.comment.id});p.useEffect(()=>{s("images")&&i&&n({product_id:i.id,comment_id:N.comment_id||(c==null?void 0:c.comment.id),move:N.move||void 0}).then(S=>{var C;if(console.log({res:S}),(C=S==null?void 0:S.comment)!=null&&C.id){if(N.move=="back")m(S.comment.photos_count+S.comment.videos_count-1);else if(N.move=="next")m(0);else{let b=((c==null?void 0:c.relative)??d)||0;const U=S.comment.photos_count+S.comment.videos_count;b=b<=0?0:b>=U-1?U-1:b,m(b)}N.move="",N.comment_id=void 0,x(S)}})},[N,c,a]),p.useEffect(()=>{s("images")&&(R({comment_id:void 0,move:""}),x(void 0),console.log({commentIndex:h}))},[i,a]),p.useEffect(()=>{u.init||(u.init=!0,window.addEventListener("keyup",S=>{S.code=="ArrowRight"?u.moveNext():S.code=="ArrowLeft"&&u.moveBack()}))},[]);const g=()=>{d<=0?(console.log("back comment "),h&&R({...N,comment_id:h.comment.id,move:"back"})):(console.log("back image "),m(d-1))},q=()=>{d>=L.length-1?(console.log("next comment "),h&&R({...N,comment_id:h.comment.id,move:"next"})):(console.log("next image "),m(d+1))};u.moveNext=q,u.moveBack=g;const L=[...((v=h==null?void 0:h.comment)==null?void 0:v.photos)||[],...((y=h==null?void 0:h.comment)==null?void 0:y.videos)||[]];return s("images")&&!(h!=null&&h.comment)?e.jsxs("div",{className:"image-not-found",children:[e.jsx("p",{className:"text",children:"no images or videos found for this product."}),e.jsxs("div",{onClick:()=>t(),children:[e.jsx("span",{}),"go back"]})]}):s("images")&&(h==null?void 0:h.comment)&&e.jsxs("section",{className:"page-comment-image "+(s("images")?"open":"close"),children:[e.jsxs("div",{className:"page-top",children:[e.jsx("div",{className:"return",style:{filter:P("#fff").result.filter},onClick:()=>t()}),e.jsxs("div",{className:"count",children:[((h==null?void 0:h.befor)||0)+d," / ",(h==null?void 0:h.total)||0]})]}),e.jsxs("div",{className:"file-view _flex _center",children:[d>(((E=h==null?void 0:h.comment)==null?void 0:E.photos_count)||0)-1?e.jsx("div",{className:"video _flex",ref:S=>{if(!S||S.dataset.init)return;S.dataset.init="init",l(S);const C=()=>{const b=S.querySelector("video"),U=S.getBoundingClientRect();b.width=U.width};window.addEventListener("resize",C)},children:e.jsx("video",{loop:!0,autoPlay:!0,controls:!0,width:o==null?void 0:o.getBoundingClientRect().width,src:`${$}${L[d]}`})}):e.jsx("div",{className:"photo",children:e.jsx("div",{className:"img",style:{background:M(L[d],"100%")}})}),e.jsx("div",{className:"move-next",onClick:q,children:e.jsx("div",{className:"next",children:e.jsx("span",{})})}),e.jsx("div",{className:"move-back",onClick:g,children:e.jsx("div",{className:"back",children:e.jsx("span",{})})})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"top _flex _wrap",children:[e.jsx("div",{className:"name",children:se(((O=h==null?void 0:h.comment.user)==null?void 0:O.name)||"",50)}),e.jsxs("div",{className:"_flex  _l-auto",children:[e.jsx(je,{note:((J=h==null?void 0:h.comment)==null?void 0:J.note)||0}),e.jsx("div",{className:"open",onClick:()=>_(!0),children:"Open"})]})]}),e.jsx("div",{className:"message",children:se((h==null?void 0:h.comment.text)||"",100)}),e.jsxs("div",{className:"preview-comment "+(j?"open":"close"),children:[e.jsx("div",{className:"close",onClick:()=>{_(!1)}}),e.jsx(le,{comment:h.comment,canOpen:!0,onClick:S=>{const C=S==null?void 0:S.comment;C&&r({comment:C,relative:S.relative})}})]})]})]})}function Ne({mode:i}){const{pathList:s,qs:t}=B(),{visites:a,fetchVisites:n,setVisites:c,fetchProducts:r}=te(),{openChild:o}=Z(),{user:l}=w(),d=m=>{r({product_id:m.id,no_save:!0}).then(h=>{if(h!=null&&h.list[0].id){const x={...h==null?void 0:h.list[0]};c({...a,list:a==null?void 0:a.list.map(u=>u.id==x.id?x:u)})}})};return p.useEffect(()=>{!a&&l&&n({})},[l,s]),e.jsxs("div",{className:"comp-visites "+(i||"h"),children:[e.jsxs("h1",{className:"title",children:["Products Visited",e.jsx("span",{})]}),e.jsxs("div",{className:"list",ref:de({posistion:20}),children:[!l&&e.jsx("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>o(e.jsx(Q,{}),!0,"#fffc"),children:"Connexion required"}),a==null?void 0:a.list.map(m=>e.jsx(fe,{aspect:i=="v"?1.4:void 0,mode:"inlist",product:m,onClick:()=>{t({product_id:m.id}).setAbsPath(["products","detail"])},onRefresh:h=>{d(h)}},m.id))]})]})}function ge({mode:i}){const{qs:s}=B(),{product:t,fetchProducts:a}=te(),{store:n}=w(),[c,r]=p.useState();p.useEffect(()=>{a({no_save:!0,category_id:t==null?void 0:t.category_id}).then(l=>{l!=null&&l.list&&r(l)})},[t,n]);const o=l=>{c&&a({product_id:l.id,no_save:!0,lol:!0}).then(d=>{if(d!=null&&d.list[0].id){const m={...d==null?void 0:d.list[0]};c&&r({...c,list:c.list.map(h=>h.id==m.id?m:h)})}})};return e.jsxs("div",{className:"more-products "+(i||"h"),children:[e.jsxs("h1",{className:"title more",children:["More Products",e.jsx("span",{})]}),e.jsx("div",{className:"list",ref:de({posistion:20}),children:c==null?void 0:c.list.map(l=>e.jsx(fe,{aspect:i=="v"?1.4:void 0,mode:"inlist",product:l,active:(t==null?void 0:t.id)==l.id,onClick:()=>{s({product_id:l.id}).setAbsPath(["products","detail"])},onRefresh:d=>{o(d)}},l.id))})]})}let H;function Je({onRefresh:i}){var be,we,Ce,ke;const{json:s,qs:t,check:a,current:n,navBack:c,pathList:r}=B(),{setProductById:o,product:l,selectProduct:d,products:m,fetchProducts:h,setProducts:x}=te(),{fetchProductComments:u,setLastPage:j}=re(),{addProductToCart:_}=V(),{user:N}=w(),{openChild:R}=Z(),g=p.useRef(null),q=p.useRef(null),L=p.useRef(null),[v,y]=p.useState(!0),[E,O]=p.useState(0),[J,S]=p.useState(!1),[C,b]=p.useState(),[U,D]=p.useState(!1),[I]=p.useState(),[X]=p.useState({payment_id:"lol"}),[z,A]=p.useState(null),[F,ie]=p.useState(),[Y,Le]=p.useState(),[ye]=p.useState({}),[ae]=p.useState({current:null}),me=()=>{if(!ae.current)return;const f=ae.current.getBoundingClientRect(),k=ae.current.querySelectorAll(".img");let T=f.width-60;T=T>400?400:T;for(const W of k)W.style.height=`${T/1.295}px`,W.style.width=`${T}px`,W.style.minWidth=`${T}px`};me(),p.useEffect(()=>{a("detail")&&(s!=null&&s.product_id)&&s.product_id!=ye.product_id&&(ye.product_id=s.product_id,o(s))},[s]),p.useEffect(()=>{l&&a("detail")&&(L.current&&(L.current.scrollTop=0),S(!1),O(0),H==null||H(0),t().keepJson().setAbsPath(["products","detail"]))},[l]),p.useEffect(()=>{l&&a("detail")&&(console.log("new Comments fech"),u({product_id:l.id,no_save:!0,limit:4}).then(f=>ie(f)),u({product_id:l.id,no_save:!0,with_photo:!0,limit:5}).then(f=>{const k=f==null?void 0:f.list.map(T=>T.photos).flat();return Le({images:(k==null?void 0:k.slice(0,5))||[],more:((k==null?void 0:k.length)||0)>5})}))},[l,r]),p.useEffect(()=>(window.addEventListener("resize",me),()=>{window.removeEventListener("resize",me)}),[]),p.useEffect(()=>{if(z){if(z.dataset.init)return;z.dataset.init="init",z.addEventListener("scroll",()=>{z.scrollTop>200?D(!0):D(!1)})}},[z]);const _e=()=>{l&&h({add_cart:!0,product_id:l.id,no_save:!0}).then(f=>{if(f!=null&&f.list[0].id){const k={...f==null?void 0:f.list[0]};m&&x({...m,list:m==null?void 0:m.list.map(T=>T.id==(f==null?void 0:f.list[0].id)?k:T)}),(l==null?void 0:l.id)==(f==null?void 0:f.list[0].id)&&d(k)}})};return l&&e.jsxs("div",{className:"detail-product "+(l?"open":""),children:[l&&e.jsx(Ve,{onRefresh:i,ImageComments:Y,userComment:I,userCommand:X,setRef:A,product:l}),l&&e.jsx(Ie,{product:l}),e.jsxs("section",{className:"detail "+(n("products")||n("detail")?"open":"close"),ref:L,children:[e.jsxs("div",{className:"top-top _flex",children:[e.jsx("div",{className:"return",ref:f=>{if(!f||f.dataset.init)return;f.dataset.init="init";const k=()=>{window.innerWidth>940?f.style.display=" none":f.style.display="flex"};window.addEventListener("resize",k),k()},onClick:()=>{d(void 0),c()}}),e.jsx("div",{className:"label _lr-auto",children:"Detail Product"})]}),e.jsxs("div",{className:"top-infos",ref:f=>{if(!f||f.dataset.init)return;f.dataset.init="init";const k=f.querySelector(".images"),T=f.querySelector(".infos"),W=()=>{f.getBoundingClientRect().width<700?(f.style.flexWrap="wrap",k.style.width="",k.style.minWidth="",k.style.maxWidth="",T.style.width="",T.style.minWidth="",T.style.maxWidth=""):(f.style.flexWrap="",k.style.width="50%",k.style.minWidth="50%",k.style.maxWidth="50%",T.style.width="50%",T.style.minWidth="50%",T.style.maxWidth="50%")};window.addEventListener("resize",W),setTimeout(()=>{W(),H==null||H(0)},200)},children:[e.jsxs("div",{className:"images",children:[e.jsxs("div",{className:"list",ref:f=>{Ee(k=>{H=k},O)(f),ae.current=f},children:[e.jsx("div",{className:"gap"}),l==null?void 0:l.images.map((f,k)=>e.jsx("div",{className:"img card-h-c "+(E==k?"active":""),style:{background:M(f)},onClick:()=>{H==null||H(k),O(k)}},f+(l==null?void 0:l.id))),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"min-list",children:l==null?void 0:l.images.map((f,k)=>e.jsx("div",{className:"min-img "+(E==k?"active":""),style:{background:M(f)},onClick:()=>{O(k),H==null||H(k)}},f+(l==null?void 0:l.id)))})]}),e.jsx("div",{className:"infos",ref:g,children:e.jsxs("div",{className:"diff",ref:q,children:[e.jsxs("div",{className:"text "+(C&&v?"min":""),children:[e.jsxs("div",{className:"title",children:[l==null?void 0:l.title,e.jsx("span",{})]}),e.jsx("p",{className:"description",children:((l==null?void 0:l.description.length)||0)>100&&!J?e.jsxs(e.Fragment,{children:[se((l==null?void 0:l.description)||"",100)," ",e.jsx("span",{onClick:()=>S(!0),children:"Read more"})]}):(l==null?void 0:l.description)||""})]}),(l==null?void 0:l.features)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"label-features",children:["Features",e.jsxs("span",{children:[" ",(C==null?void 0:C.name)&&" : "+(C==null?void 0:C.name)]})," ",C&&e.jsx("span",{className:"close",style:{filter:((be=P("#112233"))==null?void 0:be.result.filter)||""},onClick:()=>{b(void 0)}})]}),e.jsx("div",{className:"features",children:l==null?void 0:l.features.list.map(f=>{var k;return e.jsxs("div",{className:"feature "+((C==null?void 0:C.id)==f.id?"active":""),style:{filter:((k=P("#358f27"))==null?void 0:k.result.filter)||""},onClick:()=>{var T,W;if(!C){const ee=((T=g.current)==null?void 0:T.getBoundingClientRect().height)||0,ne=((W=q.current)==null?void 0:W.getBoundingClientRect().height)||0;ee-ne<150?y(!0):y(!1)}(C==null?void 0:C.id)==f.id?b(void 0):b(f)},children:[e.jsx("div",{className:"icon",style:{background:M(f.icon)}}),e.jsx("div",{className:"label",children:se(f.name,10)})]},f.id)})})]}),C&&e.jsxs("div",{className:"label-components",children:["Components: ",e.jsx("span",{children:(Ce=(we=l==null?void 0:l.featuresCollector)==null?void 0:we.allCollectedFeatures()[C.id])==null?void 0:Ce.name})]}),e.jsx("div",{className:"components "+(C?"open":""),children:(ke=C==null?void 0:C.components)==null?void 0:ke.map(f=>{var k,T;return e.jsxs("div",{className:"component "+(((T=(k=l==null?void 0:l.featuresCollector)==null?void 0:k.allCollectedFeatures()[C.id])==null?void 0:T.id)==f.id?"active":""),onClick:()=>{var W,ee,ne,Se;((ee=(W=l==null?void 0:l.featuresCollector)==null?void 0:W.allCollectedFeatures()[C.id])==null?void 0:ee.id)==f.id?(ne=l==null?void 0:l.featuresCollector)==null||ne.collectFeature(C,void 0):(Se=l==null?void 0:l.featuresCollector)==null||Se.collectFeature(C,f)},children:[e.jsx("div",{className:"icon",style:{background:M(f.icon[0],"contain")}}),e.jsx("div",{className:"label",children:se(f.name,10)})]})})})]})})]}),e.jsxs("div",{className:"detail-box",children:[e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"title",children:["product reviews",e.jsx("span",{})]}),l&&e.jsx(qe,{images:Y==null?void 0:Y.images,more:Y==null?void 0:Y.more,onClick:()=>{j(""),t().keepJson().setAbsPath(["products","detail","images"])},product:l}),e.jsxs("div",{className:"title",children:["Comments",e.jsx("span",{})]}),e.jsxs("div",{className:"min-comments",ref:de({posistion:20}),children:[F==null?void 0:F.list.map(f=>e.jsx(le,{comment:f,onClick:()=>{t().keepJson().setAbsPath(["products","detail","comments"])}},f.id)),e.jsxs("div",{className:"more-comment "+(F!=null&&F.list.length||0>0?"":"horizontal"),onClick:()=>{t().keepJson().setAbsPath(["products","detail","comments"])},children:[e.jsx("div",{className:"icon "+(F!=null&&F.list.length||0>0?"":"add"),children:e.jsx("span",{style:{filter:P("#ffffff").result.filter}})}),e.jsx("div",{className:"label",children:F!=null&&F.list.length||0>0?"More":"Add First Comment"})]})]})]}),e.jsx(Ne,{}),e.jsx(ge,{})]})]}),n("detail")&&e.jsx("div",{className:"price-zone",children:e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"price",children:[e.jsx("div",{children:"Price"}),e.jsxs("div",{className:"value",children:[(l==null?void 0:l.price)||0," $"]})]}),l.quantity!=null&&l.quantity!=null&&parseInt(l.quantity+"")!=0&&l.quantity.toString()!="0"?e.jsx(oe,{canNull:!0,product:l,onChange:()=>{_e()}}):e.jsxs("div",{className:"add-to-cart",onClick:()=>N?_({product_id:l.id,quantity:1}).then(f=>{f!=null&&f.id&&_e()}):R(e.jsx(Q,{}),!1,"#3455"),children:["Add ",e.jsx("span",{children:" to cart"})]})]})}),n("comments")&&(U||(X==null?void 0:X.payment_id)&&!I)&&e.jsxs("div",{className:"write-zone",children:[U&&e.jsx("div",{className:"up-icon",onClick:()=>{z&&(z.scrollTop=0)},children:e.jsx("span",{})}),e.jsx("div",{className:"write-icon",children:e.jsx("span",{})})]})]})}function qe({product:i,onClick:s,images:t,more:a}){const{qs:n}=B();return e.jsxs("div",{className:"group-file-rating",children:[e.jsx("div",{className:"after-order",children:e.jsxs("div",{className:"ctn-mini-files",onClick:s,children:[t==null?void 0:t.map((c,r)=>e.jsx("div",{className:"w",children:e.jsx("div",{className:"mini-file",style:{background:M(c)}})},r)),a&&e.jsx("div",{className:"back",style:{background:(t==null?void 0:t[0])&&M(t==null?void 0:t[0])},children:e.jsx("div",{className:"more-files",children:"+ More"})})]})}),(i==null?void 0:i.note)&&e.jsxs("div",{className:"rating",onClick:()=>n().keepJson().setAbsPath(["products","detail","comments"]),children:[e.jsx("div",{className:"note",children:i.note.star}),e.jsx(je,{note:i.note.star}),e.jsxs("div",{className:"vote",children:[i.note.votes," ",e.jsx("span",{})]})]})]})}const Ge=K(i=>({categories:void 0,async fetchCategoies(s){const t=w.getState().store;if(!t)return;const a={...s};a.store_id=t.id;const n=new URLSearchParams({});for(const o in a){const l=a[o];n.set(o,l)}const r=await(await fetch(`${$}/get_categories/?${n.toString()}`)).json();if(r!=null&&r.list)return s!=null&&s.no_save||i(()=>({categories:r})),{...r}}}));let ce="";/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?ce="mobile-device":ce="not-mobile-device";document.body.classList.add(ce);const Pe=ce,Xe=(i,s)=>{let t=!1;for(const a in s)i[a]!=s[a]&&(t=!0,i[a]=s[a]);return delete i.product_id,t};function Ye(){const{json:i,qs:s,check:t,pathList:a}=B(),{products:n,fetchProducts:c,selectProduct:r,product:o,setProducts:l}=te(),{store:d}=w(),[m,h]=p.useState({order_by:"date_desc",category_id:"",limit:18,add_cart:!0,lol:!0,is_features_required:!0,price_min:void 0,price_max:void 0,text:"",product_id:""}),{fetchCategoies:x}=Ge(),[u,j]=p.useState(),[_]=p.useState({}),[N,R]=p.useState(!1);p.useEffect(()=>{t("products")&&c({...m}).then(v=>{v!=null&&v.list[0]&&!o&&window.innerWidth>940&&(r(v==null?void 0:v.list[0]),s({...i,product_id:v.list[0].id}).setAbsPath(["products","detail"]))})},[m,d,a]),p.useEffect(()=>{!u&&x({limit:25,no_save:!0}).then(v=>{v!=null&&v.list&&j(v)})},[d]),p.useEffect(()=>{t("products")&&Xe(m,i||{})&&h({...m})},[i]),p.useEffect(()=>{window.addEventListener("resize",()=>{var v;window.innerWidth>940&&!_.product&&r((v=_.products)==null?void 0:v.list[0])})},[]),_.product=o,_.products=n;const[g,q]=p.useState("");p.useEffect(()=>{window.addEventListener("resize",()=>{q(`${window.innerWidth} / ${window.innerHeight}  / ${window.screen.height} => ${Pe}`)}),q(`${window.innerWidth} / ${window.innerHeight} / ${window.devicePixelRatio}  => ${Pe}`)},[]);const L=v=>{n&&c({add_cart:!0,product_id:v.id,no_save:!0,lol:!0,is_features_required:!0}).then(y=>{if(y!=null&&y.list[0].id){const E={...y==null?void 0:y.list[0]};n&&l({...n,list:n.list.map(O=>O.id==E.id?E:O)})}})};return t("products")&&e.jsxs("div",{className:"page-products",children:[e.jsx("div",{className:"left "+(N?"open":"")+" "+(t("detail")&&o?"product-detail":""),onClick:()=>{R(!1)},children:e.jsxs("div",{className:"filter-fram",children:[e.jsx("div",{className:"top",children:"Filter"}),e.jsx("div",{className:"categories",children:u==null?void 0:u.list.map(v=>e.jsx("div",{className:"category",onClick:()=>h({...m,category_id:v.id}),children:v.label},v.id))}),e.jsxs("div",{className:"prices",children:[e.jsxs("div",{className:"ctn",children:[e.jsx("label",{htmlFor:"product-price-min",children:e.jsx("input",{type:"text",id:"product-price-min",placeholder:"Min",value:m.price_min})}),e.jsx("label",{htmlFor:"product-price-max",children:e.jsx("input",{type:"text",id:"product-price-max",placeholder:"Max",value:m.price_max})})]}),e.jsx("div",{className:"set-price",children:e.jsx("div",{className:"btn",children:"Set Price"})})]})]})}),e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"search-zone",children:[e.jsxs("label",{htmlFor:"product-search",className:"search",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{id:"product-search",type:"text",placeholder:"Search Product",value:m.text,onChange:v=>{h({...m,text:v.currentTarget.value})}}),e.jsx("div",{className:"clear",onClick:()=>{h({...m,text:""})}})]}),e.jsx("div",{className:"search-text",children:m.text&&e.jsxs(e.Fragment,{children:['Search result for "',e.jsx("span",{children:m.text}),'"']})}),e.jsxs("div",{className:"sort",children:[e.jsx("div",{className:"label",onClick:()=>{R(!0)},children:"Sort"}),e.jsx("div",{className:"list",children:["date","name","price","popular"].map(v=>{var y;return e.jsx("div",{className:((y=(i==null?void 0:i.order_by)||m.order_by)==null?void 0:y.split("_")[0])==v?"active":"",onClick:()=>{s({...i,order_by:v+"_desc"}).apply()},children:v},v)})})]})]}),e.jsx("div",{className:"list",children:n==null?void 0:n.list.map(v=>e.jsx(fe,{canAddToCart:v.title.includes("321"),product:v,active:(o==null?void 0:o.id)==v.id,onClick:()=>{r({...v}),s({...i,product_id:v.id}).setAbsPath(["products","detail"])},onRefresh:y=>{L(y)}},v.id))})]}),e.jsx("div",{className:"right "+(o?"product":"")+" "+(t("detail")?"detail":""),children:e.jsx(Je,{onRefresh:()=>{o&&L(o)}})})]})}function Ke(){var x;const{setAbsPath:i,pathList:s}=B(),[t,a]=p.useState(s[1]||"home"),[n,c]=p.useState(!1),[r,o]=p.useState(!1),{user:l,getAccess:d}=w(),m=Re(),h=u=>{i([u]),a(u)};return p.useEffect(()=>{a(s[1]||"home")},[s]),p.useEffect(()=>{window.addEventListener("click",()=>{const u=document.querySelector(".top-bar .more-navs ul");(u==null?void 0:u.className)==""&&o(!1)})},[]),e.jsxs("div",{className:"top-bar",ref:De(80,".web"),children:[e.jsxs("div",{className:"top-bar-ctn",children:[e.jsx("div",{className:"left",children:e.jsx("a",{href:"#products",className:"logo-ctn",onClick:u=>{u.preventDefault(),u.stopPropagation(),h("products")},children:e.jsx("div",{className:"icon"})})}),e.jsx("ul",{className:"top-bar-center",children:xe.map((u,j)=>j*150<m.width-400?e.jsxs("li",{className:t==u.u?"active":"",onClick:()=>{h(u.u)},children:[e.jsx("span",{}),u.n]},j):null)}),e.jsxs("div",{className:"right",children:[e.jsx("div",{className:"ctn-icon",onClick:u=>{u.preventDefault(),u.stopPropagation(),o(!r)},children:e.jsx("div",{className:"icon",style:{filter:P("#345").result.filter}})}),l?e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${(x=l==null?void 0:l.photos[0])!=null&&x.startsWith("/")?$:""}${l==null?void 0:l.photos}),#bbb`},onClick:()=>{h("profile")}}):e.jsx("div",{className:"login",onClick:()=>d(),children:"Se connecter"})]})]}),e.jsx("div",{className:"more-navs",onClick:u=>{u.preventDefault(),u.stopPropagation()},children:e.jsxs("ul",{className:r?"":"close",children:[xe.map((u,j)=>j*150>=m.width-400?e.jsxs("li",{className:t==u.u?"active":"",onClick:()=>{h(u.u),o(!r)},children:[e.jsx("span",{}),u.n]},j):null),e.jsxs("li",{className:t=="mode-lite"?"active":"",style:{whiteSpace:"nowrap"},onClick:()=>{c(!n)},children:[e.jsx("span",{}),n?"Lite mode off":"Lite mode on"]})]})})]})}function Ze(){const{check:i,setAbsPath:s}=B();return e.jsx("div",{className:"bottom-nav",children:e.jsx("ul",{children:xe.map((t,a)=>e.jsxs("li",{className:t.u+" "+(i(t.u)?"active":""),onClick:()=>s([t.u]),children:[e.jsx("span",{className:"label",children:t.n}),e.jsx("span",{className:"icon "+t.u})]},a))})})}function Qe(){const{check:i}=B();return i("categories")&&e.jsx("div",{className:"page-categories"})}function es(){var h;const{pathList:i,check:s,navBack:t}=B(),{user:a}=w(),{favorites:n,fetchFavorites:c,setFavorites:r,deleteFavorite:o}=ve(),{addProductToCart:l}=V();console.log({favorites:n});const[d,m]=p.useState("All");return p.useEffect(()=>{c({add_labels:!0,label:d=="All"?void 0:d})},[a,i,d]),s("favorites")&&(a?e.jsxs("div",{className:"page-favorites",children:[e.jsxs("div",{className:"top-favorites _flex",children:[e.jsx("div",{className:"return",onClick:()=>{t()}}),e.jsx("div",{className:"label _lr-auto",children:"Favorites"})]}),e.jsxs("div",{className:"favorites-ctn",children:[e.jsxs("div",{className:"left",children:[e.jsxs("div",{className:"filter-by",ref:de({posistion:20}),children:[e.jsx("h4",{children:"labels : "}),e.jsx("span",{className:"label "+(d=="All"?"all":""),onClick:()=>{m("All")},children:"All"}),(h=n==null?void 0:n.labels)==null?void 0:h.map(x=>e.jsx("span",{className:"label",style:{background:d==x?G(x):"",boxShadow:`${G(x)} 0px 0px 3px, ${G(x)} 0px 0px 3px, ${G(x)} 0px 0px 3px`},onClick:()=>{m(x)},children:x}))]}),n==null?void 0:n.list.map(x=>e.jsx(ss,{favorite:x,onQuantityChange:()=>{c({favorite_id:x.id}).then(u=>{if(u!=null&&u.list[0]){const j=u==null?void 0:u.list[0];n&&r({...u,list:n.list.map(_=>_.id==x.id?j:_)})}})},addProductToCart:()=>{x.product&&l({product_id:x.product.id,quantity:1}).then(u=>{u!=null&&u.id&&c({favorite_id:x.id}).then(j=>{if(j!=null&&j.list[0]){const _=j==null?void 0:j.list[0];n&&r({...j,list:n.list.map(N=>N.id==x.id?_:N)})}})})},onDelete:()=>{o(x.id)}},x.id))]}),e.jsx("div",{className:"right"})]}),e.jsx(Ne,{}),e.jsx(ge,{})]}):e.jsx("div",{className:"page-favorites",children:e.jsx(Q,{detail:"Google connexion is required to access your favorites"})}))}function ss({favorite:i,onClick:s,changeLabel:t,onDelete:a,onShare:n,onQuantityChange:c,addProductToCart:r}){var d,m,h,x,u,j;const o=i.product,{qs:l}=B();return console.log(i.id,(o==null?void 0:o.quantity)!=null,(o==null?void 0:o.quantity)!=null,parseInt((o==null?void 0:o.quantity)+"")!=0,((d=o==null?void 0:o.quantity)==null?void 0:d.toString())!="0"),o&&e.jsx("div",{className:"favorites-item",onClick:()=>{s==null||s(i),l({product_id:i.product_id}).setAbsPath(["products","detail"])},children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:M(o.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:o.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:o.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((m=o.note)!=null&&m.star?"":"vide")}),e.jsx("div",{className:"note",children:((h=o.note)==null?void 0:h.star)||0}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:((x=o.note)==null?void 0:x.votes)||0}),e.jsx("div",{className:"users"}),!((u=o.note)!=null&&u.star)&&e.jsx("div",{className:"new",children:"New"})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[o.price.toLocaleString()," ","$"]})}),o.quantity!=null&&o.quantity!=null&&parseInt(o.quantity+"")!=0&&((j=o.quantity)==null?void 0:j.toString())!="0"?e.jsx(oe,{canNull:!0,product:o,onChange:_=>{c==null||c(_)}}):e.jsxs("div",{className:"add-btn",onClick:_=>{r(),_.stopPropagation(),_.preventDefault()},children:["Add ",e.jsx("span",{children:" to cart"})]})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},onClick:_=>{_.stopPropagation(),_.preventDefault()},children:[e.jsx("div",{style:{filter:P("#123").result.filter},className:"delete",onClick:()=>{a==null||a(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:P("#123").result.filter},className:"share",onClick:()=>n==null?void 0:n(i),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"label",style:{background:G(i.label)},onClick:_=>{t==null||t(i),_.stopPropagation(),_.preventDefault()},children:[i.label," "]})]})]})]})})}function ts(){const{check:i,pathList:s,navBack:t,qs:a}=B(),{visites:n,fetchVisites:c}=te(),{current:r}=B(),{user:o}=w(),{carts:l,fetchCarts:d,deleteCommand:m,confirmCommand:h}=V(),[x,u]=p.useState(0),[j,_]=p.useState(0),[N,R]=p.useState(0),[g,q]=p.useState((l==null?void 0:l.list.map(v=>v))||[]),[L]=p.useState({});return L.selecteds=g,p.useEffect(()=>{let v=0,y=0;g.forEach(E=>{v+=Number(E.quantity),y+=E.price*E.quantity}),_(y),R(v)},[x,g]),p.useEffect(()=>{q((l==null?void 0:l.list.filter(v=>!!L.selecteds.find(y=>y.id==v.id)))||[])},[l]),p.useEffect(()=>{o&&r("cart")&&d({}).then(v=>{v!=null&&v.list&&q(v.list)}),!n&&o&&r("cart")&&c({})},[o,s]),i("cart")&&(o?e.jsxs("div",{className:"page-cart",children:[e.jsxs("div",{className:"top-cart _flex",children:[e.jsx("div",{className:"return",onClick:()=>{t()}}),e.jsx("div",{className:"label _lr-auto",children:"Cart"})]}),e.jsxs("div",{className:"cart-ctn",children:[e.jsxs("div",{className:"items",children:[e.jsxs("div",{className:"select-all",children:[e.jsx("div",{className:"btn "+(g.length<((l==null?void 0:l.list.length)||0)?"":"select"),onClick:()=>{g.length<((l==null?void 0:l.list.length)||0)?q((l==null?void 0:l.list.map(v=>v))||[]):q([])},children:g.length<((l==null?void 0:l.list.length)||0)?"Select All":"Deselect All"}),e.jsxs("a",{className:"my-command ",onClick:()=>a({page:"command"}).setAbsPath(["profile"]),children:["my orders ",e.jsx("span",{})]})]}),l==null?void 0:l.list.map(v=>e.jsx(is,{selected:!!g.find(y=>y.id==v.id),cart:v,onSelect:y=>{g.find(E=>E.id==y.id)?q(g.filter(E=>E.id!=y.id)):q([...g,y])},onDelete:y=>{m(y.id)},onQuantityChange:()=>{u(x+1)},onLike:()=>{d({}).then(y=>{y!=null&&y.list&&q(y.list)})}},v.id))]}),e.jsxs("div",{className:"right",children:[e.jsxs("div",{className:"go-to-checkout",children:[e.jsx("div",{className:"title",onClick:()=>{h({list:g.map(v=>v.id)})},children:"Go to checkout"}),e.jsx("p",{children:"Available delivery methods and times can be selected when placing an order."}),e.jsxs("div",{className:"infos",children:[e.jsxs("div",{className:"count",children:[e.jsx("h2",{children:"Your cart"}),e.jsxs("div",{className:"val",children:[N," products ",e.jsx("span",{})," "]})]}),e.jsxs("div",{children:[e.jsxs("span",{children:["Products (",g.length,")"]}),e.jsxs("span",{className:"initial-price",children:[j.toLocaleString(),"$"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text",children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:"detail",children:["More details ",e.jsx("span",{})]})]}),e.jsxs("span",{className:"discount",children:[0 .toLocaleString(),"$"]})]})]}),e.jsxs("div",{className:"_flex",children:[e.jsx("h1",{children:"total cost"}),e.jsxs("h1",{className:"total",children:[j.toLocaleString(),"$"]})]})]}),e.jsx("div",{className:"cart-cover-image"})]})]}),e.jsx(Ne,{mode:"h"}),e.jsx(ge,{mode:"h"})]}):e.jsx("div",{className:"page-cart",children:e.jsx(Q,{detail:"Google connexion is required to access your cart"})}))}let ue={metal:"gold",gem:"Diamon",size:56};function is({cart:i,selected:s,onClick:t,onSelect:a,onDelete:n,onLike:c,onShare:r,onQuantityChange:o}){return e.jsx("div",{className:"cart-item",onClick:()=>t==null?void 0:t(i),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:M(i.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...ue}).slice(0,2).map(l=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:l}),":",e.jsx("span",{className:"v",children:(ue||{})[l]})]},l)),Object.keys(ue||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(i.price*i.quantity).toLocaleString()," ","$"]})}),e.jsx(oe,{cart:i,onChange:()=>{o==null||o(i)}})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",style:{position:"relative"},children:[e.jsx(Fe,{elm:i,onChange:()=>c==null?void 0:c(i)}),e.jsx("div",{style:{filter:P("#123").result.filter},className:"delete",onClick:()=>{n==null||n(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:P("#123").result.filter},className:"share",onClick:()=>r==null?void 0:r(i),children:e.jsx("span",{})})]}),e.jsx("div",{className:"check-box "+(s?"selected":""),onClick:()=>a==null?void 0:a(i),children:s?"selected":"not selected"})]})]})]})})}const as={};function ns(){const{user:i}=w(),{commands:s,fetchCommands:t}=V();return p.useEffect(()=>{i&&t({})},[i]),e.jsx("div",{className:"page-command",children:e.jsx("div",{className:"orders",children:s==null?void 0:s.list.map(a=>e.jsx(ls,{order:a,onShare:()=>{},onClick:()=>{},onLike:()=>{}},a.id))})})}let pe={metal:"gold",gem:"Diamon",size:56};function ls({order:i,onClick:s,onLike:t,onShare:a,onComment:n}){return e.jsx("div",{className:"order-item",onClick:()=>s==null?void 0:s(i),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:M(i.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:i.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:i.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...pe}).slice(0,2).map(c=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:c}),":",e.jsx("span",{className:"v",children:(pe||{})[c]})]},c)),Object.keys(pe||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[(i.price*i.quantity).toLocaleString()," ","$"]})}),e.jsx("div",{className:"status",style:{background:as[i.status]},children:i.status})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",children:[e.jsx("div",{style:{filter:P("#123").result.filter},className:"to-favorites",onClick:()=>t==null?void 0:t(i),children:e.jsx("span",{})}),e.jsx("div",{style:{filter:P("#123").result.filter},className:"start-comment",onClick:()=>{n==null||n(i)},children:e.jsx("span",{})}),e.jsx("div",{style:{filter:P("#123").result.filter},className:"share",onClick:()=>a==null?void 0:a(i),children:e.jsx("span",{})})]}),e.jsxs("div",{className:"ref-id",onClick:c=>{navigator.clipboard.writeText("#"+i.id.split("-")[0]);const o=c.currentTarget.querySelector("span");o.classList.add("anim-top"),setTimeout(()=>{o.classList.remove("anim-top"),o.classList.add("anim-btm"),setTimeout(()=>{o.classList.remove("anim-btm")},300)},300)},children:["Ref Id : #",i.id.split("-")[0]," ",e.jsx("span",{style:{filter:P("#333").result.filter}})]})]})]})]})})}function cs(){const{updateUser:i,user:s}=w(),[t,a]=p.useState({});return p.useEffect(()=>{a({name:s==null?void 0:s.name,address:(s==null?void 0:s.address)||"Yopouon",phone:(s==null?void 0:s.phone)||"+7(999)862-74-41",date:s==null?void 0:s.created_at,money:(s==null?void 0:s.money)||"USD"})},[s]),e.jsxs("div",{className:"page-edit",children:[e.jsx("div",{className:"photo",style:{background:s&&M(s.photos[0])},children:e.jsx("div",{className:"div",children:e.jsx("label",{htmlFor:"new-photo",className:"new-photo",children:e.jsx("input",{style:{display:"none"},type:"file",name:"new-photo",id:"new-photo",onChange:n=>{var c;i({photo:(c=n.currentTarget.files)==null?void 0:c[0]})}})})})}),e.jsxs("div",{className:"infos",children:[e.jsxs("label",{htmlFor:"edit-email",className:"edit-email",children:[e.jsx("div",{className:"prompt",children:"User Email"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-email",type:"text",placeholder:"Edit Name",value:s==null?void 0:s.email})]}),e.jsxs("label",{htmlFor:"edit-name",className:"edit-name",children:[e.jsx("div",{className:"prompt",children:"Name"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-name",type:"text",placeholder:"Edit Name",value:t.name,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-phone",className:"edit-phone",children:[e.jsx("div",{className:"prompt",children:"Phone"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-phone",type:"text",placeholder:"Search Product",value:t.phone,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-address",className:"edit-address",children:[e.jsx("div",{className:"prompt",children:"Address"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-address",type:"text",placeholder:"Search Product",value:t.address,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-date",className:"edit-date",children:[e.jsx("div",{className:"prompt",children:"date of birth"}),e.jsx("div",{className:"icon"}),e.jsx("input",{type:"text",placeholder:"dd-mm-yyyy",value:new Date(t.date).toDateString(),onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("input",{style:{display:"none"},id:"edit-date",type:"date",min:"1997-01-01",max:new Date().toDateString(),placeholder:new Date().toDateString(),onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]}),e.jsxs("label",{htmlFor:"edit-devise",className:"edit-devise",children:[e.jsx("div",{className:"prompt",children:"Default Money"}),e.jsx("div",{className:"icon"}),e.jsx("input",{id:"edit-devise",type:"text",placeholder:"Search Product",value:t.money,onChange:n=>{a({...t,text:n.currentTarget.value})}}),e.jsx("div",{className:"send",onClick:()=>{}})]})]})]})}const $e={edit:"Edit Profile",command:"Orders",messages:"Messages",setting:"Setting"};function os(){const{check:i,json:s}=B(),{user:t,disconnection:a,getAccess:n}=w(),[c,r]=p.useState(!0),[o,l]=p.useState("");p.useEffect(()=>{i("profile")&&l((s==null?void 0:s.page)||"")},[s]);const d={command:e.jsx(ns,{}),edit:e.jsx(cs,{})};return i("profile")&&e.jsxs("div",{className:"page-profile",children:[e.jsx("div",{className:"nav "+(c?"open":"close"),onClick:()=>{r(!1)},children:e.jsxs("div",{className:"nav-ctn",onClick:m=>{m.preventDefault(),m.stopPropagation()},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"close",onClick:()=>{r(!1)}}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"cover-image"}),e.jsx("div",{className:"photo",style:{background:(t==null?void 0:t.photos[0])&&M(t==null?void 0:t.photos[0])}})]}):e.jsxs("div",{className:"login",onClick:()=>{n()},children:[e.jsx("div",{className:"icon",style:{}}),e.jsx("h3",{className:"label",children:"Login"}),e.jsx("span",{className:"next"})]})]}),e.jsx("h1",{className:"name",children:t==null?void 0:t.name}),t&&e.jsx("div",{className:"email _limit-text",children:t==null?void 0:t.email}),e.jsxs("ul",{children:[e.jsxs("li",{className:"edit "+(o=="edit"?"active":"")+" "+(t?"":"hide"),onClick:()=>{r(!1),l("edit")},children:[" ",e.jsx("span",{className:"icon",style:{filter:P("#123").result.filter}}),"Edit Profile",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"command "+(o=="command"?"active":"")+" "+(t?"":"hide"),onClick:()=>{r(!1),l("command")},children:[" ",e.jsx("span",{className:"icon",style:{filter:P("#123").result.filter}}),"My Orders",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"messages "+(o=="messages"?"active":"")+" "+(t?"":"hide"),onClick:()=>{r(!1),l("messages")},children:[" ",e.jsx("span",{className:"icon",style:{filter:P("#123").result.filter}}),"messages",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"setting "+(o=="setting"?"active":"")+" "+(t?"":"hide"),onClick:()=>{r(!1),l("setting")},children:[" ",e.jsx("span",{className:"icon",style:{filter:P("#123").result.filter}}),"setting",e.jsx("span",{className:"next"})]}),e.jsxs("li",{className:"about "+(o=="about"?"active":""),onClick:()=>{r(!1),l("about")},children:[" ",e.jsx("span",{className:"icon",style:{filter:P("#123").result.filter}}),"about",e.jsx("span",{className:"next"})]})]}),e.jsx("div",{className:"version",children:"By Sublymus Studio v:1.0.1"}),t&&e.jsxs("div",{className:"disconnect",onClick:()=>{a()},children:[e.jsx("span",{className:"icon",style:{filter:P("#c43d4c").result.filter}}),"Log out"]})]})}),e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"title",children:[e.jsx("span",{className:"option-nav",onClick:()=>{r(!0)}}),e.jsxs("h1",{children:[" ",$e[o]||$e.edit]})]}),t?d[o]||d.edit:d.about]})]})}function rs(){const{authenticateUser:i}=w(),{openChild:s,currentChild:t,back_color:a,blur:n}=Z(),c=p.useRef(null),{pathList:r}=B();return p.useEffect(()=>{s(void 0)},[r]),p.useEffect(()=>{i(),window.addEventListener("blur",()=>{})},[]),e.jsxs("div",{className:"app",style:{width:"100%",height:"100%"},ref:o=>{},children:[t&&e.jsx("div",{className:"child-viewer",onContextMenu:o=>{o.preventDefault(),s(void 0)},children:e.jsx("div",{className:"child-viewer-ctn",style:{background:a},onClick:()=>{s(void 0)},onContextMenu:o=>{o.preventDefault(),s(void 0)},children:t})}),e.jsx(Ke,{}),e.jsxs("div",{ref:c,className:"app-ctn",style:{filter:n?"blur(10px)":""},children:[e.jsx(Ye,{}),e.jsx(Qe,{}),e.jsx(es,{}),e.jsx(ts,{}),e.jsx(os,{})]}),e.jsx(Ze,{})]})}const ds=i=>i,ps=ds(e.jsx(Me.StrictMode,{children:e.jsx(rs,{})}));export{ps as ClientView};
