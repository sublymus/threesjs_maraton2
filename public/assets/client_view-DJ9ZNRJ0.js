import{c as z,S as xe,j as e,g as T,l as V,u as ve,b as je}from"./BindToParentScroll-Dfi8dSNh.js";import{H as P,r as u,R as ge}from"./index-BIuqRvF4.js";import{f as Ne,d as _e}from"./DataBase-C3RGVNhK.js";const w=z(a=>({user:void 0,store:void 0,userStore:void 0,manager:void 0,openAuth:!1,async updateUser({name:s,photos:t,id:n}){const o=new FormData;if(s&&o.append("name",s),t!=null&&t[0])o.append("photos_0",t[0]);else return;o.append("id",n),o.append("photos",'["photos_0"]');const i=w.getState().getHeaders();if(!i)return;const c=await(await fetch(`${P}/edit_me`,{method:"PUT",body:o,headers:i.headers})).json();console.log({user:c}),c.id&&(a(()=>({user:{...c,photos:c.photos.map(m=>`${P}${m}`)}})),localStorage.setItem("user",JSON.stringify(c)))},async disconnection(){const s=w.getState().getHeaders();if(!s)return;const t={method:"GET",headers:s.headers};await fetch(`${P}/disconnection`,t),localStorage.removeItem("user"),localStorage.removeItem("store_name"),a(()=>({user:void 0,store:void 0,userStore:void 0,openAuth:!0}))},async getAccess(){window.open(`${P}/google_connexion`,void 0,"popup");const s=setInterval(()=>{const t=localStorage.getItem("user"),n=t&&JSON.parse(t);n&&(console.log("getAccess",{token:n.token}),a(()=>({user:n})),clearInterval(s),w.getState().authenticateUser())},100)},async authenticateUser(){let s=localStorage.getItem("user");const t=localStorage.getItem("store_name")||window.location.pathname.split("/")[2];if(s){const n=JSON.parse(s),o=new Headers;o.append("Authorization",`Bearer ${n.token}`);const i={method:"GET",headers:o},r=await fetch(`${P}/can_use_store/${t}`,i);let c;try{if(c=await r.json(),!c.user)return}catch{return}const m={...n,...c.user};a(()=>({user:m,manager:c.manager,userStore:c.userStore,store:c.store,openAuth:!1})),localStorage.setItem("user",JSON.stringify(m))}else await w.getState().getStore()},async getStore(){const s=localStorage.getItem("store_name")||window.location.pathname.split("/")[1];if(s){const t=await fetch(`${P}/get_store_by_name/${s}`);try{let n=await t.json();a(()=>({store:n}))}catch{}}},getHeaders(){const s=w.getState().store;if(!s)return;let t=w.getState().user;if(!t)return;const n=new Headers;return n.append("Authorization",`Bearer ${t.token}`),{store:s,headers:n,user:t}}})),te=[{u:"products",n:"Home",i:"/src/res/application.png"},{u:"categories",n:"Categories",i:"/src/res/catalog.png"},{u:"favorites",n:"Favorites",i:"/src/res/shopping-cart.png"},{u:"cart",n:"Cart",i:"/src/res/chat.png"},{u:"profile",n:"Prolife",i:"/src/res/chat.png"}],ye={"/":{loading:{},products:{detail:{comments:{},images:{}}},categories:{},favorites:{},cart:{},payment:{},command:{},profile:{}}},ne=z(a=>({T:localStorage.getItem("theme"),storeVar:void 0,usersVar:void 0,back_color:"",blur:!1,openNav:"max",setOpenNav(s){a(()=>({openNav:s}))},setT(s){s&&localStorage.setItem("theme",s),a(()=>({T:s}))},currentChild:void 0,openChild(s,t,n){a(()=>({currentChild:s,blur:t,back_color:s&&n||""}))}})),A=new xe(ye,["/","products"]).getStore(),we=(a,s)=>{const t=setInterval(()=>{let n=!1,o=a,i=0;for(;!n;){if(o==document.body){clearInterval(t),s(),n=!0;return}else o==null||i>100?n=!0:o=o.parentElement;i++}},100)},de=(a,s)=>t=>{if(!t)return;if(t.dataset.init)return a==null?void 0:a(t.setIndex);t.dataset.init="init:"+Math.trunc(Math.random()*1e3)/1e3;const n=()=>{let o=0;const i=m=>{const d=t.querySelectorAll(".card-h-c");if(o=m,d.length<=0)return;o=o>=d.length?d.length-1:o<0?0:o;const l=t.getBoundingClientRect(),x=l.width,v=d[o].getBoundingClientRect(),h=v.x-l.x+v.width/2;t.scrollTo({behavior:"smooth",left:t.scrollLeft-(x/2-h)})};t.setIndex=i;const r=()=>{const m=t.getBoundingClientRect().width;i(o);const d=t.querySelectorAll(".gap");for(const l of d)l.style.width=`${m/2}px`,l.style.minWidth=`${m/2}px`,l.style.maxWidth=`${m/2}px`};window.addEventListener("resize",r),r();const c=.1;t.addEventListener("scrollend",()=>{const m=t.getBoundingClientRect(),d=m.width,l=d*c,f=t.querySelectorAll(".card-h-c")[o].getBoundingClientRect(),v=f.x-m.x+f.width/2;let h=o;v<d/2-l?(h=o+1,i(h)):v>d/2+l?(h=o-1,i(h)):i(o),s==null||s(h)}),a==null||a(i)};we(t,()=>{n()})};function ae({product:a,active:s,onClick:t,aspect:n,mode:o}){var m,d,l,x;const[i,r]=u.useState(0),c=u.useRef(null);return u.useEffect(()=>{const f=()=>{c.current&&n!=null&&o=="v"&&(c.current.style.height=`${c.current.getBoundingClientRect().width*(n||1)}px`)};return n!=null&&o=="v"&&window.addEventListener("resize",f),c.current&&(!n||o=="h")&&(c.current.style.height=""),f(),()=>{window.removeEventListener("resize",f)}},[c,n,o]),e.jsxs("div",{className:"product-card "+o+" "+(s?"active":""),onClick:t,ref:c,children:[e.jsxs("div",{className:"images",ref:de(void 0,r),children:[e.jsx("div",{className:"gap"}),a.images.map(f=>e.jsx("div",{className:"image card-h-c ",style:{background:T(f)}},f)),e.jsx("div",{className:"gap"})]}),e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"counters",children:a.images.map((f,v)=>e.jsx("div",{className:"counter "+(i==v?"active":"")},f))}),e.jsx("div",{className:"price",children:e.jsx("div",{className:"value",children:"12450.93 $"})}),e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:a.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:a.description})]}),e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"star "+((m=a.note)!=null&&m.star?"":"vide")}),e.jsx("div",{className:"note",children:(d=a.note)==null?void 0:d.star}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"vote",children:(l=a.note)==null?void 0:l.votes}),e.jsx("div",{className:"users"}),!((x=a.note)!=null&&x.star)&&e.jsx("div",{className:"new",children:"New"})]}),e.jsx("div",{className:"add-btn",onClick:f=>{f.preventDefault(),f.stopPropagation()},children:e.jsxs("div",{className:"btn",children:["Add ",e.jsx("span",{children:" to cart"})]})})]})]})}const G=z((a,s)=>({visites:void 0,product:void 0,products:{limit:25,list:[],page:1,total:0},async setClientVisite(t){const n=w.getState().getHeaders();if(!n)return;const o=new FormData;o.append("product_id",t),await fetch(`${P}/set_client_visited`,{headers:n.headers,body:o,method:"PUT"})},async fetchVisites({after_date:t,before_date:n,client_id:o,product_id:i,limit:r,page:c}){const m=w.getState().getHeaders();if(!m)return;const d={};d.store_id=m.store.id,d.product_id=i||"",d.client_id=o||"",d.limit=r||6,d.page=c||1,d.after_date=t||"",d.before_date=n||"";const l=new URLSearchParams({});for(const v in d){const h=d[v];h!=null&&l.set(v,h)}const f=await(await fetch(`${P}/get_client_visited/?${l.toString()}`,{headers:m.headers})).json();!f||!f.list||a(()=>({visites:f}))},featuresCollector:void 0,async setProductById(t){if(!t.product_id)return;const n=s().products,o=n==null?void 0:n.list.find(i=>i.id==t.product_id);if(o)s().selectProduct(o),a(()=>({featuresCollector:o==null?void 0:o.featuresCollector})),console.log(t);else{const i=w.getState().store;if(!i)return;const r={};r.product_id=t.product_id,r.is_features_required=!0,r.store_id=i.id,r.by_product_category=!(n!=null&&n.list[0]);const c=new URLSearchParams({});for(const x in r){const f=r[x];f!=null&&c.set(x,f)}const d=await(await fetch(`${P}/get_products/?${c.toString()}`)).json();if(!d.list)return;const l=d.list.find(x=>x.id==t.product_id)||d.list[0];a(()=>({products:n?{...n,list:[...d.list.filter(x=>!n.list.find(f=>f.id==x.id)),...n.list]}:d,product:l,featuresCollector:l==null?void 0:l.featuresCollector})),s().selectProduct(l)}},fetchProducts:async t=>{const n=w.getState().store;if(!n)return;const o={...t};o.is_features_required=!0,o.store_id=n.id;const i=new URLSearchParams({});for(const m in o){const d=o[m];d!=null&&i.set(m,d)}const c=await(await fetch(`${P}/get_products/?${i.toString()}`)).json();if(c!=null&&c.list)return t!=null&&t.no_save||a(()=>({products:c})),{...c}},async selectProduct(t){if(!t)return a(()=>({product:void 0}));t.features=Ne;const n={};t.features.list.forEach(o=>{var i;o.default_value?n[o.id]=o.default_value:(console.log("nnnnnnnnnn"),n[o.id]=(i=o.components)==null?void 0:i.find(r=>!!r.is_default),o.default_value=n[o.id])}),t.featuresCollector={collectFeature(o,i){i!=null?n[o.id]=i:o.default_value&&(n[o.id]=o.default_value),a(()=>({featuresCollector:t.featuresCollector&&{...t.featuresCollector}}))},getCollectedFeatures(o){return n[o]},allCollectedFeatures(){return n}},a(()=>({product:t})),s().setClientVisite(t.id)}}));class me{constructor(s,t,n){this.set(s,t,n)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(s,t,n){this.r=this.clamp(s),this.g=this.clamp(t),this.b=this.clamp(n)}hueRotate(s=0){s=s/180*Math.PI;const t=Math.sin(s),n=Math.cos(s);this.multiply([.213+n*.787-t*.213,.715-n*.715-t*.715,.072-n*.072+t*.928,.213-n*.213+t*.143,.715+n*.285+t*.14,.072-n*.072-t*.283,.213-n*.213-t*.787,.715-n*.715+t*.715,.072+n*.928+t*.072])}grayscale(s=1){this.multiply([.2126+.7874*(1-s),.7152-.7152*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152+.2848*(1-s),.0722-.0722*(1-s),.2126-.2126*(1-s),.7152-.7152*(1-s),.0722+.9278*(1-s)])}sepia(s=1){this.multiply([.393+.607*(1-s),.769-.769*(1-s),.189-.189*(1-s),.349-.349*(1-s),.686+.314*(1-s),.168-.168*(1-s),.272-.272*(1-s),.534-.534*(1-s),.131+.869*(1-s)])}saturate(s=1){this.multiply([.213+.787*s,.715-.715*s,.072-.072*s,.213-.213*s,.715+.285*s,.072-.072*s,.213-.213*s,.715-.715*s,.072+.928*s])}multiply(s){const t=this.clamp(this.r*s[0]+this.g*s[1]+this.b*s[2]),n=this.clamp(this.r*s[3]+this.g*s[4]+this.b*s[5]),o=this.clamp(this.r*s[6]+this.g*s[7]+this.b*s[8]);this.r=t,this.g=n,this.b=o}brightness(s=1){this.linear(s)}contrast(s=1){this.linear(s,-(.5*s)+.5)}linear(s=1,t=0){this.r=this.clamp(this.r*s+t*255),this.g=this.clamp(this.g*s+t*255),this.b=this.clamp(this.b*s+t*255)}invert(s=1){this.r=this.clamp((s+this.r/255*(1-2*s))*255),this.g=this.clamp((s+this.g/255*(1-2*s))*255),this.b=this.clamp((s+this.b/255*(1-2*s))*255)}hsl(){const s=this.r/255,t=this.g/255,n=this.b/255,o=Math.max(s,t,n),i=Math.min(s,t,n);let r,c,m=(o+i)/2;if(o===i)r=c=0;else{const d=o-i;switch(c=m>.5?d/(2-o-i):d/(o+i),o){case s:r=(t-n)/d+(t<n?6:0);break;case t:r=(n-s)/d+2;break;case n:r=(s-t)/d+4;break}r/=6}return{h:r*100,s:c*100,l:m*100}}clamp(s){return s>255?s=255:s<0&&(s=0),s}}class Ce{constructor(s,t){this.target=s,this.targetHSL=s.hsl(),this.reusedColor=new me(0,0,0)}solve(){const s=this.solveNarrow(this.solveWide());return{values:s.values,loss:s.loss,filter:this.css(s.values)}}solveWide(){const n=[60,180,18e3,600,1.2,1.2];let o={loss:1/0};for(let i=0;o.loss>25&&i<3;i++){const r=[50,20,3750,50,100,100],c=this.spsa(5,n,15,r,1e3);c.loss<o.loss&&(o=c)}return o}solveNarrow(s){const t=s.loss,n=2,o=t+1,i=[.25*o,.25*o,o,.25*o,.2*o,.2*o];return this.spsa(t,i,n,s.values,500)}spsa(s,t,n,o,i){const c=.16666666666666666;let m=null,d=1/0;const l=new Array(6),x=new Array(6),f=new Array(6);for(let h=0;h<i;h++){const N=n/Math.pow(h+1,c);for(let p=0;p<6;p++)l[p]=Math.random()>.5?1:-1,x[p]=o[p]+N*l[p],f[p]=o[p]-N*l[p];const _=this.loss(x)-this.loss(f);for(let p=0;p<6;p++){const g=_/(2*N)*l[p],$=t[p]/Math.pow(s+h+1,1);o[p]=v(o[p]-$*g,p)}const L=this.loss(o);L<d&&(m=o.slice(0),d=L)}return{values:m,loss:d};function v(h,N){let _=100;return N===2?_=7500:(N===4||N===5)&&(_=200),N===3?h>_?h%=_:h<0&&(h=_+h%_):h<0?h=0:h>_&&(h=_),h}}loss(s){const t=this.reusedColor;t.set(0,0,0),t.invert(s[0]/100),t.sepia(s[1]/100),t.saturate(s[2]/100),t.hueRotate(s[3]*3.6),t.brightness(s[4]/100),t.contrast(s[5]/100);const n=t.hsl();return Math.abs(t.r-this.target.r)+Math.abs(t.g-this.target.g)+Math.abs(t.b-this.target.b)+Math.abs(n.h-this.targetHSL.h)+Math.abs(n.s-this.targetHSL.s)+Math.abs(n.l-this.targetHSL.l)}css(s){function t(n,o=1){return Math.round(s[n]*o)}return`invert(${t(0)}%) sepia(${t(1)}%) saturate(${t(2)}%) hue-rotate(${t(3,3.6)}deg) brightness(${t(4)}%) contrast(${t(5)}%)`}}function Se(a){const s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(s,(n,o,i,r)=>o+o+i+i+r+r);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}const ee={},B=a=>{if(ee[a])return ee[a];const s=Se(a);if(s.length!==3){alert("Invalid format!");return}const t=new me(s[0],s[1],s[2]),o=new Ce(t).solve(),i={color:t,result:o};return ee[a]=i,i};function oe({note:a}){return e.jsxs("div",{className:"note-stars",children:[e.jsx("div",{className:"icon first "+(a>=1?"full":a<=0?"vide":"half")}),e.jsx("div",{className:"icon "+(a>=2?"full":a<=1?"vide":"half")}),e.jsx("div",{className:"icon "+(a>=3?"full":a<=2?"vide":"half")}),e.jsx("div",{className:"icon "+(a>=4?"full":a<=3?"vide":"half")}),e.jsx("div",{className:"icon "+(a>=5?"full":a<=4?"vide":"half")})]})}const Z=z(a=>({comments:void 0,index:void 0,lastPage:void 0,setLastPage(s){a(()=>({lastPage:s}))},setIndex(s){a(()=>({index:s}))},userComment:void 0,async getCommentIndex(s){const t=new URLSearchParams({});for(const i in s){const r=s[i];r!=null&&t.set(i,r)}return await(await fetch(`${P}/get_comment_index/?${t}`)).json()},async sendCommentResponse(s){const t=w.getState().getHeaders();if(!t)return;const n=new FormData;n.append("product_comment_id",s.comment_id.toString()),n.append("response",s.response);const i=await(await fetch(`${P}/set_product_comment_response`,{method:"PUT",body:n,headers:t.headers})).json();if(i!=null&&i.id)return a(({comments:r})=>({comments:r&&{...r,list:r.list.map(c=>c.id==s.comment_id?i:c)}})),i},async fetcheditCommentText(s){const t=w.getState().getHeaders();if(!t)return;const n=new FormData;n.append("product_comment_id",s.comment_id.toString()),n.append("text",s.text);const i=await(await fetch(`${P}/edit_product_comment_text`,{method:"PUT",body:n,headers:t.headers})).json();if(i!=null&&i.id)return a(({comments:r})=>({comments:r&&{...r,list:r.list.map(c=>c.id==s.comment_id?i:c)}})),i},async deleteComment(s,t){const n=w.getState().getHeaders();if(!n)return;const i=await(await fetch(`${P}/delete_product_comment/${s.id}`,{method:"DELETE",headers:n.headers})).json();if(i!=null&&i.deleted)return t&&setTimeout(()=>{a(({comments:r})=>({comments:r&&{...r,list:r.list.filter(c=>c.id!=s.id)}}))},t),i},async fetchProductComments(s){if(!w.getState().store)return;const n=new URLSearchParams({});for(const r in s){const c=s[r];n.set(r,c)}const i=await(await fetch(`${P}/get_product_comments/?${n.toString()}`)).json();return s!=null&&s.no_save||a(()=>({comments:i})),i},async fetchUserComment(){},async create_product_comment(s){const t=w.getState().getHeaders();if(!t)return;const n=new FormData;n.append("product_id",s.product_id),n.append("note",s.note+""),n.append("text",s.text);for(let r=0;r<s.photos.length;r++)n.append("photos_"+r,s.photos[r]);for(let r=0;r<s.videos.length;r++)n.append("videos_"+r,s.videos[r]);console.log(s);const i=await(await fetch(`${P}/create_product_comment`,{method:"POST",body:n,headers:t.headers})).json();if(i!=null&&i.id)return i}}));function Q({comment:a,canOpen:s,onClick:t}){var R,S;const[n,o]=u.useState(!1),[i,r]=u.useState(!1),{userStore:c,manager:m}=w(),{deleteComment:d,sendCommentResponse:l,fetcheditCommentText:x}=Z(),f=(m==null?void 0:m.type.toLocaleLowerCase())=="collaborator"||(m==null?void 0:m.type.toLocaleLowerCase())=="owner",[v,h]=u.useState(!1),[N,_]=u.useState(!1),[L,p]=u.useState(a.text||""),[g,$]=u.useState(a.response||""),M=(c==null?void 0:c.user_id)==a.user_id,[D,q]=u.useState(null);return e.jsxs("div",{ref:q,className:"product-comment",onClick:()=>{t==null||t(),r(!1)},children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"photo",style:{background:a.user?T(a.user.photos[0]):""},children:e.jsx("span",{style:{background:(R=a.user)!=null&&R.country_icon?T(a.user.country_icon):""}})}),e.jsxs("div",{className:"coment-right",children:[e.jsxs("div",{className:"flex",style:{flexWrap:"nowrap"},children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"name",children:(S=a.user)==null?void 0:S.name}),e.jsx(oe,{note:a.note})]}),(M||f)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"option",onClick:y=>{y.preventDefault(),y.stopPropagation(),r(!i)}}),e.jsxs("div",{className:"ctn-option "+(i?"open":""),onClick:()=>{r(!1)},children:[e.jsx("div",{className:"close",onClick:()=>{r(!1)}}),M&&e.jsx("div",{className:"edit-comment",onClick:()=>{h(!0),_(!1)},children:"Edit Comment"}),f&&e.jsx("div",{className:"edit-response",onClick:()=>{_(!0),h(!1)},children:a.response?"Edit Response":"Add Response"}),e.jsx("div",{className:"delete",onClick:()=>{d(a,300).then(y=>{y!=null&&y.deleted&&(D==null||D.classList.add("deleted"),setTimeout(()=>{D&&(D.style.display="none")},300))})},children:"Delete"})]})]})]}),e.jsx("div",{className:"date",children:new Date(a.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),e.jsx("div",{className:"message",children:v?e.jsxs("label",{htmlFor:"edit-comment-"+a.id,children:[e.jsx("input",{id:"edit-comment-"+a.id,type:"text",value:L,placeholder:"Edit Comment",onChange:y=>{p(y.currentTarget.value)}}),e.jsx("span",{onClick:()=>{_(!1),h(!1),x({comment_id:a.id,text:L})}})]}):a.text})]}),e.jsxs("div",{className:"message-ctn",children:[e.jsx("div",{className:"gap"}),s&&(a.photos_count>0||a.videos_count>0)&&e.jsxs("div",{className:"files-ctn",children:[a.photos.map((y,E)=>e.jsx("div",{style:{background:T(y)+",#4544"},onClick:C=>{C.preventDefault(),C.stopPropagation(),t==null||t({comment:a,relative:E})}},y)),a.videos.map((y,E)=>e.jsx("div",{onClick:C=>{C.preventDefault(),C.stopPropagation(),t==null||t({comment:a,relative:a.photos.length+E})},children:e.jsx("video",{width:60,height:60,src:`${P}${y}`})},y))]})]}),(s&&a.response||N)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"open-response "+(n||N?"open":""),onClick:()=>{o(!n),_(!1),h(!1)},children:[a.response?"Open response":"Add Response",e.jsx("span",{})]}),e.jsx("div",{className:"response "+(n||N?"open":""),children:N?e.jsxs("label",{htmlFor:"edit-response-"+a.id,children:[e.jsx("input",{id:"edit-response-"+a.id,type:"text",value:g,placeholder:"Edit Response",onChange:y=>{$(y.currentTarget.value)}}),e.jsx("span",{onClick:()=>{_(!1),o(!0),l({comment_id:a.id,response:g})}})]}):a.response})]})]})}function ce({posistion:a,size:s,top:t,step:n}){return o=>{if(!o||o.dataset.init)return;o.dataset.init="init",o.style.scrollBehavior="smooth";const i=o.parentElement,r=document.createElement("div");r.style.width=o.style.width,r.style.position="relative",r.append(o),i.append(r);const c=document.createElement("div"),m=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div");m.className="h-scroll-icon-ctn right",c.className="h-scroll-icon-ctn",s&&(m.style.width=`${s}px`,m.style.height=`${s}px`,c.style.width=`${s}px`,c.style.height=`${s}px`),a&&(m.style.right=`${-a}px`,c.style.left=`${-a}px`),t&&(m.style.top=`${t}px`,c.style.top=`${t}px`),l.className="h-scroll-icon right",d.className="h-scroll-icon",m.append(l),c.append(d),l.style.filter=B("#123").result.filter,d.style.filter=B("#123").result.filter,r.append(m,c);const x=()=>{o.scrollLeft<=0?c.style.display="none":c.style.display="block",o.scrollLeft>=o.scrollWidth-o.getBoundingClientRect().width-30?m.style.display="none":m.style.display="block"};c.addEventListener("click",()=>{n?o.scrollLeft-=n:o.scrollLeft-=o.getBoundingClientRect().width/2}),m.addEventListener("click",()=>{n?o.scrollLeft+=n:o.scrollLeft+=o.getBoundingClientRect().width/2}),o.addEventListener("scroll",x),setTimeout(()=>{x()},500)}}function he(){const{getAccess:a}=w();return e.jsx("div",{className:"page-auth",children:e.jsxs("div",{className:"auth-ctn",onClick:s=>{s.stopPropagation(),s.preventDefault()},children:[e.jsx("div",{className:"image"}),e.jsxs("div",{className:"form",children:[e.jsx("h1",{className:"auth-title",children:"JOIN US NOW"}),e.jsxs("h5",{className:"auth-prompt",children:["Read more ?"," ",e.jsx("span",{onClick:()=>{},children:"Click here"})]}),e.jsxs("div",{className:"google",onClick:()=>{a()},children:[e.jsx("div",{className:"icon"}),e.jsx("div",{className:"label",children:"Connexion"})]}),e.jsx("p",{children:"Google connexion is required to get access to sublymus service."})]})]})})}function be({product:a,setRef:s,userCommand:t}){const{userComment:n,comments:o,create_product_comment:i,fetchProductComments:r,setIndex:c}=Z(),{openChild:m}=ne(),{user:d}=w(),{navBack:l,qs:x,current:f,json:v}=A(),[h,N]=u.useState([]),[_,L]=u.useState([]),[p,g]=u.useState(""),[$,M]=u.useState(0),[D,q]=u.useState(!1),[R,S]=u.useState(),[y,E]=u.useState(!1),[C,H]=u.useState({order_by:"created_at_desc",order_text:"Date",with_photo:!1,with_video:!1,limit:20,page:1}),[J,Y]=u.useState(!1);return u.useEffect(()=>{r({product_id:a.id,...C})},[R,a,C,v]),f("comments")&&e.jsxs("section",{className:"page-comments "+(f("comments")?"open":"close"),ref:s,children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"return",onClick:()=>{l()}}),e.jsx("h1",{children:"Comments"}),e.jsx("div",{className:"option"})]}),e.jsx(fe,{product:a,onClick:()=>x().keepJson().setAbsPath(["products","detail","images"])}),e.jsxs("div",{className:"write-comment",children:[e.jsxs("div",{className:"top-prompt",children:[" Leave a comment ",e.jsx("span",{})]}),R?e.jsx("div",{children:"Thank you for the comment."}):n?e.jsxs("div",{children:["You have already commented on this product ",e.jsx("span",{onClick:()=>q(!0),children:" see my comment"})]}):t!=null&&t.payment_id?e.jsxs("div",{className:"zone-inputs",children:[e.jsxs("div",{className:"user-rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx("div",{className:"icon "+($>=1?"star":""),onClick:()=>M(1)}),e.jsx("div",{className:"icon "+($>=2?"star":""),onClick:()=>M(2)}),e.jsx("div",{className:"icon "+($>=3?"star":""),onClick:()=>M(3)}),e.jsx("div",{className:"icon "+($>=4?"star":""),onClick:()=>M(4)}),e.jsx("div",{className:"icon "+($==5?"star":""),onClick:()=>M(5)})]}),e.jsx("div",{className:"value",children:$})]}),!!$&&e.jsxs("label",{htmlFor:"comment-input-text",className:"input-text",children:[e.jsx("input",{id:"comment-input-text",autoFocus:!0,type:"text",value:p,placeholder:"Write Comment",onChange:b=>{g(b.target.value.substring(0,200))}}),e.jsxs("div",{className:"div",children:[p.length,"/200"]})]}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-photo",id:"comment-photo",accept:"image/*",onChange:b=>{if(b.target.files){for(const j of b.target.files)h.unshift(j);N([...h].slice(0,5))}}}),e.jsx("input",{multiple:!0,style:{display:"none"},type:"file",name:"comment-video",id:"comment-video",accept:"video/*",onChange:b=>{if(b.target.files){for(const j of b.target.files)_.unshift(j);L([..._].slice(0,2))}}}),e.jsxs("div",{className:"files-ctn",style:{display:$&&p?"flex":"none"},children:[e.jsxs("div",{className:"photo-ctn",children:[e.jsxs("label",{htmlFor:"comment-photo",className:"photo",children:[e.jsx("span",{}),"Photo ",h.length,"/5"]}),e.jsx("div",{className:"files-photo",children:h.map(b=>e.jsx("div",{style:{background:T(URL.createObjectURL(b))},children:e.jsx("span",{onClick:()=>{N(h.filter(j=>j!=b))}})},b.name))})]}),e.jsxs("div",{className:"video-ctn",children:[e.jsxs("label",{htmlFor:"comment-video",className:"photo",children:[e.jsx("span",{}),"Video ",_.length,"/2"]}),e.jsx("div",{className:"files-video",children:_.map(b=>e.jsxs("div",{children:[e.jsx("video",{width:80,height:80,src:URL.createObjectURL(b)}),e.jsx("span",{onClick:()=>{L(_.filter(j=>j!=b))}})]},b.name))})]})]}),e.jsxs("div",{className:"send-comment "+(y?"loading":""),children:[e.jsx("span",{className:"text "+(p.trim()?"":"no"),onClick:()=>{if(!d)return m(e.jsx(he,{}),!0,"#fffc");$&&p&&(E(!0),i({note:$,photos:h,product_id:a.id,text:p,videos:_}).then(b=>{E(!1),b!=null&&b.id&&S(b)}))},children:"Send"})," ",e.jsx("span",{className:"loading"})]})]}):e.jsx("div",{children:"Comments are allowed after purchasing the product"})]}),e.jsx("div",{className:"my-comment",children:n&&e.jsx(Q,{comment:n,canOpen:!0})}),e.jsxs("div",{className:"filter",children:[e.jsxs("div",{className:"date active",onClick:()=>{Y(!J)},children:[C.order_text,e.jsx("span",{className:C.order_by.includes("desc")?"desc":""}),e.jsxs("div",{className:J?"open":"",children:[e.jsxs("div",{onClick:()=>H({...C,order_by:"created_at_desc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>H({...C,order_by:"created_at_asc",order_text:"Date"}),children:["Date ",e.jsx("span",{className:""})]}),e.jsxs("div",{onClick:()=>H({...C,order_by:"note_desc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:"desc"})]}),e.jsxs("div",{onClick:()=>H({...C,order_by:"note_asc",order_text:"Star"}),children:["Star ",e.jsx("span",{className:""})]})]})]}),e.jsx("div",{className:"photo "+(C.with_photo?"active":""),onClick:()=>H({...C,with_photo:!C.with_photo}),children:"With Photo"}),e.jsx("div",{className:"video "+(C.with_video?"active":""),onClick:()=>H({...C,with_video:!C.with_video}),children:"With Video"})]}),e.jsx("div",{className:"comments",children:o==null?void 0:o.list.map(b=>e.jsx(Q,{comment:b,canOpen:!0,onClick:j=>{const k=j==null?void 0:j.comment;k&&(x().keepJson().setAbsPath(["products","detail","images"]),c({comment:k,relative:j.relative}))}},b.id))})]})}function ke({product:a}){var $,M,D,q,R;const{current:s,navBack:t,pathList:n}=A(),{getCommentIndex:o,index:i}=Z(),[r,c]=u.useState(null),[m,d]=u.useState((i==null?void 0:i.relative)||0),[l,x]=u.useState(),[f]=u.useState({}),[v,h]=u.useState(!1),[N,_]=u.useState({move:"",comment_id:i==null?void 0:i.comment.id});u.useEffect(()=>{s("images")&&a&&o({product_id:a.id,comment_id:N.comment_id||(i==null?void 0:i.comment.id),move:N.move||void 0}).then(S=>{var y;if(console.log({res:S}),(y=S==null?void 0:S.comment)!=null&&y.id){if(N.move=="back")d(S.comment.photos_count+S.comment.videos_count-1);else if(N.move=="next")d(0);else{let E=((i==null?void 0:i.relative)??m)||0;const C=S.comment.photos_count+S.comment.videos_count;E=E<=0?0:E>=C-1?C-1:E,d(E)}N.move="",N.comment_id=void 0,x(S)}})},[N,i,n]),u.useEffect(()=>{s("images")&&(_({comment_id:void 0,move:""}),x(void 0),console.log({commentIndex:l}))},[a,n]),u.useEffect(()=>{f.init||(f.init=!0,window.addEventListener("keyup",S=>{S.code=="ArrowRight"?f.moveNext():S.code=="ArrowLeft"&&f.moveBack()}))},[]);const L=()=>{m<=0?(console.log("back comment "),l&&_({...N,comment_id:l.comment.id,move:"back"})):(console.log("back image "),d(m-1))},p=()=>{m>=g.length-1?(console.log("next comment "),l&&_({...N,comment_id:l.comment.id,move:"next"})):(console.log("next image "),d(m+1))};f.moveNext=p,f.moveBack=L;const g=[...(($=l==null?void 0:l.comment)==null?void 0:$.photos)||[],...((M=l==null?void 0:l.comment)==null?void 0:M.videos)||[]];return s("images")&&!(l!=null&&l.comment)?e.jsxs("div",{className:"image-not-found",children:[e.jsx("p",{className:"text",children:"no images or videos found for this product."}),e.jsxs("div",{onClick:()=>t(),children:[e.jsx("span",{}),"go back"]})]}):s("images")&&(l==null?void 0:l.comment)&&e.jsxs("section",{className:"page-comment-image "+(s("images")?"open":"close"),children:[e.jsxs("div",{className:"page-top",children:[e.jsx("div",{className:"return",style:{filter:B("#fff").result.filter},onClick:()=>t()}),e.jsxs("div",{className:"count",children:[((l==null?void 0:l.befor)||0)+m," / ",(l==null?void 0:l.total)||0]})]}),e.jsxs("div",{className:"file-view _flex _center",children:[m>(((D=l==null?void 0:l.comment)==null?void 0:D.photos_count)||0)-1?e.jsx("div",{className:"video _flex",ref:S=>{if(!S||S.dataset.init)return;S.dataset.init="init",c(S);const y=()=>{const E=S.querySelector("video"),C=S.getBoundingClientRect();E.width=C.width};window.addEventListener("resize",y)},children:e.jsx("video",{loop:!0,autoPlay:!0,controls:!0,width:r==null?void 0:r.getBoundingClientRect().width,src:`${P}${g[m]}`})}):e.jsx("div",{className:"photo",children:e.jsx("div",{className:"img",style:{background:T(g[m],"100%")}})}),e.jsx("div",{className:"move-next",onClick:p,children:e.jsx("div",{className:"next",children:e.jsx("span",{})})}),e.jsx("div",{className:"move-back",onClick:L,children:e.jsx("div",{className:"back",children:e.jsx("span",{})})})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"top _flex _wrap",children:[e.jsx("div",{className:"name",children:V(((q=l==null?void 0:l.comment.user)==null?void 0:q.name)||"",50)}),e.jsxs("div",{className:"_flex  _l-auto",children:[e.jsx(oe,{note:((R=l==null?void 0:l.comment)==null?void 0:R.note)||0}),e.jsx("div",{className:"open",onClick:()=>h(!0),children:"Open"})]})]}),e.jsx("div",{className:"message",children:V((l==null?void 0:l.comment.text)||"",100)}),e.jsxs("div",{className:"preview-comment "+(v?"open":"close"),children:[e.jsx("div",{className:"close",onClick:()=>{h(!1)}}),e.jsx(Q,{canOpen:!0,comment:l.comment})]})]})]})}function ue({mode:a}){const{pathList:s,qs:t}=A(),{visites:n,fetchVisites:o}=G(),{openChild:i}=ne(),{user:r}=w();return u.useEffect(()=>{!n&&r&&o({})},[r,s]),e.jsxs("div",{className:"comp-visites "+(a||"h"),children:[e.jsxs("h1",{className:"title",children:["Products Visited",e.jsx("span",{})]}),e.jsxs("div",{className:"list",ref:ce({posistion:20}),children:[!r&&e.jsx("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>i(e.jsx(he,{}),!0,"#fffc"),children:"Connexion required"}),n==null?void 0:n.list.map(c=>e.jsx(ae,{aspect:a=="v"?1.4:void 0,mode:"inlist",product:c,onClick:()=>{t({product_id:c.id}).setAbsPath(["products","detail"])}},c.id))]})]})}function pe({mode:a}){const{qs:s}=A(),{product:t,fetchProducts:n}=G(),{store:o}=w(),[i,r]=u.useState();return u.useEffect(()=>{n({no_save:!0,category_id:t==null?void 0:t.category_id}).then(c=>{c!=null&&c.list&&r(c)})},[t,o]),e.jsxs("div",{className:"more-products "+(a||"h"),children:[e.jsxs("h1",{className:"title more",children:["More Products",e.jsx("span",{})]}),e.jsx("div",{className:"list",ref:ce({posistion:20}),children:i==null?void 0:i.list.map(c=>e.jsx(ae,{aspect:a=="v"?1.4:void 0,mode:"inlist",product:c,active:(t==null?void 0:t.id)==c.id,onClick:()=>{s({product_id:c.id}).setAbsPath(["products","detail"])}},c.id))})]})}const le={more:!0,list:["/fs/1hvrng7iv_29tvf0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1lpqtk_27y870_products_model_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1mieub_19ahe0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hvrng7iv_29tvf0_products_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg","/fs/1hv1lpqtk_27y870_products_model_images_05e7dc8e-f409-46ae-91cc-6a125add8c5b.jpg"]};let F;function Pe(){var H,J,Y,b;const{json:a,qs:s,check:t,current:n}=A(),{setProductById:o,product:i,selectProduct:r}=G(),{fetchProductComments:c,setLastPage:m}=Z(),d=u.useRef(null),l=u.useRef(null),x=u.useRef(null),[f,v]=u.useState(!0),[h,N]=u.useState(0),[_,L]=u.useState(!1),[p,g]=u.useState(),[$,M]=u.useState(!1),[D]=u.useState(),[q]=u.useState({payment_id:"lol"}),[R,S]=u.useState(null),[y,E]=u.useState(),[C]=u.useState({});return u.useEffect(()=>{t("detail")&&(a!=null&&a.product_id)&&a.product_id!=C.product_id&&(C.product_id=a.product_id,o(a))},[a]),u.useEffect(()=>{i&&t("detail")&&(c({product_id:i.id,no_save:!0}).then(j=>E(j)),x.current&&(x.current.scrollTop=0),L(!1),N(0),F==null||F(0),s().keepJson().setAbsPath(["products","detail"]))},[i]),u.useEffect(()=>{if(R){if(R.dataset.init)return;R.dataset.init="init",R.addEventListener("scroll",()=>{R.scrollTop>200?M(!0):M(!1)})}},[R]),i&&e.jsxs("div",{className:"detail-product "+(i?"open":""),children:[i&&e.jsx(be,{userComment:D,userCommand:q,setRef:S,product:i}),i&&e.jsx(ke,{product:i}),e.jsxs("section",{className:"detail "+(n("products")||n("detail")?"open":"close"),ref:x,children:[e.jsxs("div",{className:"top-top _flex",children:[e.jsx("div",{className:"return",ref:j=>{if(!j||j.dataset.init)return;j.dataset.init="init";const k=()=>{window.innerWidth>940?j.style.display=" none":j.style.display="flex"};window.addEventListener("resize",k),k()},onClick:()=>{r(void 0)}}),e.jsx("div",{className:"label _lr-auto",children:"Detail Product"})]}),e.jsxs("div",{className:"top-infos",ref:j=>{if(!j||j.dataset.init)return;j.dataset.init="init";const k=j.querySelector(".images"),O=j.querySelector(".infos"),U=()=>{j.getBoundingClientRect().width<700?(j.style.flexWrap="wrap",k.style.width="",k.style.minWidth="",k.style.maxWidth="",O.style.width="",O.style.minWidth="",O.style.maxWidth=""):(j.style.flexWrap="",k.style.width="50%",k.style.minWidth="50%",k.style.maxWidth="50%",O.style.width="50%",O.style.minWidth="50%",O.style.maxWidth="50%")};window.addEventListener("resize",U),setTimeout(()=>{U(),F==null||F(0)},200)},children:[e.jsxs("div",{className:"images",children:[e.jsxs("div",{className:"list",ref:de(j=>{F=j},N),children:[e.jsx("div",{className:"gap"}),i==null?void 0:i.images.map((j,k)=>e.jsx("div",{className:"img card-h-c "+(h==k?"active":""),style:{background:T(j)},onClick:()=>{F==null||F(k),N(k)}},j+(i==null?void 0:i.id))),e.jsx("div",{className:"gap"})]}),e.jsx("div",{className:"min-list",children:i==null?void 0:i.images.map((j,k)=>e.jsx("div",{className:"min-img "+(h==k?"active":""),style:{background:T(j)},onClick:()=>{N(k),F==null||F(k)}},j+(i==null?void 0:i.id)))})]}),e.jsx("div",{className:"infos",ref:d,children:e.jsxs("div",{className:"diff",ref:l,children:[e.jsxs("div",{className:"text "+(p&&f?"min":""),children:[e.jsxs("div",{className:"title",children:[i==null?void 0:i.title,e.jsx("span",{})]}),e.jsx("p",{className:"description",children:((i==null?void 0:i.description.length)||0)>100&&!_?e.jsxs(e.Fragment,{children:[V((i==null?void 0:i.description)||"",100)," ",e.jsx("span",{onClick:()=>L(!0),children:"Read more"})]}):(i==null?void 0:i.description)||""})]}),(i==null?void 0:i.features)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"label-features",children:["Features",e.jsxs("span",{children:[" ",(p==null?void 0:p.name)&&" : "+(p==null?void 0:p.name)]})," ",p&&e.jsx("span",{className:"close",style:{filter:((H=B("#112233"))==null?void 0:H.result.filter)||""},onClick:()=>{g(void 0)}})]}),e.jsx("div",{className:"features",children:i==null?void 0:i.features.list.map(j=>{var k;return e.jsxs("div",{className:"feature "+((p==null?void 0:p.id)==j.id?"active":""),style:{filter:((k=B("#358f27"))==null?void 0:k.result.filter)||""},onClick:()=>{var O,U;if(!p){const I=((O=d.current)==null?void 0:O.getBoundingClientRect().height)||0,K=((U=l.current)==null?void 0:U.getBoundingClientRect().height)||0;I-K<150?v(!0):v(!1)}(p==null?void 0:p.id)==j.id?g(void 0):g(j)},children:[e.jsx("div",{className:"icon",style:{background:T(j.icon)}}),e.jsx("div",{className:"label",children:V(j.name,10)})]},j.id)})})]}),p&&e.jsxs("div",{className:"label-components",children:["Components: ",e.jsx("span",{children:(Y=(J=i==null?void 0:i.featuresCollector)==null?void 0:J.allCollectedFeatures()[p.id])==null?void 0:Y.name})]}),e.jsx("div",{className:"components "+(p?"open":""),children:(b=p==null?void 0:p.components)==null?void 0:b.map(j=>{var k,O;return e.jsxs("div",{className:"component "+(((O=(k=i==null?void 0:i.featuresCollector)==null?void 0:k.allCollectedFeatures()[p.id])==null?void 0:O.id)==j.id?"active":""),onClick:()=>{var U,I,K,re;((I=(U=i==null?void 0:i.featuresCollector)==null?void 0:U.allCollectedFeatures()[p.id])==null?void 0:I.id)==j.id?(K=i==null?void 0:i.featuresCollector)==null||K.collectFeature(p,void 0):(re=i==null?void 0:i.featuresCollector)==null||re.collectFeature(p,j)},children:[e.jsx("div",{className:"icon",style:{background:T(j.icon[0],"contain")}}),e.jsx("div",{className:"label",children:V(j.name,10)})]})})})]})})]}),e.jsxs("div",{className:"detail-box",children:[e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"title",children:["product reviews",e.jsx("span",{})]}),i&&e.jsx(fe,{onClick:()=>{m(""),s().keepJson().setAbsPath(["products","detail","images"])},product:i}),e.jsxs("div",{className:"title",children:["Comments",e.jsx("span",{})]}),e.jsxs("div",{className:"min-comments",ref:ce({posistion:20}),children:[y==null?void 0:y.list.map(j=>e.jsx(Q,{comment:j,onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])}},j.id)),e.jsxs("div",{className:"more-comment "+(y!=null&&y.list.length||0>0?"":"horizontal"),onClick:()=>{s().keepJson().setAbsPath(["products","detail","comments"])},children:[e.jsx("div",{className:"icon "+(y!=null&&y.list.length||0>0?"":"add"),children:e.jsx("span",{style:{filter:B("#ffffff").result.filter}})}),e.jsx("div",{className:"label",children:y!=null&&y.list.length||0>0?"More":"Add First Comment"})]})]})]}),e.jsx(ue,{}),e.jsx(pe,{})]})]}),n("detail")&&e.jsx("div",{className:"price-zone",children:e.jsxs("div",{className:"ctn",children:[e.jsxs("div",{className:"price",children:[e.jsx("div",{children:"Price"}),e.jsxs("div",{className:"value",children:[(i==null?void 0:i.price)||0," $"]})]}),e.jsx("div",{className:"add-to-cart",children:"Add to cart"})]})}),n("comments")&&($||(q==null?void 0:q.payment_id)&&!D)&&e.jsxs("div",{className:"write-zone",children:[$&&e.jsx("div",{className:"up-icon",onClick:()=>{R&&(R.scrollTop=0)},children:e.jsx("span",{})}),e.jsx("div",{className:"write-icon",children:e.jsx("span",{})})]})]})}function fe({product:a,onClick:s}){const{qs:t}=A();return e.jsxs("div",{className:"group-file-rating",children:[e.jsx("div",{className:"after-order",children:e.jsxs("div",{className:"ctn-mini-files",onClick:s,children:[le.list.map((n,o)=>e.jsx("div",{className:"w",children:e.jsx("div",{className:"mini-file",style:{background:T(n)}})},o)),e.jsx("div",{className:"back",style:{background:T(le.list[0])},children:e.jsx("div",{className:"more-files",children:"+ More"})})]})}),(a==null?void 0:a.note)&&e.jsxs("div",{className:"rating",onClick:()=>t().keepJson().setAbsPath(["products","detail","comments"]),children:[e.jsx("div",{className:"note",children:a.note.star}),e.jsx(oe,{note:a.note.star}),e.jsxs("div",{className:"vote",children:[a.note.votes," ",e.jsx("span",{})]})]})]})}const $e=z(a=>({categories:void 0,async fetchCategoies(s){console.log({filter:s});const t=w.getState().store;if(!t)return;const n={...s};n.store_id=t.id;const o=new URLSearchParams({});for(const c in n){const m=n[c];o.set(c,m)}const r=await(await fetch(`${P}/get_categories/?${o.toString()}`)).json();if(r!=null&&r.list)return s!=null&&s.no_save||a(()=>({categories:r})),console.log(r),{...r}}}));let X="";/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?X="mobile-device":X="not-mobile-device";document.body.classList.add(X);const ie=X,Re=(a,s)=>{let t=!1;for(const n in s)a[n]!=s[n]&&(t=!0,a[n]=s[n]);return t};function Ee(){const{json:a,qs:s,check:t,pathList:n}=A(),{products:o,fetchProducts:i,selectProduct:r,product:c}=G(),{store:m}=w(),[d,l]=u.useState({order_by:"date_desc",category_id:"",price_min:void 0,price_max:void 0,text:"",product_id:""}),{fetchCategoies:x}=$e(),[f,v]=u.useState(),[h]=u.useState({}),[N,_]=u.useState(!1);u.useEffect(()=>{t("products")&&i({...d}).then(g=>{g!=null&&g.list[0]&&!c&&window.innerWidth>940&&(r(g==null?void 0:g.list[0]),s({...a,product_id:g.list[0].id}).setAbsPath(["products","detail"]))})},[d,m,n]),u.useEffect(()=>{!f&&x({limit:25,no_save:!0}).then(g=>{console.log(g),g!=null&&g.list&&v(g)})},[m]),u.useEffect(()=>{t("products")&&Re(d,a||{})&&l({...d})},[a]),u.useEffect(()=>{window.addEventListener("resize",()=>{var g;window.innerWidth>940&&!h.product&&r((g=h.products)==null?void 0:g.list[0])})},[]),h.product=c,h.products=o;const[L,p]=u.useState("");return u.useEffect(()=>{window.addEventListener("resize",()=>{p(`${window.innerWidth} / ${window.innerHeight}  / ${window.screen.height} => ${ie}`)}),p(`${window.innerWidth} / ${window.innerHeight} / ${window.devicePixelRatio}  => ${ie}`)},[]),t("products")&&e.jsxs("div",{className:"page-products",children:[e.jsx("div",{className:"left "+(N?"open":"")+" "+(t("detail")&&c?"product-detail":""),onClick:()=>{_(!1)},children:e.jsxs("div",{className:"filter-fram",children:[e.jsx("div",{className:"top",children:"Filter"}),e.jsx("div",{className:"categories",children:f==null?void 0:f.list.map(g=>e.jsx("div",{className:"category",onClick:()=>l({...d,category_id:g.id}),children:g.label},g.id))}),e.jsxs("div",{className:"prices",children:[e.jsxs("div",{className:"ctn",children:[e.jsx("label",{htmlFor:"product-price-min",children:e.jsx("input",{type:"text",id:"product-price-min",placeholder:"Min",value:d.price_min})}),e.jsx("label",{htmlFor:"product-price-max",children:e.jsx("input",{type:"text",id:"product-price-max",placeholder:"Max",value:d.price_max})})]}),e.jsx("div",{className:"set-price",children:e.jsx("div",{className:"btn",children:"Set Price"})})]})]})}),e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:"search-zone",children:[e.jsxs("label",{htmlFor:"product-search",className:"search",children:[e.jsx("div",{className:"icon"}),e.jsx("input",{id:"product-search",type:"text",placeholder:"Search Product",value:d.text,onChange:g=>{l({...d,text:g.currentTarget.value})}}),e.jsx("div",{className:"clear",onClick:()=>{l({...d,text:""})}})]}),e.jsx("div",{className:"search-text",children:d.text&&e.jsxs(e.Fragment,{children:['Search result for "',e.jsx("span",{children:d.text}),'"']})}),e.jsxs("div",{className:"sort",children:[e.jsx("div",{className:"label",onClick:()=>{_(!0)},children:"Sort"}),e.jsx("div",{className:"list",children:["date","name","price","popular"].map(g=>{var $;return e.jsx("div",{className:(($=(a==null?void 0:a.order_by)||d.order_by)==null?void 0:$.split("_")[0])==g?"active":"",onClick:()=>{s({...a,order_by:g+"_desc"}).apply()},children:g},g)})})]})]}),e.jsx("div",{className:"list",children:o==null?void 0:o.list.map(g=>e.jsx(ae,{product:g,active:(c==null?void 0:c.id)==g.id,onClick:()=>{r(g),s({...a,product_id:g.id}).setAbsPath(["products","detail"])}},g.id))})]}),e.jsx("div",{className:"right "+(c?"product":"")+" "+(t("detail")?"detail":""),children:e.jsx(Pe,{})})]})}function Le(){var f;const{setAbsPath:a,pathList:s}=A(),[t,n]=u.useState(s[1]||"home"),[o,i]=u.useState(!1),[r,c]=u.useState(!1),{user:m,getAccess:d}=w(),l=ve(),x=v=>{a([v]),n(v)};return u.useEffect(()=>{n(s[1]||"home")},[s]),u.useEffect(()=>{window.addEventListener("click",()=>{const v=document.querySelector(".top-bar .more-navs ul");(v==null?void 0:v.className)==""&&c(!1)})},[]),e.jsxs("div",{className:"top-bar",ref:je(80,".web"),children:[e.jsxs("div",{className:"top-bar-ctn",children:[e.jsx("div",{className:"left",children:e.jsx("a",{href:"#products",className:"logo-ctn",onClick:v=>{v.preventDefault(),v.stopPropagation(),x("products")},children:e.jsx("div",{className:"icon"})})}),e.jsx("ul",{className:"top-bar-center",children:te.map((v,h)=>h*150<l.width-400?e.jsxs("li",{className:t==v.u?"active":"",onClick:()=>{x(v.u)},children:[e.jsx("span",{}),v.n]},h):null)}),e.jsxs("div",{className:"right",children:[e.jsx("div",{className:"ctn-icon",onClick:v=>{v.preventDefault(),v.stopPropagation(),c(!r)},children:e.jsx("div",{className:"icon",style:{filter:B("#345").result.filter}})}),m?e.jsx("div",{className:"profile",style:{background:`no-repeat center/cover url(${(f=m==null?void 0:m.photos[0])!=null&&f.startsWith("/")?P:""}${m==null?void 0:m.photos}),#bbb`},onClick:()=>_e({user:m,target:"all"}).then(v=>{console.log(v)})}):e.jsx("div",{className:"login",onClick:()=>d(),children:"Se connecter"})]})]}),e.jsx("div",{className:"more-navs",onClick:v=>{v.preventDefault(),v.stopPropagation()},children:e.jsxs("ul",{className:r?"":"close",children:[te.map((v,h)=>h*150>=l.width-400?e.jsxs("li",{className:t==v.u?"active":"",onClick:()=>{x(v.u),c(!r)},children:[e.jsx("span",{}),v.n]},h):null),e.jsxs("li",{className:t=="mode-lite"?"active":"",style:{whiteSpace:"nowrap"},onClick:()=>{i(!o)},children:[e.jsx("span",{}),o?"Lite mode off":"Lite mode on"]})]})})]})}function Ae(){const{check:a,setAbsPath:s}=A();return e.jsx("div",{className:"bottom-nav",children:e.jsx("ul",{children:te.map((t,n)=>e.jsxs("li",{className:t.u+" "+(a(t.u)?"active":""),onClick:()=>s([t.u]),children:[e.jsx("span",{className:"label",children:t.n}),e.jsx("span",{className:"icon "+t.u})]},n))})})}function Me(){const{check:a}=A();return a("categories")&&e.jsx("div",{className:"page-categories"})}function Fe(){const{check:a}=A();return a("favorites")&&e.jsx("div",{className:"page-favorites"})}const W=z(a=>({commands:void 0,carts:void 0,async deleteCommand(s){const t=w.getState().getHeaders();if(!t)return!1;if((await(await fetch(`${P}/delete_command/${s}`,{headers:t.headers,method:"DELETE"})).json()).deleted){const i=W.getState().carts;return a(()=>({carts:{limit:(i==null?void 0:i.limit)||25,page:(i==null?void 0:i.page)||1,total:(i==null?void 0:i.total)||0,list:((i==null?void 0:i.list)||[]).filter(r=>r.id!=s)}})),!0}return!1},async updateCommand(s,t,n){const o=w.getState().getHeaders();if(!o)return;const i=new FormData,r={};i.append("command_id",s),t&&i.append("quantity",`${t}`),n&&i.append("collected_features",JSON.stringify(n));const c=new URLSearchParams({});for(const x in r){const f=r[x];c.set(x,f)}const d=await(await fetch(`${P}/update_command/?${c.toString()}`,{method:"PUT",headers:o.headers,body:i})).json();if(!d.id)return;const l=W.getState().carts;return a(()=>({carts:{limit:(l==null?void 0:l.limit)||25,page:(l==null?void 0:l.page)||1,total:(l==null?void 0:l.total)||0,list:[...((l==null?void 0:l.list)||[]).map(x=>x.id==d.id?d:x)]}})),d},async addProductToCart(s,t=1,n={}){const o=w.getState().getHeaders();if(!o)return;const i=new FormData,r={};i.append("product_id",s),i.append("quantity",`${t}`),i.append("collected_features",JSON.stringify(n));const c=new URLSearchParams({});for(const x in r){const f=r[x];c.set(x,f)}const d=await(await fetch(`${P}/create_command`,{method:"POST",headers:o.headers,body:i})).json();if(!d.id)return;const l=W.getState().carts;return a(()=>({carts:{limit:(l==null?void 0:l.limit)||25,page:(l==null?void 0:l.page)||1,total:(l==null?void 0:l.total)||0,list:[...((l==null?void 0:l.list)||[]).map(x=>x.id==d.id?d:x)]}})),d},async confirmCommand(){const s=w.getState().getHeaders();return!s||!(await(await fetch(`${P}/client_confirm_command`,{headers:s.headers,method:"PUT"})).json()).success?!1:(W.getState().fetchCarts({}),W.getState().fetchCommands({}),!0)},async fetchCarts(){const s=w.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.status="CART";const n=new URLSearchParams({});for(const r in t){const c=t[r];n.set(r,c)}const i=await(await fetch(`${P}/get_commands/?${n.toString()}`,{headers:s.headers})).json();return a(()=>({carts:i})),i},async fetchCommands(){const s=w.getState().getHeaders();if(!s)return;const t={};t.store_id=s.store.id,t.no_status="CART";const n=new URLSearchParams({});for(const r in t){const c=t[r];n.set(r,c)}const i=await(await fetch(`${P}/get_commands/?${n.toString()}`,{headers:s.headers})).json();return a(()=>({commands:i})),i}}));function Te(){const{check:a,pathList:s,navBack:t}=A(),{visites:n,fetchVisites:o}=G(),{current:i}=A(),{user:r}=w(),{carts:c,fetchCarts:m,deleteCommand:d}=W(),[l,x]=u.useState((c==null?void 0:c.list.map(h=>h))||[]);u.useEffect(()=>{r&&i("cart")&&m({}).then(h=>{h!=null&&h.list&&x(h.list)})},[s,r]),u.useEffect(()=>{!n&&r&&i("cart")&&o({})},[r,s]);let f=0;l.forEach(h=>f+=Number(h.quantity));let v=0;return l.forEach(h=>v+=h.price*h.quantity),a("cart")&&e.jsxs("div",{className:"page-cart",children:[e.jsxs("div",{className:"top-cart _flex",children:[e.jsx("div",{className:"return",onClick:()=>{t()}}),e.jsx("div",{className:"label _lr-auto",children:"Cart"})]}),e.jsxs("div",{className:"cart-ctn",children:[e.jsx("div",{className:"items",children:c==null?void 0:c.list.map(h=>e.jsx(De,{selected:!!l.find(N=>N.id==h.id),cart:h,onSelect:N=>{l.find(_=>_.id==N.id)?x(l.filter(_=>_.id!=N.id)):x([...l,N])},onDelete:N=>{d(N.id)}},h.id))}),e.jsxs("div",{className:"go-to-checkout",children:[e.jsx("div",{className:"title",children:"Go to checkout"}),e.jsx("p",{children:"Available delivery methods and times can be selected when placing an order."}),e.jsxs("div",{className:"infos",children:[e.jsxs("div",{className:"count",children:[e.jsx("h2",{children:"Your cart"}),e.jsxs("div",{className:"val",children:[l.length," products ",e.jsx("span",{})," 700g"]})]}),e.jsxs("div",{children:[e.jsxs("span",{children:["Products (",l.length,")"]}),e.jsxs("span",{className:"initial-price",children:[v.toLocaleString(),"$"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text",children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:"detail",children:["More details ",e.jsx("span",{})]})]}),e.jsxs("span",{className:"discount",children:[0 .toLocaleString(),"$"]})]})]}),e.jsxs("div",{className:"_flex",children:[e.jsx("h1",{children:"total cost"}),e.jsxs("h1",{className:"total",children:[v.toLocaleString(),"$"]})]})]})]}),e.jsx(ue,{mode:"h"}),e.jsx(pe,{mode:"h"})]})}let se={metal:"gold",gem:"Diamon",size:56};function De({cart:a,selected:s,onClick:t,onSelect:n,onDelete:o,onLike:i,onShare:r}){const[c,m]=u.useState(a.quantity);return e.jsx("div",{className:"cart-item",onClick:()=>t==null?void 0:t(a),children:e.jsxs("div",{className:"infos",children:[e.jsx("div",{className:"image",style:{background:T(a.images[0])}}),e.jsxs("div",{className:"info-right  _limit-text",children:[e.jsxs("div",{className:"top",children:[e.jsxs("div",{className:"a",children:[e.jsxs("h3",{className:"name _limit-text",children:[e.jsx("span",{className:"product-title",children:a.title})," ",e.jsx("span",{className:"slash",children:"/"})," ",e.jsx("span",{children:a.description})]}),e.jsxs("div",{className:"features",children:[Object.keys({...se}).slice(0,2).map(d=>e.jsxs("div",{className:"feature",children:[e.jsx("span",{className:"k",children:d}),":",e.jsx("span",{className:"v",children:(se||{})[d]})]},d)),Object.keys(se||{}).length>2&&e.jsxs("div",{className:"all-features",children:["See more ",e.jsx("span",{})]})]})]}),e.jsx("div",{className:"price ",children:e.jsxs("span",{className:"current",children:[a.price.toLocaleString()," ","$"]})}),e.jsxs("div",{className:"quantity",children:[e.jsx("div",{className:"min "+(c<=1?"bloc":""),onClick:()=>c>1?m(c-1):m(1),children:e.jsx("span",{style:{filter:c<=1||!1?B("#fff").result.filter:B("#358f27").result.filter}})}),e.jsx("div",{className:"count",children:c}),e.jsx("div",{className:"max "+(c>=a.stock?"bloc":""),onClick:()=>c<a.stock?m(c+1):null,children:e.jsx("span",{style:{filter:c>=a.stock?B("#fff").result.filter:B("#358f27").result.filter}})})]})]}),e.jsxs("div",{className:"btm",children:[e.jsxs("div",{className:"options",children:[e.jsx("div",{className:"to-favorites",onClick:()=>i==null?void 0:i(a),children:e.jsx("span",{})}),e.jsx("div",{className:"delete",onClick:()=>{o==null||o(a)},children:e.jsx("span",{})}),e.jsx("div",{className:"share",onClick:()=>r==null?void 0:r(a),children:e.jsx("span",{})})]}),e.jsx("div",{className:"check-box "+(s?"selected":""),onClick:()=>n==null?void 0:n(a),children:s?"selected":"not selected"})]})]})]})})}function Oe(){const{check:a}=A();return a("profile")&&e.jsx("div",{className:"page-profile"})}function qe(){const{authenticateUser:a}=w(),{openChild:s,currentChild:t,back_color:n,blur:o}=ne(),i=u.useRef(null),{pathList:r}=A();return u.useEffect(()=>{s(void 0)},[r]),u.useEffect(()=>{a(),window.addEventListener("blur",()=>{s(void 0)})},[]),e.jsxs("div",{className:"app",style:{width:"100%",height:"100%"},ref:c=>{},children:[t&&e.jsx("div",{className:"child-viewer",onContextMenu:c=>{c.preventDefault(),s(void 0)},children:e.jsx("div",{className:"child-viewer-ctn",style:{background:n},onClick:()=>{s(void 0)},onContextMenu:c=>{c.preventDefault(),s(void 0)},children:t})}),e.jsx(Le,{}),e.jsxs("div",{ref:i,className:"app-ctn",style:{filter:o?"blur(10px)":"",height:`calc(100% - var(--bottom-nav-height) - ${ie=="mobile-device"?window.screen.height-window.innerHeight:0}px)`},children:[e.jsx(Ee,{}),e.jsx(Me,{}),e.jsx(Fe,{}),e.jsx(Te,{}),e.jsx(Oe,{})]}),e.jsx(Ae,{})]})}const Be=a=>a,ze=Be(e.jsx(ge.StrictMode,{children:e.jsx(qe,{})}));export{ze as ClientView};
